[filter]
### filter process on this host
ignore_exe_path = [
    "/opt/trash/",
    "/opt/tiger",
    "/sbin",
    "/usr/sbin",
    "/etc/sysop",
    "/etc/elkeid",
    "/opt/elkeid",
    "/opt/hids",
    "/opt/bytedance"
]

ignore_exe_name = [
    "python2",
    "mongoosev3-agent",
    "mongoosev3-agen",
    "elkeid",
    "elkeid-agent",
    "journal_watcher",
    "scanner_clamav",
    "rasp",
    "rasp_server",
    "etrace",
    "collector",
]

### report env after inspected both key and value
collect_env = [
    "PROCESS_ENV_KEY",
]
collect_all_env = true

### carefully! auto attach after inspected
auto_attach_runtime = [
]


[data_type]
### recv command from Elkeid agent
### recommand for large scale deployment
### `data_type` field
data_type = "2999"
report_heartbeat = "2997"

[attach]
### handle probe message in thread/sub-process mode.
handle_probe_message_mode = "process"
pangolin_path = ""
python_inject_path = ""
python_probe_path = ""
golang_probe_path = ""
jvm_jattach_path = ""
jvm_probe_path = ""

[server]
# process mode will start new unix-socket server for every namespace
# mode = "process"
# process_mode_bind_path = "/var/run"
# host_bind = true
mode = "thread"
bind_path = "/tmp/smith_agent.sock"
link_to = "/var/run/smith_agent.sock"



[service]
### create flock path
flock_path = "elkeid_rasp.lock"
### cgroup max mem limit, defult 300Mb
cgroup_name = "elkeid_rasp"
### mega byte
cgroup_mem_limit = 300
### log
log_level = "debug"
log_path = "."
remote_log_level = "error"
max_backups = 20


# ==== internal config ====
# !!!! edit carefully !!!!
[internal]
internal_message_capability = 1000
collect_thread_limit = 10
collect_thread_wait_message_duration = 400

external_message_capability = 50
pid_queue_length = 1000
pid_poll_interval = 60
clean_up_interval = 60
report_interval = 300
