FROM cern/cc7-base:latest AS rhel7

RUN yum install -y wget perl gcc make tree elfutils-libelf-devel yumdownloader; 
RUN yum groupinstall -y  "Development Tools"; 
RUN mkdir /root/headers
RUN for each_tag in `yum --showduplicates list kernel-devel | grep kernel-devel | awk -c '{print $2}'`; do yumdownloader  --destdir /root/headers kernel-devel-$each_tag.x86_64; done
RUN rpm --force -ivh /root/headers/*.rpm || true

<<<<<<< HEAD
<<<<<<< HEAD
ADD . /elkeid
WORKDIR /elkeid/driver
=======
ADD . /elkeid_driver
WORKDIR /elkeid_driver
>>>>>>> 707aed2 (update driver auto_build)
=======
ADD . /elkeid
WORKDIR /elkeid/driver
>>>>>>> 6fc7695 (fix docker path)
RUN bash ./batch_compile.sh