(window.webpackJsonp=window.webpackJsonp||[]).push([[122,231,390,394],{1409:function(e,r,t){e.exports={container:"container-f613c819e1","count-box":"count-box-6a25883431"}},1440:function(e,r,t){e.exports={utils:"utils-a87b02fc67"}},1624:function(e,r,t){"use strict";t.d(r,"b",(function(){return g}));var n=t(50),a=t.n(n),c=t(10),u=t.n(c),i=t(75),o=t.n(i),s=t(51),l=t.n(s),m=t(0),b=t(794),f=t(163),d=t(606);function p(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?p(Object(t),!0).forEach((function(r){u()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var g={number:function(e){return Number(String(e))},numberArray:function(e){return e?"string"==typeof e?[Number(e)]:Array.isArray(e)?e.map(Number):[]:[]},string:String,stringArray:function(e){return e?"string"==typeof e?[String(e)]:e:[]},boolean:function(e){if(!e)return!1;if(Array.isArray(e))return!0;return!["0","false","null","undefined"].includes(e)}};r.a=function(e){var r,t=e.initParams,n=e.namespace,c=void 0===n?"":n,i=e.visible,s=void 0===i||i,p=e.autoMergeUrlParams,N=void 0!==p&&p,O=Object(m.useContext)(d.a),_=O.addListener,j=O.removeListener,y=O.dispatchUrlParams,h=O.getCurrentUrlParams,x=O.setVisible,E=O.debugMode,P=Object(m.useRef)();if(!P.current){var w={},D={};P.current={},P.current.adapters=D,P.current.filterKeys=[],P.current.namespace=c,Object.keys(t).forEach((function(e){var r=t[e];Array.isArray(r)?(w[e]=r,D[e]=g.stringArray):"object"===o()(r)?(w[e]=r.value,"string"==typeof r.adapter?D[e]=g[r.adapter]:D[e]=r.adapter,r.isFilter&&P.current.filterKeys.push(e),r.isSorter&&(P.current.sorterKey=e,D[e]=g.string),r.isPageSize&&(P.current.pageSizeKey=e,D[e]=g.number),r.isCurrent&&(P.current.currentKey=e,D[e]=g.number)):(w[e]=r,void 0===r?D[e]=g.string:g[o()(r)]?D[e]=g[o()(r)]:Array.isArray(r)&&(0===r.length?D[e]=g.stringArray:"number"==typeof r[0]?D[e]=g.numberArray:D[e]=g.stringArray))})),r=v(v({},w),h(c)),E&&console.log("合成初始参数",r)}var A=Object(m.useState)(r),S=a()(A,2),k=S[0],C=S[1];P.current.value=k,P.current.setValue=C,P.current.visible=s,Object(m.useEffect)((function(){var e=function(e){var r=P.current,t=r.value,n=r.setValue;if(function(e,r){for(var t=0,n=Object.keys(r);t<n.length;t++){var a=n[t];if(Array.isArray(r[a])){var c=e[a]?l()(e[a]).sort():[],u=l()(r[a]).sort();if(JSON.stringify(c)!==JSON.stringify(u))return!0}else if(r[a]!==e[a])return!0}return!1}(e,t)){var a=v({},t);Object.keys(a).forEach((function(e){""!==a[e]&&(Array.isArray(a[e])&&!a[e].length||(a[e]=void 0))})),n(v(v({},a),e))}};return _(e,null==s||s,c),function(){return j(e)}}),[]),Object(m.useEffect)((function(){y(k,c)}),[]),Object(m.useEffect)((function(){x(s,c)}),[s]);var z={};Object.keys(k).forEach((function(e){var r=P.current.adapters;z[e]=k[e]?r[e]?r[e](k[e]):g.string(k[e]):void 0}));var T={};[].concat(l()(P.current.filterKeys),[P.current.sorterKey,P.current.pageSizeKey,P.current.currentKey]).forEach((function(e){return T[e]=k[e]}));var I=function(e){var r=P.current.value,t="function"==typeof e?e(r):e;E&&console.log("开始更新",r);var n=v({},r),a=Object.keys(r),c=P.current.namespace;N||Object.keys(n).forEach((function(e){return n[e]=void 0})),Object.keys(t).forEach((function(e){a.includes(e)&&(n[e]=t[e])})),E&&console.log("更新结束",n),E&&console.log("差异",Object(f.difference)(Object.entries(n).map((function(e){return"".concat(e[0],":").concat(e[1])})),Object.entries(r).map((function(e){return"".concat(e[0],":").concat(e[1])})))),C(n),P.current.value=n,y(n,c)};return E&&console.log("".concat(P.current.namespace||"全局","参数"),z,P.current.adapters),{globalUrlParams:Object(b.a)(z),tableChangeDeps:Object(b.a)(T),setGlobalUrlParams:I,tablePropsProxy:function(e){var r=P.current.tableProps;P.current.tableProps=e;var t=P.current,n=t.filterKeys,a=t.sorterKey,c=t.pageSizeKey,i=t.currentKey,o=t.value;return null!=r&&r.loading&&o[i]&&+o[i]>1&&(void 0===e.data||null===e.data||"[]"===JSON.stringify(e.data))&&I((function(e){return v(v({},e),{},u()({},i,"1"))})),v(v({},e),{},{pagination:v(v({},e.pagination),{},{current:o[i]?+o[i]:1,pageSize:o[c]?+o[c]:10}),onChange:function(){for(var e,r=arguments.length,t=new Array(r),s=0;s<r;s++)t[s]=arguments[s];var l={},m={},b=t[0],f=b.pageSize,d=b.current,p=P.current.tableProps;a===t[1].field&&(m[a]=t[1].direction),n.forEach((function(e){return l[e]=t[2][e]}));var g=v(v((e={},u()(e,c,String(f)),u()(e,i,String(d)),e),l),m);E&&console.log("table触发的更新",t),I(v(v({},o),g)),p.onChange.apply(p,t)}})}}}},1625:function(e,r,t){"use strict";var n;t.d(r,"a",(function(){return n})),t.d(r,"b",(function(){return a})),function(e){e.virusAlarmSummary="vas",e.virusAlarmOverview="vao",e.virusAlarm="va",e.abnormalList="ab",e.alarmList="al",e.raspAlarmList="ral",e.threatresList="tl",e.vulnDetail="vd",e.alarmDrawer="alarmd",e.exposurePathDrawer="epd",e.kubeExposure="kb",e.hostExposure="hb",e.hostExposureDetailDrawer="hedd",e.eventSummaryDrawer="esd",e.eventListTabe="elt"}(n||(n={}));var a=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((function(e){return!!e})).join(":")}},1628:function(e,r,t){"use strict";t(1314);var n=t(810),a=t(1),c=t.n(a),u=t(10),i=t.n(u),o=t(2),s=t.n(o),l=t(0),m=t.n(l),b=["onChange","pagination"];function f(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?f(Object(t),!0).forEach((function(r){i()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}r.a=function(e){var r=e.onChange,t=e.pagination,a=s()(e,b);return m.a.createElement(n.a,c()({onChange:function(e,t,n,a){"filter"===a.action||"sort"===a.action?r(d(d({},e),{},{current:1}),t,n,a):r(e,t,n,a)},border:!1,pagination:(null==t?void 0:t.total)>10&&d(d({},t),{},{sizeCanChange:!0,sizeOptions:[10,20,50,100]})},a,{__source:{fileName:"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/table/index.tsx",lineNumber:6,columnNumber:5}}))}},1634:function(e,r,t){"use strict";t.r(r),t.d(r,"DescribeHostStatistics",(function(){return c})),t.d(r,"DescribeHosts",(function(){return u})),t.d(r,"ExportHosts",(function(){return i})),t.d(r,"DownloadFile",(function(){return o})),t.d(r,"DescribeTags",(function(){return s})),t.d(r,"AddTags",(function(){return l})),t.d(r,"DeleteTags",(function(){return m})),t.d(r,"UpdateTags",(function(){return b})),t.d(r,"DescribePlatforms",(function(){return f})),t.d(r,"DescribeIDCs",(function(){return d})),t.d(r,"PostApiV6AssetCenterEnableHostImportantProtect",(function(){return p})),t.d(r,"PostApiV6AssetCenterDisableHostImportantProtect",(function(){return v}));var n=t(54),a=t(12),c=function(){return Object(n.b)({method:"get",url:"/api/v6/asset-center/DescribeHostStatistics"},Object(a.g)("获取主机统计信息"))},u=function(e){var r=e.data,t=e.params;return Object(n.b)({method:"post",url:"/api/v6/asset-center/DescribeHosts",data:r,params:t},Object(a.g)("获取主机列表信息"))},i=function(e){var r=e.data;return Object(n.b)({method:"post",url:"/api/v6/asset-center/ExportHosts",data:r},Object(a.g)("导出主机信息"))},o=function(e){var r=e.params;return Object(n.b)({method:"get",url:"/api/v6/shared/Download/".concat(r.file_name),responseType:"blob"},Object(a.g)("下载文件"),!1,!1)},s=function(){return Object(n.b)({method:"get",url:"/api/v6/asset-center/DescribeTags"},Object(a.g)("获取标签信息"))},l=function(e){var r=e.data;return Object(n.b)({method:"post",url:"/api/v6/asset-center/AddTags",data:r},Object(a.g)("添加标签"),!0)},m=function(e){var r=e.data;return Object(n.b)({method:"post",url:"/api/v6/asset-center/DeleteTags",data:r},Object(a.g)("删除标签"),!0)},b=function(e){var r=e.data;return Object(n.b)({method:"post",url:"/api/v6/asset-center/UpdateTags",data:r},Object(a.g)("修改标签"),!0)},f=function(){return Object(n.b)({method:"get",url:"/api/v6/asset-center/DescribePlatform"},Object(a.g)("获取操作系统类型"))},d=function(){return Object(n.b)({method:"get",url:"/api/v6/asset-center/DescribeIDC"},Object(a.g)("获取数据中心类型"))};function p(e){return Object(n.b)({url:"/api/v6/asset-center/EnableHostImportantProtect",data:e,method:"POST"},Object(a.g)("开启主机重保模式"))}function v(e){return Object(n.b)({url:"/api/v6/asset-center/DisableHostImportantProtect",data:e,method:"POST"},Object(a.g)("关闭主机重保模式"))}},1716:function(e,r,t){"use strict";t.d(r,"a",(function(){return s})),t.d(r,"b",(function(){return l})),t.d(r,"c",(function(){return a})),t.d(r,"e",(function(){return m})),t.d(r,"d",(function(){return b}));var n,a,c=t(10),u=t.n(c),i=t(54),o=t(12);function s(){return Object(i.b)({url:"/api/v6/exposure/ContainerStatistic",method:"GET"},Object(o.g)("获取容器集群风险统计信息"))}function l(e){return Object(i.b)({url:"/api/v6/exposure/GetExposurePath",params:e,method:"GET"},Object(o.g)("获取暴露路径图数据"))}!function(e){e.intranet="intranet",e.extranet="extranet"}(a||(a={}));var m=(n={},u()(n,a.intranet,Object(o.g)("私网暴露")),u()(n,a.extranet,Object(o.g)("公网暴露")),n);function b(e,r){return Object(i.b)({url:"/api/v6/exposure/GetContainerRiskList",params:e,data:r,method:"POST"},Object(o.g)("获取容器集群风险列表"))}},407:function(e,r,t){"use strict";t.r(r);var n=t(28),a=t.n(n),c=t(16),u=t.n(c),i=t(0),o=t.n(i),s=t(1292),l=t(115),m=t.n(l),b=t(1656),f=t(196),d=t(1745),p=t(1716),v=t(12),g=t(1409),N=t.n(g),O="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/exposure/overview/index.tsx",_=m.a.bind(N.a);r.default=function(e){var r=e.type,t=Object(s.a)(a()(u.a.mark((function e(){var r,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.b)();case 2:return r=e.sent,t=r.data,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),{ready:"host"===r,auto:!0}),n=t.data,c=t.loading,i=t.error,l=Object(s.a)(a()(u.a.mark((function e(){var r,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.a)();case 2:return r=e.sent,t=r.data,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),{ready:"kube"===r,auto:!0}),m=l.data,g=l.loading,N=l.error;return"host"===r?o.a.createElement(f.a,{loading:c,error:i,displayType:f.b.element,errorStyle:{margin:"2px 0"},__source:{fileName:O,lineNumber:37,columnNumber:7}},o.a.createElement("div",{className:_("container"),__source:{fileName:O,lineNumber:43,columnNumber:9}},o.a.createElement("div",{className:_("count-box"),__source:{fileName:O,lineNumber:44,columnNumber:11}},o.a.createElement(b.a,{title:Object(v.g)("暴露资产数量"),count:null==n?void 0:n.host,__source:{fileName:O,lineNumber:45,columnNumber:13}})),o.a.createElement("div",{className:_("count-box"),__source:{fileName:O,lineNumber:47,columnNumber:11}},o.a.createElement(b.a,{title:Object(v.g)("弱口令"),count:null==n?void 0:n.weak_password,__source:{fileName:O,lineNumber:48,columnNumber:13}})),o.a.createElement("div",{className:_("count-box"),__source:{fileName:O,lineNumber:50,columnNumber:11}},o.a.createElement(b.a,{title:Object(v.g)("高可利用性漏洞"),count:null==n?void 0:n.high_available_vuln,__source:{fileName:O,lineNumber:51,columnNumber:13}})),o.a.createElement("div",{className:_("count-box"),__source:{fileName:O,lineNumber:53,columnNumber:11}},o.a.createElement(b.a,{title:Object(v.g)("入侵检测告警"),count:null==n?void 0:n.alarm,__source:{fileName:O,lineNumber:54,columnNumber:13}})))):o.a.createElement(f.a,{loading:g,error:N,displayType:f.b.element,errorStyle:{margin:"2px 0"},__source:{fileName:O,lineNumber:61,columnNumber:5}},o.a.createElement("div",{className:_("container"),__source:{fileName:O,lineNumber:67,columnNumber:7}},o.a.createElement("div",{className:_("count-box"),__source:{fileName:O,lineNumber:68,columnNumber:9}},o.a.createElement(b.a,{title:Object(v.g)("暴露资产数量"),count:null==m?void 0:m.agent_num,__source:{fileName:O,lineNumber:69,columnNumber:11}})),o.a.createElement("div",{className:_("count-box"),__source:{fileName:O,lineNumber:71,columnNumber:9}},o.a.createElement(b.a,{title:Object(v.g)("公网暴露资产数"),count:null==m?void 0:m.public_num,description:Object(v.g)("集群的 Node、Workloads 暴露到了公网，任何人都可访问它们。（注：VPC 内的任意客户端也均可访问它们）"),__source:{fileName:O,lineNumber:72,columnNumber:11}})),o.a.createElement("div",{className:_("count-box"),__source:{fileName:O,lineNumber:80,columnNumber:9}},o.a.createElement(b.a,{title:Object(v.g)("私网暴露资产数"),count:null==m?void 0:m.private_num,description:Object(v.g)("集群的 Workloads 仅暴露到了 VPC 私网，VPC 内的任意客户端均可访问它们。（注：集群的 Node 默认暴露在 VPC 私网内，因此不做统计和展示）"),__source:{fileName:O,lineNumber:81,columnNumber:11}})),o.a.createElement("div",{className:_("count-box"),__source:{fileName:O,lineNumber:89,columnNumber:9}},o.a.createElement(b.a,{title:Object(v.g)("关联 RBAC 权限的资产数"),count:null==m?void 0:m.rbac_num,description:Object(v.g)("Workloads 关联了非默认的服务账户，可能具有访问集群 API Server 的特权"),__source:{fileName:O,lineNumber:90,columnNumber:11}}))))}},447:function(e,r,t){"use strict";t.r(r);t(224);var n=t(97),a=(t(162),t(67)),c=(t(116),t(42)),u=t(1),i=t.n(u),o=(t(225),t(127)),s=(t(814),t(611)),l=t(2),m=t.n(l),b=t(28),f=t.n(b),d=t(16),p=t.n(d),v=t(0),g=t.n(v),N=t(1603),O=t(1412),_=t(599),j=t(115),y=t.n(j),h=t(1609),x=t(1614),E=t(1613),P=t(1760),w=t(594),D=t(407),A=t(446),S=t(1745),k=t(1620),C=t(12),z=t(1625),T=t(1624),I=t(1440),K=t.n(I),U="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/exposure/host-exposure/index.tsx",H=["current","page_size"],L=y.a.bind(K.a);r.default=function(e){var r=e.visible,t={visible:!1,id:void 0},u=Object(T.a)({initParams:t,namespace:z.a.hostExposureDetailDrawer,visible:r}),l=u.globalUrlParams,b=u.setGlobalUrlParams,d=[{text:Object(C.g)("主机名"),value:"hostname"},{text:Object(C.g)("主机ID"),value:"agent_id"},{text:Object(C.g)("主机IP"),value:"ip"},{text:Object(C.g)("暴露服务"),value:"exposure_service"}],v={current:{value:1,adapter:T.b.number,isCurrent:!0},page_size:{value:10,adapter:T.b.number,isPageSize:!0},hostname:void 0,agent_id:void 0,ip:void 0,exposure_service:void 0,exposure_by:{value:[],adapter:T.b.stringArray,isFilter:!0}},j=Object(T.a)({initParams:v,namespace:z.a.hostExposure,autoMergeUrlParams:!0,visible:r}),y=j.globalUrlParams,I=j.setGlobalUrlParams,K=j.tablePropsProxy,V=Object(_.a)(f()(p.a.mark((function e(){var r,t,n,a,c,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.current,t=y.page_size,n=m()(y,H),e.next=3,Object(S.e)({page:r,page_size:t},n);case 3:return a=e.sent,c=a.data,u=a.page_info,e.abrupt("return",{list:c,total:(null==u?void 0:u.total)||0});case 7:case"end":return e.stop()}}),e)}))),{auto:!0,refreshDeps:[y]}),G=V.tableProps,F=V.refresh,J=[{title:Object(C.g)("主机"),dataIndex:"hostname",render:function(e,r){return g.a.createElement("div",{__source:{fileName:U,lineNumber:103,columnNumber:11}},g.a.createElement(w.a,{style:{marginLeft:-8},target:"_blank",href:"/host-detail?agentId=".concat(null==r?void 0:r.agent_id,"&breadcrumbLinkFrom=").concat(Object(h.b)()),__source:{fileName:U,lineNumber:104,columnNumber:13}},e))}},{title:Object(C.g)("暴露方式"),dataIndex:"exposure_by",filters:[{text:Object(C.g)("公网暴露"),value:S.c.ip},{text:Object(C.g)("对外服务"),value:S.c.service}],filteredValue:y.exposure_by,render:function(e){return void 0===e||0===(null==e?void 0:e.length)?"-":g.a.createElement(o.a,{size:8,__source:{fileName:U,lineNumber:129,columnNumber:11}},null==e?void 0:e.map((function(e){return g.a.createElement(s.a,{key:e,__source:{fileName:U,lineNumber:131,columnNumber:15}},S.f[e])})))}},{title:Object(C.g)("暴露服务"),dataIndex:"exposure_service",render:function(e){return g.a.createElement(N.a,{list:e,__source:{fileName:U,lineNumber:141,columnNumber:16}})}},{title:Object(C.g)("暴露风险"),dataIndex:"risk",render:function(e,r){return g.a.createElement("div",{style:{display:"flex",flex:1,width:260},__source:{fileName:U,lineNumber:149,columnNumber:11}},g.a.createElement(P.a,{number:(null==r?void 0:r.risk.weak_password)||0,title:Object(C.g)("弱口令"),__source:{fileName:U,lineNumber:150,columnNumber:13}}),g.a.createElement(P.a,{number:(null==r?void 0:r.risk.high_available_vuln)||0,title:Object(C.g)("漏洞"),__source:{fileName:U,lineNumber:151,columnNumber:13}}),g.a.createElement(P.a,{number:(null==r?void 0:r.risk.alarm)||0,title:Object(C.g)("告警"),__source:{fileName:U,lineNumber:152,columnNumber:13}}))}},{title:Object(C.g)("操作"),dataIndex:"operation",render:function(e,r){return g.a.createElement(w.a,{onClick:function(){return b({visible:!0,id:r.agent_id})},__source:{fileName:U,lineNumber:162,columnNumber:11}},Object(C.g)("详情"))}}],R=Object(x.b)({}),M=i()({},R),W=M.selectedRowKeys,B=M.isSelectedAllFromFilter,q=B?{conditions:{agent_id:y.agent_id,hostname:y.hostname,ip:y.ip,exposure_service:y.exposure_service}}:{id_list:W},Q=!W.length&&!B;return g.a.createElement("div",{__source:{fileName:U,lineNumber:187,columnNumber:5}},g.a.createElement(D.default,{type:"host",__source:{fileName:U,lineNumber:188,columnNumber:7}}),g.a.createElement("div",{className:L("utils"),__source:{fileName:U,lineNumber:189,columnNumber:7}},g.a.createElement(a.a,{content:Object(C.g)("请先在下方选择告警信息后再批量导出"),trigger:"hover",disabled:!Q,__source:{fileName:U,lineNumber:190,columnNumber:9}},g.a.createElement(c.a,{disabled:Q,onClick:function(){Object(k.a)({url:"/api/v6/exposure/ExportHosts",data:q,notifyId:"exposure-hosts"})},__source:{fileName:U,lineNumber:195,columnNumber:11}},Object(C.g)("批量导出"))),g.a.createElement(E.a,{onRefresh:f()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:n.a.success(Object(C.g)("刷新成功"));case 3:case"end":return e.stop()}}),e)}))),__source:{fileName:U,lineNumber:208,columnNumber:9}})),g.a.createElement(O.a,{style:{margin:"16px 0"},options:d,value:y,onChange:function(e,r){return I(r)},__source:{fileName:U,lineNumber:215,columnNumber:7}}),g.a.createElement(x.a,i()({rowKey:"_id",columns:J},K(G),{rowSelection:M,__source:{fileName:U,lineNumber:221,columnNumber:7}})),g.a.createElement(A.default,{visible:l.visible,id:l.id,onClose:function(){return b({visible:!1})},__source:{fileName:U,lineNumber:227,columnNumber:7}}))}}}]);