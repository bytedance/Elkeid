(window.webpackJsonp=window.webpackJsonp||[]).push([[132,314,315,366,510],{1510:function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n.n(a);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.default=function(e){return c.a.createElement("svg",i({width:16,height:16,fill:"none"},e),r||(r=c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 .666a7.333 7.333 0 110 14.667A7.333 7.333 0 018 .666zm0 1.333a6 6 0 100 12A6 6 0 008 2zm.333 5c.184 0 .334.15.334.334v3h.541c.184 0 .334.149.334.333v.708c0 .184-.15.334-.334.334H6.667a.333.333 0 01-.334-.334v-.708c0-.184.15-.333.334-.333h.666V8.374H7a.333.333 0 01-.333-.333v-.708c0-.184.149-.334.333-.334h1.333zm0-2.666c.184 0 .334.149.334.333v1c0 .184-.15.333-.334.333h-1A.333.333 0 017 5.666v-1c0-.184.15-.333.333-.333h1z",fill:"#86909C"})))}},1511:function(e,t,n){e.exports={title:"title-55dd801608","sub-title":"sub-title-0e681f437e"}},1608:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n.n(r),c=n(70),i=n.n(c),o="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/utils/get-display-time.tsx";function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var r=i.a.unix(e).format(t);if(n){var c=null==r?void 0:r.split(" ");return a.a.createElement(a.a.Fragment,null,null==c?void 0:c.map((function(e){return a.a.createElement("div",{key:e,__source:{fileName:o,lineNumber:12,columnNumber:13}},e)})))}return r}return"-"}},1620:function(e,t,n){"use strict";var r,a,c=n(1320),i=n(28),o=n.n(i),u=(n(809),n(607)),l=n(64),s=(n(602),n(146)),m=n(16),b=n.n(m),d=n(0),f=n.n(d),p=n(799),g=n(115),v=n.n(g),N=n(1319),h=n(594),O=n(54),_=n(1634),j=n(12),E=n(74);function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var x,k=function(e){return f.a.createElement("svg",y({width:16,height:20,fill:"none"},e),f.a.createElement("mask",{id:"export-file_svg__a",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:16,height:20},r||(r=f.a.createElement("path",{d:"M1.103 0h10.24c.146 0 .285.056.389.157l4.105 3.985c.104.101.163.24.163.384v14.393c0 .597-.494 1.081-1.103 1.081H1.103C.494 20 0 19.516 0 18.919V1.08C0 .484.494 0 1.103 0z",fill:"#fff"}))),a||(a=f.a.createElement("g",{mask:"url(#export-file_svg__a)"},f.a.createElement("path",{d:"M1.103 0h10.24c.146 0 .285.056.389.157l4.105 3.985c.104.101.163.24.163.384v14.393c0 .597-.494 1.081-1.103 1.081H1.103C.494 20 0 19.516 0 18.919V1.08C0 .484.494 0 1.103 0z",fill:"#1664FF"}),f.a.createElement("path",{fill:"#fff",d:"M4 6h8v1H4zM4 10h8v1H4zM4 14h6v1H4z"}),f.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.57 0h4.414v4.324h-3.31c-.61 0-1.104-.484-1.104-1.08V0z",fill:"#94BFFF"}))))},w=n(1635),T=n.n(w),D="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/utils/gen-sse-export/index.tsx",H=v.a.bind(T.a);!function(e){e.init="init",e.exporting="exporting",e.saving="saving",e.success="success",e.failed="failed"}(x||(x={}));t.a=function(e){var t=e.url,n=e.data,r=e.notifyId,a=void 0===r?"EXPORT_NOTIFY_ID":r,i=e.method,m=void 0===i?"POST":i,d=Object(E.a)(),g=new N.SSE("".concat(O.a).concat(t),{headers:{Token:d},method:m,payload:JSON.stringify(n)});g.addEventListener("open",(function(e){console.log("open",e)}),!1),g.addEventListener("progress",(function(e){console.log("progress",e);var t=JSON.parse(e.data)||{},n=null==t?void 0:t.data,r=n.export_total,i=n.export_count,m=n.status,d=n.file_name;if(m===x.init||m===x.exporting||m===x.saving){var v=Math.round(i/r*100);v>99&&(v=99),s.a.info({id:a,icon:f.a.createElement(l.a,{__source:{fileName:D,lineNumber:86,columnNumber:17}}),title:Object(j.g)("正在导出"),duration:9e5,content:f.a.createElement("div",{className:H("container"),__source:{fileName:D,lineNumber:90,columnNumber:13}},f.a.createElement(k,{style:{marginRight:"12px"},__source:{fileName:D,lineNumber:91,columnNumber:15}}),f.a.createElement(p.a,{showTooltip:{type:"tooltip",props:{triggerProps:{className:H("name")}}},__source:{fileName:D,lineNumber:92,columnNumber:15}},d),f.a.createElement(u.a,{percent:v,type:"circle",size:"mini",style:{width:"16px",height:"16px"},__source:{fileName:D,lineNumber:104,columnNumber:15}}))})}else m===x.success&&(s.a.success({id:a,title:Object(j.g)("导出成功"),duration:9e5,content:f.a.createElement("div",{className:H("container"),__source:{fileName:D,lineNumber:119,columnNumber:13}},f.a.createElement(k,{style:{marginRight:"12px"},__source:{fileName:D,lineNumber:120,columnNumber:15}}),f.a.createElement(p.a,{tooltip:!1,showTooltip:{type:"tooltip",props:{triggerProps:{className:H("name")}}},__source:{fileName:D,lineNumber:121,columnNumber:15}},d),f.a.createElement(h.a,{style:{marginRight:"-8px"},onClick:o()(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.DownloadFile)({params:{file_name:d}});case 2:s.a.remove(a);case 3:case"end":return e.stop()}}),e)}))),icon:f.a.createElement(c.a,{__source:{fileName:D,lineNumber:144,columnNumber:23}}),__source:{fileName:D,lineNumber:134,columnNumber:15}},Object(j.g)("下载")))}),g.close())}),!1),g.addEventListener("error",(function(e){console.log("error",e),g.close()}),!1),g.stream()}},1634:function(e,t,n){"use strict";n.r(t),n.d(t,"DescribeHostStatistics",(function(){return c})),n.d(t,"DescribeHosts",(function(){return i})),n.d(t,"ExportHosts",(function(){return o})),n.d(t,"DownloadFile",(function(){return u})),n.d(t,"DescribeTags",(function(){return l})),n.d(t,"AddTags",(function(){return s})),n.d(t,"DeleteTags",(function(){return m})),n.d(t,"UpdateTags",(function(){return b})),n.d(t,"DescribePlatforms",(function(){return d})),n.d(t,"DescribeIDCs",(function(){return f})),n.d(t,"PostApiV6AssetCenterEnableHostImportantProtect",(function(){return p})),n.d(t,"PostApiV6AssetCenterDisableHostImportantProtect",(function(){return g}));var r=n(54),a=n(12),c=function(){return Object(r.b)({method:"get",url:"/api/v6/asset-center/DescribeHostStatistics"},Object(a.g)("获取主机统计信息"))},i=function(e){var t=e.data,n=e.params;return Object(r.b)({method:"post",url:"/api/v6/asset-center/DescribeHosts",data:t,params:n},Object(a.g)("获取主机列表信息"))},o=function(e){var t=e.data;return Object(r.b)({method:"post",url:"/api/v6/asset-center/ExportHosts",data:t},Object(a.g)("导出主机信息"))},u=function(e){var t=e.params;return Object(r.b)({method:"get",url:"/api/v6/shared/Download/".concat(t.file_name),responseType:"blob"},Object(a.g)("下载文件"),!1,!1)},l=function(){return Object(r.b)({method:"get",url:"/api/v6/asset-center/DescribeTags"},Object(a.g)("获取标签信息"))},s=function(e){var t=e.data;return Object(r.b)({method:"post",url:"/api/v6/asset-center/AddTags",data:t},Object(a.g)("添加标签"),!0)},m=function(e){var t=e.data;return Object(r.b)({method:"post",url:"/api/v6/asset-center/DeleteTags",data:t},Object(a.g)("删除标签"),!0)},b=function(e){var t=e.data;return Object(r.b)({method:"post",url:"/api/v6/asset-center/UpdateTags",data:t},Object(a.g)("修改标签"),!0)},d=function(){return Object(r.b)({method:"get",url:"/api/v6/asset-center/DescribePlatform"},Object(a.g)("获取操作系统类型"))},f=function(){return Object(r.b)({method:"get",url:"/api/v6/asset-center/DescribeIDC"},Object(a.g)("获取数据中心类型"))};function p(e){return Object(r.b)({url:"/api/v6/asset-center/EnableHostImportantProtect",data:e,method:"POST"},Object(a.g)("开启主机重保模式"))}function g(e){return Object(r.b)({url:"/api/v6/asset-center/DisableHostImportantProtect",data:e,method:"POST"},Object(a.g)("关闭主机重保模式"))}},1635:function(e,t,n){e.exports={container:"container-89c01f30b7",name:"name-b0b73f3090"}},537:function(e,t,n){"use strict";n.r(t);n(225);var r=n(127),a=(n(600),n(198)),c=(n(116),n(42)),i=(n(162),n(67)),o=(n(1394),n(1401)),u=(n(224),n(97)),l=n(28),s=n.n(l),m=n(50),b=n.n(m),d=n(16),f=n.n(d),p=n(0),g=n.n(p),v=n(1292),N=n(115),h=n.n(N),O=n(596),_=n(54),j=n(12);function E(e){return Object(_.b)({url:"/api/v6/config/backup/configure/recovery",data:e,method:"POST"},Object(j.g)("恢复数据备份"))}var y=n(1620),x=n(1608),k=n(1511),w=n.n(k),T=n(1510),D="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/backup-configure/index.tsx",H=h.a.bind(w.a);t.default=function(){var e=Object(p.useRef)(),t=Object(p.useState)(),n=b()(t,2),l=n[0],m=n[1],d=Object(v.a)(s()(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.b)({url:"/api/v6/config/backup/configure/getConfig",method:"GET"},Object(j.g)("获取配置备份"));case 2:return t=e.sent,n=t.data,e.abrupt("return",null==n?void 0:n.enable_configure_backup);case 5:case"end":return e.stop()}}),e)}))),{auto:!0}),N=d.data,h=d.refresh,k=Object(v.a)(s()(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.b)({url:"/api/v6/config/backup/configure/list",method:"GET"},Object(j.g)("获取自动备份列表"));case 2:return t=e.sent,n=t.data,e.abrupt("return",null==n?void 0:n.map((function(e){return{id:e.id,name:"".concat(Object(x.a)(e.time)," - ").concat(e.name)}})));case 5:case"end":return e.stop()}}),e)}))),{auto:!0}).data;return g.a.createElement(O.a,{title:Object(j.g)("配置备份与恢复"),contentStyle:{paddingTop:20},__source:{fileName:D,lineNumber:49,columnNumber:5}},g.a.createElement("div",{__source:{fileName:D,lineNumber:50,columnNumber:7}},g.a.createElement("div",{style:{display:"flex",alignItems:"center"},__source:{fileName:D,lineNumber:51,columnNumber:9}},Object(j.g)("系统配置备份"),!N&&g.a.createElement("span",{style:{color:"#4E5969"},__source:{fileName:D,lineNumber:54,columnNumber:13}},Object(j.g)("（开启后将自动保存近 7 天的备份文件）")),g.a.createElement(o.a,{size:"small",checked:N,onChange:function(){var e=s()(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n={enable_configure_backup:t},Object(_.b)({url:"/api/v6/config/backup/configure/updateConfig",data:n,method:"POST"},Object(j.g)("更新配置备份"));case 3:h(),u.a.success(Object(j.g)(t?"开启成功":"关闭成功")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),u.a.error(Object(j.g)(t?"开启失败":"关闭失败"));case 10:case"end":return e.stop()}var n}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),style:{margin:"0 8px"},__source:{fileName:D,lineNumber:58,columnNumber:11}}),N&&g.a.createElement(i.a,{content:Object(j.g)("开启后将自动保存近 7 天的备份文件"),__source:{fileName:D,lineNumber:73,columnNumber:13}},g.a.createElement(T.default,{__source:{fileName:D,lineNumber:74,columnNumber:15}})))),N&&g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{className:H("title"),__source:{fileName:D,lineNumber:82,columnNumber:11}},Object(j.g)("用户信息")),g.a.createElement(c.a,{type:"primary",onClick:function(){Object(y.a)({url:"/api/v6/config/backup/configure/export",method:"GET",notifyId:"backup-configure-export"})},__source:{fileName:D,lineNumber:83,columnNumber:11}},Object(j.g)("导出当前配置")),g.a.createElement("div",{className:H("title"),__source:{fileName:D,lineNumber:95,columnNumber:11}},Object(j.g)("恢复配置")),g.a.createElement("div",{className:H("sub-title"),__source:{fileName:D,lineNumber:96,columnNumber:11}},Object(j.g)("方案一：从自动备份中恢复")),g.a.createElement(r.a,{size:12,style:{marginBottom:20},__source:{fileName:D,lineNumber:97,columnNumber:11}},g.a.createElement(a.a,{placeholder:Object(j.g)("请根据时间选择备份文件"),style:{width:432},onChange:m,value:l,__source:{fileName:D,lineNumber:98,columnNumber:13}},null==k?void 0:k.map((function(e){return g.a.createElement(a.a.Option,{key:e.id,value:e.id,__source:{fileName:D,lineNumber:105,columnNumber:17}},e.name)}))),g.a.createElement(c.a,{disabled:!l,type:"primary",onClick:s()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E({source:"SystemAutoBackup",back_id:l});case 3:u.a.success(Object(j.g)("设置成功")),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),u.a.error(Object(j.g)("设置失败"));case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),__source:{fileName:D,lineNumber:110,columnNumber:13}},Object(j.g)("恢复"))),g.a.createElement("div",{className:H("sub-title"),__source:{fileName:D,lineNumber:129,columnNumber:11}},Object(j.g)("方案二：从本地文件中恢复")),g.a.createElement(c.a,{type:"primary",onClick:function(){var t;null==e||null===(t=e.current)||void 0===t||t.click()},__source:{fileName:D,lineNumber:130,columnNumber:11}},Object(j.g)("打开本地文件")),g.a.createElement("input",{hidden:!0,type:"file",ref:e,onChange:function(t){var n,r,a,c,i,o,l,m,b,d;if(null!=e&&null!==(n=e.current)&&void 0!==n&&null!==(r=n.files)&&void 0!==r&&r[0])if(null!=e&&null!==(a=e.current)&&void 0!==a&&null!==(c=a.files)&&void 0!==c&&null!==(i=c[0])&&void 0!==i&&i.name.endsWith(".zip")){u.a.info(Object(j.g)("正在上传 {filename}",{filename:null==e||null===(o=e.current)||void 0===o||null===(l=o.files)||void 0===l||null===(m=l[0])||void 0===m?void 0:m.name}));var p=new FileReader;p.onload=s()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E({source:"LocalFile",file:p.result});case 3:u.a.success(Object(j.g)("上传成功")),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),u.a.error(Object(j.g)("上传失败"));case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),p.readAsDataURL(null==e||null===(b=e.current)||void 0===b||null===(d=b.files)||void 0===d?void 0:d[0])}else u.a.error(Object(j.g)("仅支持上传zip格式文件"))},__source:{fileName:D,lineNumber:138,columnNumber:11}})))}}}]);