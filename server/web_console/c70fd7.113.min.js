(window.webpackJsonp=window.webpackJsonp||[]).push([[113,398],{1326:function(e,t,n){e.exports={container:"container-3bc62adbed","first-cell":"first-cell-8ab2c6285d","filter-container":"filter-container-77d16a85e2","select-container":"select-container-dd09eefdea",label:"label-becbbefe86","check-name":"check-name-14da88dcc3","ellipsis-item":"ellipsis-item-7c3a675552","check-result":"check-result-15a003b45c",tip:"tip-90d505222f","add-modal":"add-modal-3cad0806d7","cancel-modal":"cancel-modal-5e56f2ab2f","info-modal":"info-modal-313828e02e"}},1620:function(e,t,n){"use strict";var r,a,c=n(1320),i=n(28),l=n.n(i),o=(n(809),n(607)),u=n(64),s=(n(602),n(146)),m=n(16),b=n.n(m),d=n(0),f=n.n(d),p=n(799),N=n(115),_=n.n(N),g=n(1319),h=n(594),O=n(54),v=n(1634),j=n(12),y=n(74);function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var E,k=function(e){return f.a.createElement("svg",w({width:16,height:20,fill:"none"},e),f.a.createElement("mask",{id:"export-file_svg__a",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:16,height:20},r||(r=f.a.createElement("path",{d:"M1.103 0h10.24c.146 0 .285.056.389.157l4.105 3.985c.104.101.163.24.163.384v14.393c0 .597-.494 1.081-1.103 1.081H1.103C.494 20 0 19.516 0 18.919V1.08C0 .484.494 0 1.103 0z",fill:"#fff"}))),a||(a=f.a.createElement("g",{mask:"url(#export-file_svg__a)"},f.a.createElement("path",{d:"M1.103 0h10.24c.146 0 .285.056.389.157l4.105 3.985c.104.101.163.24.163.384v14.393c0 .597-.494 1.081-1.103 1.081H1.103C.494 20 0 19.516 0 18.919V1.08C0 .484.494 0 1.103 0z",fill:"#1664FF"}),f.a.createElement("path",{fill:"#fff",d:"M4 6h8v1H4zM4 10h8v1H4zM4 14h6v1H4z"}),f.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.57 0h4.414v4.324h-3.31c-.61 0-1.104-.484-1.104-1.08V0z",fill:"#94BFFF"}))))},P=n(1635),x=n.n(P),S="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/utils/gen-sse-export/index.tsx",I=_.a.bind(x.a);!function(e){e.init="init",e.exporting="exporting",e.saving="saving",e.success="success",e.failed="failed"}(E||(E={}));t.a=function(e){var t=e.url,n=e.data,r=e.notifyId,a=void 0===r?"EXPORT_NOTIFY_ID":r,i=e.method,m=void 0===i?"POST":i,d=Object(y.a)(),N=new g.SSE("".concat(O.a).concat(t),{headers:{Token:d},method:m,payload:JSON.stringify(n)});N.addEventListener("open",(function(e){console.log("open",e)}),!1),N.addEventListener("progress",(function(e){console.log("progress",e);var t=JSON.parse(e.data)||{},n=null==t?void 0:t.data,r=n.export_total,i=n.export_count,m=n.status,d=n.file_name;if(m===E.init||m===E.exporting||m===E.saving){var _=Math.round(i/r*100);_>99&&(_=99),s.a.info({id:a,icon:f.a.createElement(u.a,{__source:{fileName:S,lineNumber:86,columnNumber:17}}),title:Object(j.g)("正在导出"),duration:9e5,content:f.a.createElement("div",{className:I("container"),__source:{fileName:S,lineNumber:90,columnNumber:13}},f.a.createElement(k,{style:{marginRight:"12px"},__source:{fileName:S,lineNumber:91,columnNumber:15}}),f.a.createElement(p.a,{showTooltip:{type:"tooltip",props:{triggerProps:{className:I("name")}}},__source:{fileName:S,lineNumber:92,columnNumber:15}},d),f.a.createElement(o.a,{percent:_,type:"circle",size:"mini",style:{width:"16px",height:"16px"},__source:{fileName:S,lineNumber:104,columnNumber:15}}))})}else m===E.success&&(s.a.success({id:a,title:Object(j.g)("导出成功"),duration:9e5,content:f.a.createElement("div",{className:I("container"),__source:{fileName:S,lineNumber:119,columnNumber:13}},f.a.createElement(k,{style:{marginRight:"12px"},__source:{fileName:S,lineNumber:120,columnNumber:15}}),f.a.createElement(p.a,{tooltip:!1,showTooltip:{type:"tooltip",props:{triggerProps:{className:I("name")}}},__source:{fileName:S,lineNumber:121,columnNumber:15}},d),f.a.createElement(h.a,{style:{marginRight:"-8px"},onClick:l()(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.DownloadFile)({params:{file_name:d}});case 2:s.a.remove(a);case 3:case"end":return e.stop()}}),e)}))),icon:f.a.createElement(c.a,{__source:{fileName:S,lineNumber:144,columnNumber:23}}),__source:{fileName:S,lineNumber:134,columnNumber:15}},Object(j.g)("下载")))}),N.close())}),!1),N.addEventListener("error",(function(e){console.log("error",e),N.close()}),!1),N.stream()}},1635:function(e,t,n){e.exports={container:"container-89c01f30b7",name:"name-b0b73f3090"}},1659:function(e,t,n){"use strict";n(162);var r,a=n(67),c=n(603),i=n.n(c),l=n(0),o=n.n(l),u=n(604),s=n(1657),m=n(12),b="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/risk-label/risk-light-label/index.tsx",d=u.a.div(r||(r=i()(["\n  display: inline-block;\n  padding: 0 8px;\n  line-height: 20px;\n  font-weight: 500;\n  font-size: 12px;\n  border-radius: 2px;\n  color: #ffffff;\n"])));t.a=function(e){var t=e.riskLevel,n=e.count,r=e.mode,c=void 0===r?"text":r,i=Object(s.n)(t),l=Object(s.o)(t);return t?"count"===c&&n?o.a.createElement(a.a,{content:l,__source:{fileName:b,lineNumber:30,columnNumber:9}},o.a.createElement(d,{style:{backgroundColor:i},__source:{fileName:b,lineNumber:31,columnNumber:11}},n)):"text"===c?o.a.createElement(d,{style:{backgroundColor:i},__source:{fileName:b,lineNumber:36,columnNumber:14}},l):null:o.a.createElement(d,{style:{backgroundColor:"#22BB43"},__source:{fileName:b,lineNumber:41,columnNumber:10}},Object(m.g)("无风险"))}},1662:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return N})),n.d(t,"h",(function(){return _})),n.d(t,"d",(function(){return g})),n.d(t,"j",(function(){return h})),n.d(t,"e",(function(){return O})),n.d(t,"g",(function(){return v})),n.d(t,"i",(function(){return j})),n.d(t,"f",(function(){return y}));n(600);var r=n(198),a=n(1),c=n.n(a),i=n(0),l=n.n(i),o=n(1682),u="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/enum-select/factory.tsx";var s=n(1617),m=n(1630),b=n(1631),d=n(1657),f=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=l.a.forwardRef((function(i,s){return l.a.createElement(r.a,c()({ref:s,options:Object(o.b)(e,t,n,a)},i,{__source:{fileName:u,lineNumber:30,columnNumber:5}}))}));return i}(d.b,s.a),p=Object(o.b)(d.a,s.g,[],[s.g.All,s.g.Part]),N=Object(o.b)(d.c,s.g,[],[s.g.All,s.g.Part]),_=Object(o.a)(d.k,b.PortType),g=Object(o.a)(d.d,b.ContainerState),h=Object(o.a)(d.p,b.SoftwareType,[],[b.SoftwareType.dpkg,b.SoftwareType.pypi,b.SoftwareType.rpm,b.SoftwareType.jar]),O=Object(o.a)(d.f,m.e,[m.e.None]),v=Object(o.a)(d.j,b.FingerprintServiceTypeEnum),j=Object(o.a)(d.i,b.FingerprintServiceRestartType),y=Object(o.a)(d.g,b.FingerprintKmodTypeEnum)},1663:function(e,t,n){"use strict";n(200);var r=n(85),a=n(10),c=n.n(a),i=(n(224),n(97)),l=n(0),o=n.n(l),u=n(12),s="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/loading/index.tsx";function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){var t=e.error;return Object(l.useEffect)((function(){t&&(console.warn(t),i.a.error({content:Object(u.g)("加载失败，请刷新页面重试！")}))})),t?null:o.a.createElement("div",{style:b({height:"100%",background:"#fff"},e.style),__source:{fileName:s,lineNumber:21,columnNumber:5}},o.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:s,lineNumber:22,columnNumber:7}},o.a.createElement(r.a,{size:20,__source:{fileName:s,lineNumber:30,columnNumber:9}})))}},1682:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return b}));var r=n(10),a=n.n(r),c=n(50),i=n.n(c);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],c=Object.entries(e).filter((function(e){var t=i()(e,1)[0];return Number.isNaN(Number(t))})).map((function(e){var t=i()(e,2);t[0];return t[1]}));if(a.length>0){var l=c.reduce((function(e,t,n){var r=o({},e);return r[t]=n,r}),{});n=a.map((function(e){return c[l[e]]}))}else n=c;return n.filter((function(e){return-1===r.findIndex((function(t){return t===e}))})).map(t)}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=function(t){return{label:e(t),value:t}};return u(t,a,n,r)}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=function(t){return{text:e(t),value:t}};return u(t,a,n,r)}function b(e,t,n){var r,a,c;return n?n[t]:null!==(r=null===(a=function(e){return Object.entries(e).filter((function(e){var t=i()(e,1)[0];return Number.isNaN(Number(t))}))}(e).filter((function(e){var n=i()(e,2);n[0];return n[1]!==t})))||void 0===a||null===(c=a[0])||void 0===c?void 0:c[1])&&void 0!==r?r:t}},1695:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(10),a=n.n(r),c=n(0),i=n.n(c),l=n(2),o=n.n(l),u=n(1657),s=n(1611),m=["code"];function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=[{key:"critical",code:s.b.danger},{key:"high",code:s.b.high},{key:"medium",code:s.b.mid},{key:"low",code:s.b.low},{key:"info",code:s.b.info}].map((function(e){var t=e.code;return d(d({},o()(e,m)),{},{code:t,title:Object(u.o)(t),color:Object(u.n)(t)})})),p=(n(1659),"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/risk-label/index.tsx");function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e){var t,n=e.risk,r=e.style;if(void 0===n)return i.a.createElement("div",{__source:{fileName:p,lineNumber:23,columnNumber:34}},"-");var a,c,l,o,u=(a=n,o=f.findIndex((function(e){return e.code===a})),{color:null===(c=f[o])||void 0===c?void 0:c.color,title:null===(l=f[o])||void 0===l?void 0:l.title});return i.a.createElement("div",{style:_({display:"inline-flex",alignItems:"center",flexWrap:"nowrap"},r),__source:{fileName:p,lineNumber:26,columnNumber:5}},i.a.createElement("div",{style:null!=u&&u.color?{backgroundColor:u.color,height:6,width:6,borderRadius:"50%",marginRight:6}:void 0,__source:{fileName:p,lineNumber:34,columnNumber:7}}),i.a.createElement("div",{__source:{fileName:p,lineNumber:47,columnNumber:7}},null!==(t=null==u?void 0:u.title)&&void 0!==t?t:"-"))}},351:function(e,t,n){"use strict";n.r(t);n(1314);var r=n(810),a=n(1),c=n.n(a),i=(n(224),n(97)),l=(n(197),n(117)),o=n(10),u=n.n(o),s=(n(116),n(42)),m=(n(225),n(127)),b=(n(162),n(67)),d=n(28),f=n.n(d),p=n(50),N=n.n(p),_=n(16),g=n.n(_),h=n(0),O=n.n(h),v=n(115),j=n.n(v),y=n(52),w=n(1613),E=n(1675),k=n(594),P=n(1695),x=n(1659),S=n(829),I=n(830),C=n(831),D=n(1617),z=n(1657),F=n(1620),R=n(12),T=n(1667),V=n(145),L=n(1699),M=n(1326),A=n.n(M),H="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/host-detail/baseline-list/baseline-detect/assets-risk-detail/index.tsx";function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=j.a.bind(A.a);t.default=function(e){var t,n,a=Object(y.f)(V.l),o=e.instanceId,u=e.baselineId,d=e.policyGroupId,p=e.onChangeSuccess,_=e.agentId,v=Object(h.useState)(!1),j=N()(v,2),M=j[0],A=j[1],q=Object(h.useState)({checklistIds:[],instanceId:"",baselineId:-1}),G=N()(q,2),K=G[0],U=G[1],W=Object(h.useState)(!1),X=N()(W,2),Y=X[0],Q=X[1],Z=Object(h.useState)({checklistIds:[],baselineId:-1,instanceId:""}),$=N()(Z,2),ee=$[0],te=$[1],ne=Object(h.useState)(!1),re=N()(ne,2),ae=re[0],ce=re[1],ie=Object(h.useState)({checklistId:-1,baselineId:u}),le=N()(ie,2),oe=le[0],ue=le[1],se=Object(h.useState)({}),me=N()(se,2),be=me[0],de=me[1],fe=Object(T.b)(function(){var e=f()(g.a.mark((function e(t){var n,r,a,c,i,l,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.current,i=t.pageSize,l=be.checklist_name,e.next=4,Object(D.o)({data:{baseline_id:u,agent_id:o,checklist_name:l||void 0},params:{page:c,page_size:i}});case 4:return s=e.sent,e.abrupt("return",{list:null!==(n=s.data)&&void 0!==n?n:[],total:null!==(r=null===(a=s.page_info)||void 0===a?void 0:a.total)&&void 0!==r?r:0});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{ready:Number.isFinite(u)&&!!o&&Number.isFinite(d),resetDeps:[u,o],debounceInterval:300,debounceResetDeps:[be.checklist_name]}),pe=fe.data,Ne=fe.tableProps,_e=fe.refresh,ge=Object(h.useState)({keys:[],rows:[]}),he=N()(ge,2),Oe=he[0],ve=he[1],je=Oe.keys.length>0;Object(h.useEffect)((function(){ve({keys:[],rows:[]})}),[pe]);var ye=function(e){U(e),A(!0)},we=function(){p(),_e()},Ee=null==pe?void 0:pe.list.every((function(e){return e.status===D.f.Pass})),ke=[{title:Object(R.g)("检查项"),className:B("first-cell"),render:function(e,t){var n,r=t.level,a=t.checklist_name,c=t.checklist_status;return n=t.whitelist_status||c!==D.f.NoPass?O.a.createElement(P.a,{risk:r,style:{color:Object(z.n)(r)},__source:{fileName:H,lineNumber:151,columnNumber:13}}):O.a.createElement(x.a,{riskLevel:r,__source:{fileName:H,lineNumber:154,columnNumber:24}}),O.a.createElement("div",{className:B("check-name"),__source:{fileName:H,lineNumber:158,columnNumber:11}},n,O.a.createElement("div",{className:B("ellipsis-item"),__source:{fileName:H,lineNumber:160,columnNumber:13}},a))}},{title:Object(R.g)("检查结果"),headerCellStyle:{whiteSpace:"nowrap"},bodyCellStyle:{whiteSpace:"nowrap"},width:R.d?160:128,render:function(e,t){var n=t.checklist_status,r=t.failed_detail,a=t.whitelist_status,c=t.whitelist_detail;return n===D.f.Fail?O.a.createElement("div",{className:B("check-result"),__source:{fileName:H,lineNumber:174,columnNumber:13}},Object(z.m)(n),O.a.createElement(b.a,{content:r,__source:{fileName:H,lineNumber:176,columnNumber:15}},O.a.createElement("span",{className:B("tip"),__source:{fileName:H,lineNumber:177,columnNumber:17}},Object(R.g)("说明")))):a?O.a.createElement("div",{className:B("check-result"),__source:{fileName:H,lineNumber:184,columnNumber:13}},O.a.createElement(E.a,{__source:{fileName:H,lineNumber:185,columnNumber:15}},O.a.createElement(L.a,{__source:{fileName:H,lineNumber:186,columnNumber:17}}),O.a.createElement("span",{__source:{fileName:H,lineNumber:187,columnNumber:17}},Object(R.g)("已加白"))),c&&O.a.createElement(b.a,{content:c,__source:{fileName:H,lineNumber:190,columnNumber:17}},O.a.createElement("span",{className:B("tip"),__source:{fileName:H,lineNumber:191,columnNumber:19}},Object(R.g)("备注")))):Object(z.m)(n)}},{title:Object(R.g)("操作"),headerCellStyle:{paddingLeft:"5px",paddingRight:"0"},width:Ee?65:160,render:function(e,t){var n=t.whitelist_status,r=t.checklist_status,c=t.checklist_id,i=!!n,l=!i&&r===D.f.NoPass;return O.a.createElement(m.a,{size:6,__source:{fileName:H,lineNumber:213,columnNumber:11}},O.a.createElement(k.a,{onClick:function(){return ue({checklistId:c,baselineId:u}),void ce(!0)},__source:{fileName:H,lineNumber:214,columnNumber:13}},Object(R.g)("详情")),l&&O.a.createElement(b.a,{disabled:a,content:Object(R.g)("当前用户无编辑权限"),__source:{fileName:H,lineNumber:225,columnNumber:15}},O.a.createElement(k.a,{disabled:!a,onClick:function(){return ye({checklistIds:[c],instanceId:o,baselineId:u})},__source:{fileName:H,lineNumber:226,columnNumber:17}},Object(R.g)("加白名单"))),i&&O.a.createElement(b.a,{disabled:a,content:Object(R.g)("当前用户无编辑权限"),__source:{fileName:H,lineNumber:241,columnNumber:15}},O.a.createElement(k.a,{disabled:!a,onClick:function(){return te({checklistIds:[c],instanceId:o,baselineId:u}),void Q(!0)},__source:{fileName:H,lineNumber:242,columnNumber:17}},Object(R.g)("取消加白"))))}}];return O.a.createElement("div",{className:B("container"),__source:{fileName:H,lineNumber:263,columnNumber:5}},O.a.createElement("div",{className:B("filter-container"),__source:{fileName:H,lineNumber:264,columnNumber:7}},O.a.createElement("div",{className:B("select-container"),__source:{fileName:H,lineNumber:265,columnNumber:9}},O.a.createElement(b.a,{content:Object(R.g)("暂无可导出数据"),trigger:"hover",disabled:!(null==Ne||null===(t=Ne.data)||void 0===t||!t.length),getPopupContainer:function(){return document.querySelector("#root")},__source:{fileName:H,lineNumber:266,columnNumber:11}},O.a.createElement(s.a,{style:{marginRight:"12px"},disabled:!(null!=Ne&&null!==(n=Ne.data)&&void 0!==n&&n.length),onClick:function(){Object(F.a)({url:"/api/v6/baseline/Download",data:{conditions:{baseline_id:u,agent_id:o,checklist_name:be.checklist_name}},notifyId:"baseline-export"})},__source:{fileName:H,lineNumber:272,columnNumber:13}},Object(R.g)("全部导出"))),O.a.createElement(b.a,{content:Object(R.g)("请先在下方选择内容，再批量加白名单"),disabled:je,getPopupContainer:function(){return document.querySelector("#root")},__source:{fileName:H,lineNumber:292,columnNumber:11}},O.a.createElement(s.a,{onClick:function(){ye({checklistIds:Oe.keys,instanceId:o,baselineId:u})},disabled:!je,__source:{fileName:H,lineNumber:297,columnNumber:13}},Object(R.g)("批量加白名单")))),O.a.createElement("div",{__source:{fileName:H,lineNumber:302,columnNumber:9}},O.a.createElement(l.a.Search,{style:{width:270,marginRight:12},value:be.checklist_name,maxLength:255,allowClear:!0,placeholder:Object(R.g)("请搜索检查项名称"),onChange:function(e){de(J(J({},be),{},{checklist_name:e}))},__source:{fileName:H,lineNumber:303,columnNumber:11}}),O.a.createElement(w.a,{onRefresh:f()(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e();case 2:i.a.success(Object(R.g)("刷新成功"));case 3:case"end":return e.stop()}}),e)}))),__source:{fileName:H,lineNumber:313,columnNumber:11}}))),O.a.createElement(r.a,c()({columns:ke},Ne,{rowKey:"checklist_id",rowSelection:{type:"checkbox",selectedRowKeys:Oe.keys,onChange:function(e,t){ve({keys:e,rows:t})},checkboxProps:function(e){return{disabled:e.whitelist_status||e.checklist_status!==D.f.NoPass}}},__source:{fileName:H,lineNumber:321,columnNumber:7}})),M&&O.a.createElement(S.default,c()({},K,{visible:M,onVisibleChange:A,onSuccess:we,__source:{fileName:H,lineNumber:338,columnNumber:9}})),ae&&O.a.createElement(C.default,c()({},oe,{visible:ae,onVisibleChange:ce,agentId:_,__source:{fileName:H,lineNumber:346,columnNumber:9}})),Y&&O.a.createElement(I.default,c()({},ee,{visible:Y,onVisibleChange:Q,onSuccess:we,__source:{fileName:H,lineNumber:354,columnNumber:9}})))}},829:function(e,t,n){"use strict";n.r(t);n(597);var r=n(226),a=(n(200),n(85)),c=(n(197),n(117)),i=n(10),l=n.n(i),o=(n(224),n(97)),u=n(50),s=n.n(u),m=n(28),b=n.n(m),d=(n(804),n(598)),f=n(16),p=n.n(f),N=n(0),_=n.n(N),g=n(1292),h=n(115),O=n.n(h),v=n(1662),j=n(1617),y=n(12),w=n(1326),E=n.n(w),k="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/host-detail/baseline-list/baseline-detect/assets-risk-detail/add-white-modal.tsx";function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=d.a.Group,I=O.a.bind(E.a);t.default=function(e){var t,n=e.checklistIds,i=e.instanceId,l=e.baselineId,u=e.visible,m=e.onVisibleChange,d=e.onSuccess,f=n.length,h=f<=1,O=Object(g.a)(b()(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.q)({data:{baseline_id:l,checklist_id:n[0],if_whiten:!1}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{auto:!0,ready:h&&!!n[0]}),w=O.data,E=O.loading,P=Object(N.useState)({range:j.g.Part,white_desc:""}),C=s()(P,2),D=C[0],z=C[1];return _.a.createElement(r.a,{className:I("add-modal"),autoFocus:!1,visible:u,title:Object(y.g)("加白名单"),onCancel:function(){return m(!1)},onOk:b()(p.a.mark((function e(){var t,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=D.range,r=D.white_desc,a=i,t===j.g.All&&(a=""),e.next=5,Object(j.h)({data:{checklist_id_list:n,agent_id_list:[a],baseline_id:l,whitelist_detail:r||void 0,if_whiten:!0}});case 5:o.a.success(Object(y.g)("加白成功")),m(!1),d();case 8:case"end":return e.stop()}}),e)}))),__source:{fileName:k,lineNumber:61,columnNumber:5}},_.a.createElement(a.a,{loading:E,style:{width:"100%"},__source:{fileName:k,lineNumber:87,columnNumber:7}},h?_.a.createElement(_.a.Fragment,null,_.a.createElement("div",{className:I("tip"),__source:{fileName:k,lineNumber:90,columnNumber:13}},Object(y.g)("当前基线下有{placeholder1}台主机存在该风险，你可以选择批量加白：",{placeholder1:null!==(t=null==w?void 0:w.host_num)&&void 0!==t?t:0})),_.a.createElement("div",{className:I("tip"),__source:{fileName:k,lineNumber:95,columnNumber:13}},_.a.createElement(S,{options:v.a,value:D.range,onChange:function(e){return z(x(x({},D),{},{range:e}))},__source:{fileName:k,lineNumber:96,columnNumber:15}}))):_.a.createElement("div",{className:I("tip"),__source:{fileName:k,lineNumber:104,columnNumber:11}},Object(y.g)("您已选择{checklistIdNum}项检查项，是否确定加白名单？",{checklistIdNum:f})),_.a.createElement(c.a.TextArea,{style:{height:80},placeholder:Object(y.g)("填写本次操作说明备注，便于后续查看"),value:D.white_desc,onChange:function(e){return z(x(x({},D),{},{white_desc:e}))},__source:{fileName:k,lineNumber:110,columnNumber:9}})))}},830:function(e,t,n){"use strict";n.r(t);n(597);var r=n(226),a=(n(200),n(85)),c=n(10),i=n.n(c),l=(n(224),n(97)),o=n(50),u=n.n(o),s=n(28),m=n.n(s),b=(n(804),n(598)),d=n(16),f=n.n(d),p=n(0),N=n.n(p),_=n(1292),g=n(115),h=n.n(g),O=n(1662),v=n(1617),j=n(12),y=n(1326),w=n.n(y),E="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/host-detail/baseline-list/baseline-detect/assets-risk-detail/cancel-white-modal.tsx";function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=b.a.Group,S=h.a.bind(w.a);t.default=function(e){var t,n=e.checklistIds,c=e.instanceId,i=e.baselineId,o=e.visible,s=e.onVisibleChange,b=e.onSuccess,d=Object(_.a)(m()(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.q)({data:{baseline_id:i,checklist_id:n[0],if_whiten:!0}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{auto:!0,ready:!!n[0]}),g=d.data,h=d.loading,y=Object(p.useState)({range:v.g.All,white_desc:""}),w=u()(y,2),k=w[0],I=w[1];return N.a.createElement(r.a,{className:S("cancel-modal"),autoFocus:!1,title:Object(j.g)("取消加白"),visible:o,onCancel:function(){return s(!1)},onOk:m()(f.a.mark((function e(){var t,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=k.range,r=k.white_desc,a=c,t===v.g.All&&(a=""),e.next=5,Object(v.h)({data:{agent_id_list:[a],baseline_id:i,checklist_id_list:n,whitelist_detail:r||void 0,if_whiten:!1}});case 5:l.a.success(Object(j.g)("取消加白成功")),b(),s(!1);case 8:case"end":return e.stop()}}),e)}))),__source:{fileName:E,lineNumber:59,columnNumber:5}},N.a.createElement(a.a,{loading:h,style:{width:"100%"},__source:{fileName:E,lineNumber:85,columnNumber:7}},N.a.createElement("div",{className:S("tip"),__source:{fileName:E,lineNumber:86,columnNumber:9}},Object(j.g)("当前检查项下有{placeholder1}台主机已加白，你可以选择批量取消加白：",{placeholder1:null!==(t=null==g?void 0:g.host_num)&&void 0!==t?t:0})),N.a.createElement("div",{__source:{fileName:E,lineNumber:91,columnNumber:9}},N.a.createElement(x,{options:O.c,value:k.range,onChange:function(e){return I(P(P({},k),{},{range:e}))},__source:{fileName:E,lineNumber:92,columnNumber:11}}))))}},831:function(e,t,n){"use strict";n.r(t);n(597);var r=n(226),a=n(28),c=n.n(a),i=(n(595),n(298)),l=n(16),o=n.n(l),u=n(0),s=n.n(u),m=n(1292),b=n(115),d=n.n(b),f=n(1663),p=n(1659),N=n(1617),_=n(12),g=n(1326),h=n.n(g),O="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/host-detail/baseline-list/baseline-detect/assets-risk-detail/risk-info-modal.tsx",v=i.a.Row,j=i.a.Col,y=d.a.bind(h.a);t.default=function(e){var t=e.visible,n=e.onVisibleChange,a=e.checklistId,i=e.baselineId,l=e.agentId,u=Object(m.a)(c()(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(N.p)({data:{baseline_id:i,checklist_id:a,agent_id:l}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{ready:!!a&&!!i,auto:!0}),b=u.data,d=u.loading,g=null!=b?b:{},h=g.level,w=g.resolve,E=g.description,k=g.name;return s.a.createElement(r.a,{autoFocus:!1,className:y("info-modal"),visible:t,onCancel:function(){n(!1)},footer:null,title:Object(_.g)("检查项详情"),__source:{fileName:O,lineNumber:48,columnNumber:5}},d||!b?s.a.createElement("div",{style:{height:200},__source:{fileName:O,lineNumber:59,columnNumber:9}},s.a.createElement(f.a,{__source:{fileName:O,lineNumber:60,columnNumber:11}})):s.a.createElement(s.a.Fragment,null,s.a.createElement(v,{__source:{fileName:O,lineNumber:64,columnNumber:11}},s.a.createElement("div",{className:y("title"),__source:{fileName:O,lineNumber:65,columnNumber:13}},k)),s.a.createElement(v,{__source:{fileName:O,lineNumber:67,columnNumber:11}},s.a.createElement(j,{__source:{fileName:O,lineNumber:68,columnNumber:13}},s.a.createElement("span",{__source:{fileName:O,lineNumber:69,columnNumber:15}},Object(_.g)("等级")),s.a.createElement("span",{__source:{fileName:O,lineNumber:70,columnNumber:15}},s.a.createElement(p.a,{riskLevel:h,__source:{fileName:O,lineNumber:71,columnNumber:17}})))),s.a.createElement(v,{__source:{fileName:O,lineNumber:75,columnNumber:11}},s.a.createElement(j,{__source:{fileName:O,lineNumber:76,columnNumber:13}},s.a.createElement("span",{__source:{fileName:O,lineNumber:77,columnNumber:15}},Object(_.g)("描述")),s.a.createElement("span",{__source:{fileName:O,lineNumber:78,columnNumber:15}},E||"-"))),s.a.createElement(v,{__source:{fileName:O,lineNumber:81,columnNumber:11}},s.a.createElement(j,{__source:{fileName:O,lineNumber:82,columnNumber:13}},s.a.createElement("span",{__source:{fileName:O,lineNumber:83,columnNumber:15}},Object(_.g)("加固建议")),s.a.createElement("span",{__source:{fileName:O,lineNumber:84,columnNumber:15}},w||"-")))))}}}]);