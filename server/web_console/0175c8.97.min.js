(window.webpackJsonp=window.webpackJsonp||[]).push([[97,152,203,210,231,314,315,328,329,352],{1293:function(e,t,r){e.exports={"alarm-summary-box":"alarm-summary-box-c447b74c6f",node:"node-4dde251fa9",alarm_node:"alarm_node-1fe3dddc33","node-title":"node-title-60e95ef83e","alarm-summary-box-content":"alarm-summary-box-content-e3d56ca5b3","alarm-summary-anchor-col":"alarm-summary-anchor-col-1af7f8464c","alarm-summary-collapse":"alarm-summary-collapse-58bf59ede7","alarm-desc":"alarm-desc-34a3ce20ad","alarm-desc-name":"alarm-desc-name-8a1d6bf432",name:"name-37e8532300",status:"status-c251a3b15d","alarm-desc-grid":"alarm-desc-grid-0e989be021","alarm-rasp-stack":"alarm-rasp-stack-081b1088cf",title:"title-0f168b142b",desc:"desc-a01415e902"}},1380:function(e,t,r){e.exports={"rasp-stack-trace-drawer":"rasp-stack-trace-drawer-251b1e03a4",title:"title-e51eec4e0b",content:"content-4dc64b8e0c"}},1392:function(e,t,r){e.exports={container:"container-beacf412da",nav:"nav-890e47f55c",title:"title-227fc0ff01",desc:"desc-0b55d19384",content:"content-3967b72c07","select-type":"select-type-f37c8ce81b","scroll-list":"scroll-list-700fbb8e49","scroll-item":"scroll-item-c8c46ebf91",icon:"icon-e871b81b67",line:"line-17eb7d6494",table:"table-e6e1c05385",export:"export-eb4a741d73"}},1608:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(0),n=r.n(a),c=r(70),i=r.n(c),l="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/utils/get-display-time.tsx";function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var a=i.a.unix(e).format(t);if(r){var c=null==a?void 0:a.split(" ");return n.a.createElement(n.a.Fragment,null,null==c?void 0:c.map((function(e){return n.a.createElement("div",{key:e,__source:{fileName:l,lineNumber:12,columnNumber:13}},e)})))}return a}return"-"}},1610:function(e,t,r){"use strict";r.r(t),r.d(t,"HidsAlarmType",(function(){return a})),r.d(t,"RaspAlarmType",(function(){return n})),r.d(t,"getDisplayAlarmType",(function(){return l})),r.d(t,"getHostAlarmTypeFilter",(function(){return u})),r.d(t,"getRaspDisplayAlarmType",(function(){return o})),r.d(t,"getRaspAlarmTypeFilter",(function(){return m})),r.d(t,"HostAlarmTypeFilterList",(function(){return d})),r.d(t,"RaspAlarmTypeFilterList",(function(){return b})),r.d(t,"AlarmLevel",(function(){return s})),r.d(t,"HostAlarmDetailPrefixUrl",(function(){return p})),r.d(t,"RaspAlarmDetailPrefixUrl",(function(){return f})),r.d(t,"KubeAlarmDetailPrefixUrl",(function(){return g})),r.d(t,"HostAlarmExportPrefixUrl",(function(){return _})),r.d(t,"RaspAlarmExportPrefixUrl",(function(){return h})),r.d(t,"KubeAlarmExportPrefixUrl",(function(){return N})),r.d(t,"GetAlarmPrevAndNext",(function(){return v})),r.d(t,"GetAlarmList",(function(){return O})),r.d(t,"GetRaspAlarmList",(function(){return j})),r.d(t,"GetKubeAlarmList",(function(){return x})),r.d(t,"UpdateAlarmStatus",(function(){return y})),r.d(t,"UpdateRaspAlarmStatus",(function(){return w})),r.d(t,"UpdateKubeAlarmStatus",(function(){return E})),r.d(t,"GetAlarmStatistics",(function(){return k})),r.d(t,"GetRaspAlarmStatistics",(function(){return I})),r.d(t,"GetKubeAlarmStatistics",(function(){return P})),r.d(t,"GetAlarmSummary",(function(){return S})),r.d(t,"GetRaspAlarmSummary",(function(){return A})),r.d(t,"GetKubeAlarmSummary",(function(){return H})),r.d(t,"GetAlarmRaw",(function(){return D})),r.d(t,"GetRaspAlarmRaw",(function(){return z})),r.d(t,"GetKubeAlarmRaw",(function(){return R})),r.d(t,"GetAlarmFilterWhiteList",(function(){return L})),r.d(t,"GetRaspAlarmFilterWhiteList",(function(){return C})),r.d(t,"GetKubeAlarmFilterWhiteList",(function(){return T})),r.d(t,"QueryHostAlarmSummary",(function(){return M})),r.d(t,"QueryRaspAlarmSummary",(function(){return V})),r.d(t,"QueryKubeAlarmSummary",(function(){return F})),r.d(t,"QueryVirusAlarmSummary",(function(){return G})),r.d(t,"PostApiV6AlarmHandle",(function(){return q})),r.d(t,"PostApiV6AlarmApproach",(function(){return K}));var a,n,c=r(54),i=r(12);function l(e){switch(e){case a.bruteforce:return Object(i.g)("暴力破解");case a.privilege_escalation:return Object(i.g)("提权攻击");case a.persistent:return Object(i.g)("后门驻留");case a.evasion:return Object(i.g)("变形木马");case a.purpose:return Object(i.g)("恶意破坏");case a.static_scan:return Object(i.g)("静态检测");case a.killchain:return Object(i.g)("杀伤链");case a.initial_access:return Object(i.g)("试探入侵");case a.credential_access:return Object(i.g)("账密盗用");case a.discovery:return Object(i.g)("资产探测");case a.lateral_movement:return Object(i.g)("横向移动");case a.collection:return Object(i.g)("信息收集");case a.exfiltration:return Object(i.g)("信息外渗");case a.command_control:return Object(i.g)("隐蔽隧道");case a.execution:return Object(i.g)("代码执行");case a.custom_define:return Object(i.g)("用户自定义");default:return"-"}}function u(){var e=[];return Object.values(a).forEach((function(t){switch(t){case a.bruteforce:e.push({text:Object(i.g)("暴力破解"),value:a.bruteforce});break;case a.privilege_escalation:e.push({text:Object(i.g)("提权攻击"),value:a.privilege_escalation});break;case a.persistent:e.push({text:Object(i.g)("后门驻留"),value:a.persistent});break;case a.evasion:e.push({text:Object(i.g)("变形木马"),value:a.evasion});break;case a.purpose:e.push({text:Object(i.g)("恶意破坏"),value:a.purpose});break;case a.static_scan:e.push({text:Object(i.g)("静态检测"),value:a.static_scan});break;case a.killchain:e.push({text:Object(i.g)("杀伤链"),value:a.killchain});break;case a.initial_access:e.push({text:Object(i.g)("试探入侵"),value:a.initial_access});break;case a.credential_access:e.push({text:Object(i.g)("账密盗用"),value:a.credential_access});break;case a.discovery:e.push({text:Object(i.g)("资产探测"),value:a.discovery});break;case a.lateral_movement:e.push({text:Object(i.g)("横向移动"),value:a.lateral_movement});break;case a.collection:e.push({text:Object(i.g)("信息收集"),value:a.collection});break;case a.exfiltration:e.push({text:Object(i.g)("信息外渗"),value:a.exfiltration});break;case a.command_control:e.push({text:Object(i.g)("隐蔽隧道"),value:a.command_control});break;case a.execution:e.push({text:Object(i.g)("代码执行"),value:a.execution});break;case a.custom_define:e.push({text:Object(i.g)("用户自定义"),value:a.custom_define});break;default:e.push({text:Object(i.g)("未知"),value:"unknown"})}})),e}function o(e){switch(e){case n.execution:return Object(i.g)("代码执行");case n.file_read_write:return Object(i.g)("异常文件读写");case n.network:return Object(i.g)("异常网络");case n.dir_list:return Object(i.g)("目录遍历");case n.behavior_sequence:return Object(i.g)("异常行为序列");case n.abnormal_behaviour:return Object(i.g)("异常行为");case n.sql_inject:return Object(i.g)("SQL注入");default:return"-"}}function m(){var e=[];return Object.values(n).forEach((function(t){switch(t){case n.execution:e.push({text:Object(i.g)("代码执行"),value:n.execution});break;case n.file_read_write:e.push({text:Object(i.g)("异常文件读写"),value:n.file_read_write});break;case n.network:e.push({text:Object(i.g)("异常网络"),value:n.network});break;case n.dir_list:e.push({text:Object(i.g)("目录遍历"),value:n.dir_list});break;case n.behavior_sequence:e.push({text:Object(i.g)("异常行为序列"),value:n.behavior_sequence});break;case n.abnormal_behaviour:e.push({text:Object(i.g)("异常行为"),value:n.abnormal_behaviour});break;case n.sql_inject:e.push({text:Object(i.g)("SQL注入"),value:n.sql_inject});break;default:e.push({text:Object(i.g)("未知"),value:"unknown"})}})),e}!function(e){e.bruteforce="bruteforce",e.static_scan="static_scan",e.killchain="killchain",e.privilege_escalation="privilege_escalation",e.persistent="persistent",e.evasion="evasion",e.purpose="purpose",e.initial_access="initial_access",e.credential_access="credential_access",e.discovery="discovery",e.lateral_movement="lateral_movement",e.collection="collection",e.exfiltration="exfiltration",e.command_control="command_control",e.execution="execution",e.custom_define="custom"}(a||(a={})),function(e){e.execution="Code Execution",e.file_read_write="Abnormal File Read/Write",e.network="Abnormal Network Connect",e.dir_list="Path Traversal",e.behavior_sequence="Abnormal Behavior Sequence",e.abnormal_behaviour="Abnormal Runtime Behavior",e.sql_inject="SQL Injection"}(n||(n={}));var s,d=u(),b=m();!function(e){e.critical="critical",e.high="high",e.medium="medium",e.low="low"}(s||(s={}));var p="alarm-detail",f="rasp-alarm-detail",g="kube-alarm-detail",_="alarm",h="rasp/alarm",N="kube/alarm",v=function(e){var t=e.alarmType,r=e.data;return Object(c.b)({method:"post",url:"hids"===t?"/api/v6/alarm/prevandnext":"/api/v6/".concat(t,"/alarm/prevandnext"),data:r},Object(i.g)("获取上一条和下一条的告警信息"))},O=function(e){var t=e.data,r=e.params;return Object(c.b)({method:"post",url:"/api/v6/alarm/list",data:t,params:r},Object(i.g)("获取HIDS告警列表信息"))},j=function(e){var t=e.data,r=e.params;return Object(c.b)({method:"post",url:"/api/v6/rasp/alarm/list",data:t,params:r},Object(i.g)("获取RASP告警列表信息"))},x=function(e){var t=e.data,r=e.params;return Object(c.b)({method:"post",url:"/api/v6/kube/alarm/list",data:t,params:r},Object(i.g)("获取K8s告警列表信息"))},y=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/alarm/update",data:t},Object(i.g)("更新HIDS告警处理状态"),!0)},w=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/rasp/alarm/update",data:t},Object(i.g)("更新RASP告警处理状态"),!0)},E=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/kube/alarm/update",data:t},Object(i.g)("更新k8s告警处理状态"),!0)},k=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/alarm/statistics",params:t},Object(i.g)("获取HIDS告警统计数据"))},I=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/rasp/alarm/statistics",params:t},Object(i.g)("获取RASP告警统计数据"))},P=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/kube/alarm/statistics",params:t},Object(i.g)("获取K8S告警统计数据"))},S=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/alarm/get/".concat(t.alarm_id)},Object(i.g)("获取HIDS告警详情"))},A=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/rasp/alarm/get/".concat(t.alarm_id)},Object(i.g)("获取RASP告警摘要"))},H=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/kube/alarm/get/".concat(t.alarm_id)},Object(i.g)("获取k8s告警摘要"))},D=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/alarm/raw/".concat(t.alarm_id)},Object(i.g)("获取HIDS告警原始数据"))},z=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/rasp/alarm/raw/".concat(t.alarm_id)},Object(i.g)("获取RASP告警原始数据"))},R=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/kube/alarm/raw/".concat(t.alarm_id)},Object(i.g)("获取k8s告警原始数据"))},L=function(e){var t=e.data,r=e.params;return Object(c.b)({method:"post",url:"/api/v6/alarm/filterbywhite",data:t,params:r},Object(i.g)("获取白名单过滤的HIDS告警信息"))},C=function(e){var t=e.data,r=e.params;return Object(c.b)({method:"post",url:"/api/v6/rasp/alarm/filterbywhite",data:t,params:r},Object(i.g)("获取白名单过滤的RASP告警信息"))},T=function(e){var t=e.data,r=e.params;return Object(c.b)({method:"post",url:"/api/v6/kube/alarm/filterbywhite",data:t,params:r},Object(i.g)("获取白名单过滤的k8s告警信息"))},M=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/alarm/query/".concat(t.alarm_id)},Object(i.g)("获取HIDS告警摘要"))},V=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/rasp/alarm/query/".concat(t.alarm_id)},Object(i.g)("获取RASP告警摘要"))},F=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/kube/alarm/query/".concat(t.alarm_id)},Object(i.g)("获取K8S告警摘要"))},G=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/virus/alarm/query/".concat(t.alarm_id)},Object(i.g)("获取病毒告警摘要"))};function q(e){return Object(c.b)({url:"/api/v6/alarm/handle",data:e,method:"POST"},Object(i.g)("告警处置"))}function K(e){return Object(c.b)({url:"/api/v6/alarm/approach",data:e,method:"POST"},Object(i.g)("获取告警的处置方法列表"))}},1616:function(e,t,r){"use strict";r(803);var a=r(227),n=r(10),c=r.n(n),i=r(0),l=r.n(i),u="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/ellipsis-box/index.tsx";function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.a=function(e){var t=e.content,r=e.style,n=e.className,c=e.tooltipProps;return l.a.createElement(a.a.Paragraph,{className:n,style:m({marginBottom:0},r),ellipsis:{rows:1,showTooltip:{type:"tooltip",props:m(m({},c),{},{content:l.a.createElement("span",{style:{wordBreak:"break-all"},__source:{fileName:u,lineNumber:22,columnNumber:22}},t)})}},key:t,__source:{fileName:u,lineNumber:13,columnNumber:5}},t)}},1619:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var a,n,c=r(603),i=r.n(c),l=r(0),u=r.n(l),o=r(604),m=r(12),s="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/detecting-label/index.tsx",d=o.a.div(a||(a=i()(["\n  @keyframes spin {\n    0% {\n      transform: rotate(0deg) rotateX(180deg);\n    }\n    50% {\n      transform: rotate(180deg) rotateX(180deg);\n    }\n    100% {\n      transform: rotate(360deg) rotateX(180deg);\n    }\n  }\n\n  display: inline-flex;\n  align-items: center;\n  justify-content: flex-end;\n  animation: spin 1.5s linear infinite;\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  margin-right: 8px;\n  background: conic-gradient(\n    from 114.04deg at 50% 50%,\n    #165dff -3.75deg,\n    rgba(22, 93, 255, 0) 331.83deg,\n    #165dff 339.88deg,\n    #165dff 356.25deg,\n    rgba(22, 93, 255, 0) 691.83deg\n  );\n  &::before {\n    content: ' ';\n    height: 8px;\n    width: 8px;\n    border-radius: 50%;\n    background: #fff;\n  }\n  &::after {\n    content: ' ';\n    height: 2px;\n    width: 2px;\n    border-radius: 50%;\n    background: #165dff;\n  }\n"]))),b=o.a.div(n||(n=i()(["\n  display: inline-flex;\n  align-items: center;\n  font-size: 12px;\n  line-height: 20px;\n"])));t.b=function(e){var t=e.progress,r=e.label,a=void 0===r?Object(m.g)("检查中"):r,n=e.className,c=!!t||0===t;return u.a.createElement(b,{className:n,__source:{fileName:s,lineNumber:68,columnNumber:5}},u.a.createElement(d,{className:"arco-icon-loading",__source:{fileName:s,lineNumber:69,columnNumber:7}}),u.a.createElement("span",{__source:{fileName:s,lineNumber:70,columnNumber:7}},a),c&&u.a.createElement("span",{__source:{fileName:s,lineNumber:71,columnNumber:23}}," ",t,"%"))}},1620:function(e,t,r){"use strict";var a,n,c=r(1320),i=r(28),l=r.n(i),u=(r(809),r(607)),o=r(64),m=(r(602),r(146)),s=r(16),d=r.n(s),b=r(0),p=r.n(b),f=r(799),g=r(115),_=r.n(g),h=r(1319),N=r(594),v=r(54),O=r(1634),j=r(12),x=r(74);function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var w,E=function(e){return p.a.createElement("svg",y({width:16,height:20,fill:"none"},e),p.a.createElement("mask",{id:"export-file_svg__a",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:0,y:0,width:16,height:20},a||(a=p.a.createElement("path",{d:"M1.103 0h10.24c.146 0 .285.056.389.157l4.105 3.985c.104.101.163.24.163.384v14.393c0 .597-.494 1.081-1.103 1.081H1.103C.494 20 0 19.516 0 18.919V1.08C0 .484.494 0 1.103 0z",fill:"#fff"}))),n||(n=p.a.createElement("g",{mask:"url(#export-file_svg__a)"},p.a.createElement("path",{d:"M1.103 0h10.24c.146 0 .285.056.389.157l4.105 3.985c.104.101.163.24.163.384v14.393c0 .597-.494 1.081-1.103 1.081H1.103C.494 20 0 19.516 0 18.919V1.08C0 .484.494 0 1.103 0z",fill:"#1664FF"}),p.a.createElement("path",{fill:"#fff",d:"M4 6h8v1H4zM4 10h8v1H4zM4 14h6v1H4z"}),p.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.57 0h4.414v4.324h-3.31c-.61 0-1.104-.484-1.104-1.08V0z",fill:"#94BFFF"}))))},k=r(1635),I=r.n(k),P="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/utils/gen-sse-export/index.tsx",S=_.a.bind(I.a);!function(e){e.init="init",e.exporting="exporting",e.saving="saving",e.success="success",e.failed="failed"}(w||(w={}));t.a=function(e){var t=e.url,r=e.data,a=e.notifyId,n=void 0===a?"EXPORT_NOTIFY_ID":a,i=e.method,s=void 0===i?"POST":i,b=Object(x.a)(),g=new h.SSE("".concat(v.a).concat(t),{headers:{Token:b},method:s,payload:JSON.stringify(r)});g.addEventListener("open",(function(e){console.log("open",e)}),!1),g.addEventListener("progress",(function(e){console.log("progress",e);var t=JSON.parse(e.data)||{},r=null==t?void 0:t.data,a=r.export_total,i=r.export_count,s=r.status,b=r.file_name;if(s===w.init||s===w.exporting||s===w.saving){var _=Math.round(i/a*100);_>99&&(_=99),m.a.info({id:n,icon:p.a.createElement(o.a,{__source:{fileName:P,lineNumber:86,columnNumber:17}}),title:Object(j.g)("正在导出"),duration:9e5,content:p.a.createElement("div",{className:S("container"),__source:{fileName:P,lineNumber:90,columnNumber:13}},p.a.createElement(E,{style:{marginRight:"12px"},__source:{fileName:P,lineNumber:91,columnNumber:15}}),p.a.createElement(f.a,{showTooltip:{type:"tooltip",props:{triggerProps:{className:S("name")}}},__source:{fileName:P,lineNumber:92,columnNumber:15}},b),p.a.createElement(u.a,{percent:_,type:"circle",size:"mini",style:{width:"16px",height:"16px"},__source:{fileName:P,lineNumber:104,columnNumber:15}}))})}else s===w.success&&(m.a.success({id:n,title:Object(j.g)("导出成功"),duration:9e5,content:p.a.createElement("div",{className:S("container"),__source:{fileName:P,lineNumber:119,columnNumber:13}},p.a.createElement(E,{style:{marginRight:"12px"},__source:{fileName:P,lineNumber:120,columnNumber:15}}),p.a.createElement(f.a,{tooltip:!1,showTooltip:{type:"tooltip",props:{triggerProps:{className:S("name")}}},__source:{fileName:P,lineNumber:121,columnNumber:15}},b),p.a.createElement(N.a,{style:{marginRight:"-8px"},onClick:l()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.DownloadFile)({params:{file_name:b}});case 2:m.a.remove(n);case 3:case"end":return e.stop()}}),e)}))),icon:p.a.createElement(c.a,{__source:{fileName:P,lineNumber:144,columnNumber:23}}),__source:{fileName:P,lineNumber:134,columnNumber:15}},Object(j.g)("下载")))}),g.close())}),!1),g.addEventListener("error",(function(e){console.log("error",e),g.close()}),!1),g.stream()}},1628:function(e,t,r){"use strict";r(1314);var a=r(810),n=r(1),c=r.n(n),i=r(10),l=r.n(i),u=r(2),o=r.n(u),m=r(0),s=r.n(m),d=["onChange","pagination"];function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){l()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t.a=function(e){var t=e.onChange,r=e.pagination,n=o()(e,d);return s.a.createElement(a.a,c()({onChange:function(e,r,a,n){"filter"===n.action||"sort"===n.action?t(p(p({},e),{},{current:1}),r,a,n):t(e,r,a,n)},border:!1,pagination:(null==r?void 0:r.total)>10&&p(p({},r),{},{sizeCanChange:!0,sizeOptions:[10,20,50,100]})},n,{__source:{fileName:"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/table/index.tsx",lineNumber:6,columnNumber:5}}))}},1632:function(e,t,r){"use strict";r.d(t,"f",(function(){return a})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return s}));var a,n,c=r(54),i=r(12);!function(e){e.process="process",e.create_file="create_file",e.connects="connects",e.alert="alert",e.user="user",e.web_proxy="web_proxy",e.container="container",e.dns_query="dns_query",e.probe_hook="probe_hook",e.alert_probe_hook="alert_probe_hook",e.stack_trace_hash="stack_trace_hash",e.alert_stack_trace_hash="alert_stack_trace_hash",e.args="args",e.alert_args="alert_args",e.c2="c2",e.fold="fold"}(a||(a={})),function(e){e.normal="normal",e.active="active",e.inactive="inactive",e.hover="hover"}(n||(n={}));var l=function(e){var t=e.data;return Object(c.b)({method:"get",url:"/api/v6/trace/getTrace/".concat(t.trace_id)},Object(i.g)("获取溯源图数据"))},u=function(e){var t=e.data,r=e.params;return Object(c.b)({method:"post",url:"/api/v6/trace/getRawData",params:r,data:t},Object(i.g)("获取溯源原始数据"))},o=function(e){var t=e.data;return Object(c.b)({method:"get",url:"/api/v6/alarm/find/".concat(t.smith_key)},Object(i.g)("获取告警节点信息"),!1,!1)},m=function(e){var t=e.data;return Object(c.b)({method:"get",url:"/api/v6/rasp/alarm/find/".concat(t.smith_key)},Object(i.g)("获取告警节点信息"),!1,!1)},s=function(e){var t=e.data;return Object(c.b)({method:"get",url:"/api/v6/trace/getStackTrace/".concat(t.stack_trace_hash)},Object(i.g)("获取rasp 函数调用栈"),!1,!1)}},1634:function(e,t,r){"use strict";r.r(t),r.d(t,"DescribeHostStatistics",(function(){return c})),r.d(t,"DescribeHosts",(function(){return i})),r.d(t,"ExportHosts",(function(){return l})),r.d(t,"DownloadFile",(function(){return u})),r.d(t,"DescribeTags",(function(){return o})),r.d(t,"AddTags",(function(){return m})),r.d(t,"DeleteTags",(function(){return s})),r.d(t,"UpdateTags",(function(){return d})),r.d(t,"DescribePlatforms",(function(){return b})),r.d(t,"DescribeIDCs",(function(){return p})),r.d(t,"PostApiV6AssetCenterEnableHostImportantProtect",(function(){return f})),r.d(t,"PostApiV6AssetCenterDisableHostImportantProtect",(function(){return g}));var a=r(54),n=r(12),c=function(){return Object(a.b)({method:"get",url:"/api/v6/asset-center/DescribeHostStatistics"},Object(n.g)("获取主机统计信息"))},i=function(e){var t=e.data,r=e.params;return Object(a.b)({method:"post",url:"/api/v6/asset-center/DescribeHosts",data:t,params:r},Object(n.g)("获取主机列表信息"))},l=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/asset-center/ExportHosts",data:t},Object(n.g)("导出主机信息"))},u=function(e){var t=e.params;return Object(a.b)({method:"get",url:"/api/v6/shared/Download/".concat(t.file_name),responseType:"blob"},Object(n.g)("下载文件"),!1,!1)},o=function(){return Object(a.b)({method:"get",url:"/api/v6/asset-center/DescribeTags"},Object(n.g)("获取标签信息"))},m=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/asset-center/AddTags",data:t},Object(n.g)("添加标签"),!0)},s=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/asset-center/DeleteTags",data:t},Object(n.g)("删除标签"),!0)},d=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/asset-center/UpdateTags",data:t},Object(n.g)("修改标签"),!0)},b=function(){return Object(a.b)({method:"get",url:"/api/v6/asset-center/DescribePlatform"},Object(n.g)("获取操作系统类型"))},p=function(){return Object(a.b)({method:"get",url:"/api/v6/asset-center/DescribeIDC"},Object(n.g)("获取数据中心类型"))};function f(e){return Object(a.b)({url:"/api/v6/asset-center/EnableHostImportantProtect",data:e,method:"POST"},Object(n.g)("开启主机重保模式"))}function g(e){return Object(a.b)({url:"/api/v6/asset-center/DisableHostImportantProtect",data:e,method:"POST"},Object(n.g)("关闭主机重保模式"))}},1635:function(e,t,r){e.exports={container:"container-89c01f30b7",name:"name-b0b73f3090"}},1712:function(e,t,r){"use strict";var a,n=r(0),c=r.n(n);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}t.a=function(e){return c.a.createElement("svg",i({width:17,height:16,fill:"none"},e),a||(a=c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.719 3.728L9.353.096a.77.77 0 00-.746 0L2.241 3.728a.724.724 0 00-.372.64v7.264a.75.75 0 00.372.64l6.366 3.632a.77.77 0 00.746 0l6.366-3.632a.725.725 0 00.372-.64V4.368a.734.734 0 00-.372-.64zm-2.122 1.568L9.563 8.288v4.28c0 .312-.259.568-.575.568a.574.574 0 01-.575-.568V8.304l-4.01-2.64a.565.565 0 01-.161-.792.58.58 0 01.802-.16l3.928 2.584 3.944-2.92a.585.585 0 01.81.112c.194.248.13.616-.13.808z",fill:"#E63F3F"})))}},303:function(e,t,r){"use strict";r.r(t);r(1296);var a=r(1297),n=r(0),c=r.n(n),i=r(115),l=r.n(i),u=r(1293),o=r.n(u),m="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-list/alarm-list-comm/alarm-list-table/alarm-summary-drawer/alarm-summary-content/alarm-rasp-stack-info/index.tsx",s=l.a.bind(o.a),d=a.a.Step;t.default=function(e){for(var t=e.value.split("• "),r=[],n=0;n<t.length;n++){var i=t[n].trim();i.length>0&&r.push(i)}return c.a.createElement(a.a,{size:"small",type:"dot",current:0,direction:"vertical",__source:{fileName:m,lineNumber:27,columnNumber:5}},r.map((function(e,t){return c.a.createElement(d,{title:e.trim(),className:s("alarm-rasp-stack"),__source:{fileName:m,lineNumber:29,columnNumber:9}})})))}},386:function(e,t,r){"use strict";r.r(t);r(1294);var a=r(1295),n=r(1),c=r.n(n),i=r(28),l=r.n(i),u=r(2),o=r.n(u),m=r(16),s=r.n(m),d=r(0),b=r.n(d),p=r(1292),f=r(115),g=r.n(f),_=r(303),h=r(1632),N=r(12),v=r(1380),O=r.n(v),j="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-detail/alarm-detail-comm/alarm-detail-table/rasp-stack-trace-drawer/index.tsx",x=["stack_trace_hash"],y=g.a.bind(O.a);t.default=function(e){var t=e.stack_trace_hash,r=o()(e,x),n=Object(p.a)(l()(s.a.mark((function e(){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.d)({data:{stack_trace_hash:t}});case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))),{auto:!0,ready:!!t,refreshDeps:[t]}).data;return b.a.createElement(a.a,c()({className:y("rasp-stack-trace-drawer"),width:560,title:b.a.createElement("div",{style:{textAlign:"left"},__source:{fileName:j,lineNumber:43,columnNumber:14}},Object(N.g)("运行时调用栈")),getPopupContainer:function(){return document.getElementById("content-root")}},r,{footer:null,__source:{fileName:j,lineNumber:40,columnNumber:5}}),b.a.createElement("div",{className:y("content"),__source:{fileName:j,lineNumber:50,columnNumber:7}},b.a.createElement(_.default,{value:n||"",__source:{fileName:j,lineNumber:51,columnNumber:9}})))}},403:function(e,t,r){"use strict";r.r(t);var a,n=r(1),c=r.n(n),i=(r(1431),r(1436)),l=(r(1337),r(1338)),u=r(80),o=r(51),m=r.n(o),s=(r(200),r(85)),d=r(10),b=r.n(d),p=r(28),f=r.n(p),g=r(50),_=r.n(g),h=r(16),N=r.n(h),v=r(0),O=r.n(v),j=r(1312),x=r(1606),y=r(599),w=r(100),E=r(1292),k=r(115),I=r.n(k),P=r(163),S=r(164),A=r.n(S),H=r(52),D=r(1616),z=r(1628),R=r(594),L=r(1619),C=r(386),T=r(1610),M=r(1632),V=r(1620),F=r(1608),G=r(12),q=r(145);function K(){return(K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var U,B=function(e){return O.a.createElement("svg",K({width:16,height:16,fill:"none"},e),a||(a=O.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M.667 8a7.333 7.333 0 117.454 7.332L8 15.333A7.333 7.333 0 01.667 8zm9.318.667h-3.97c.069 1.533.372 2.933.842 3.967.236.519.499.91.754 1.147.159.148.277.208.364.218L8 14c.09 0 .215-.056.39-.219.254-.237.517-.628.753-1.147.47-1.034.774-2.434.842-3.967zm-4.173 4.866l.037.07a6.006 6.006 0 01-3.812-4.936H4.68c.08 1.938.502 3.659 1.132 4.866zm8.152-4.866H11.32c-.081 1.976-.518 3.726-1.17 4.936a6.006 6.006 0 003.813-4.936zm-3.776-6.2l-.037-.07a6.006 6.006 0 013.813 4.937H11.32c-.08-1.938-.502-3.66-1.132-4.867zm-4.338-.07l-.04.016a6.006 6.006 0 00-3.773 4.92H4.68c.081-1.975.519-3.725 1.17-4.936zm1.76-.178C7.787 2.057 7.912 2 8 2l.025.002c.087.01.205.07.364.217.255.238.518.629.754 1.147.47 1.035.774 2.435.842 3.968h-3.97c.069-1.533.372-2.933.842-3.968.236-.518.499-.91.754-1.147z",fill:"#86909C"})))};function Q(){return(Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var X,Y=function(e){return O.a.createElement("svg",Q({width:16,height:16,fill:"none"},e),U||(U=O.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.167 1.667c.368 0 .666.298.666.666V14a.667.667 0 01-.666.667H1.5A.667.667 0 01.833 14V2.333c0-.368.299-.666.667-.666h12.667zM13.5 11H2.167v2.333H13.5V11zm-1.5.667c.184 0 .333.149.333.333v.667c0 .184-.149.333-.333.333h-.667a.333.333 0 01-.333-.333V12c0-.184.15-.333.333-.333H12zM13.5 7H2.167v2.667H13.5V7zm-2.167.667H12c.17 0 .312.128.331.294l.002.039v.667c0 .17-.128.312-.294.33L12 9h-.667a.333.333 0 01-.33-.294L11 8.666V8c0-.171.129-.312.294-.331l.04-.002H12h-.667zM13.5 3H2.167v2.667H13.5V3zm-1.5.667c.17 0 .312.128.331.294l.002.039v.667c0 .17-.128.312-.294.33L12 5h-.667a.333.333 0 01-.33-.294L11 4.666V4c0-.17.129-.312.294-.331l.04-.002H12z",fill:"#86909C"})))};function J(){return(J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var W,Z,$=function(e){return O.a.createElement("svg",J({width:16,height:16,fill:"none"},e),X||(X=O.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 2.667a2 2 0 012-2h7l3 3.142v9.524a2 2 0 01-2 2H4a2 2 0 01-2-2V2.667zM10 2v2.68h2.667V14H3.333V2H10zM4.667 9.667c0-.368.298-.667.666-.667H8a.667.667 0 010 1.334H5.333a.667.667 0 01-.666-.667zm.666-3.334a.667.667 0 100 1.334h5.334a.667.667 0 000-1.334H5.333z",fill:"#86909C"})))};function ee(){return(ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var te,re=function(e){return O.a.createElement("svg",ee({width:16,height:16,fill:"none"},e),W||(W=O.a.createElement("g",{clipPath:"url(#data-type-other-icon_svg__clip0_11526_353455)"},O.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.334 8A7.333 7.333 0 10.667 8a7.333 7.333 0 0014.667 0zM2 8a6 6 0 1112 0A6 6 0 012 8zm6-.67a.67.67 0 100 1.34.67.67 0 000-1.34zm2.242.67a.67.67 0 111.34 0 .67.67 0 01-1.34 0zm-5.154-.67a.67.67 0 100 1.34.67.67 0 000-1.34z",fill:"#4E5969"}))),Z||(Z=O.a.createElement("defs",null,O.a.createElement("clipPath",{id:"data-type-other-icon_svg__clip0_11526_353455"},O.a.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))))};function ae(){return(ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ne,ce,ie=function(e){return O.a.createElement("svg",ae({width:16,height:16,fill:"none"},e),te||(te=O.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.312 3.65L8.307.802a.667.667 0 00-.571 0L1.74 3.65a.667.667 0 00-.38.603v7.487c0 .257.148.492.38.602l5.995 2.855a.667.667 0 00.573 0l6.005-2.855a.667.667 0 00.38-.602V4.253a.667.667 0 00-.38-.603zM2.693 11.32V5.63L7.31 7.95l.012.006.085 5.609-4.714-2.245zM13.36 5.63L8.7 7.95l-.045.021.084 5.544 4.62-2.196V5.63zM3.24 4.414l4.782-2.271 4.789 2.27-4.704 2.344a.222.222 0 01-.2 0L3.24 4.414z",fill:"#86909C"})))};function le(){return(le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var ue=function(e){return O.a.createElement("svg",le({width:16,height:16,fill:"none"},e),ne||(ne=O.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.667 2A.667.667 0 0014 1.333H2A.667.667 0 001.333 2v12c0 .368.299.667.667.667h12a.667.667 0 00.667-.667V2zm-12 .666h10.666v10.667H2.667V2.666z",fill:"#86909C"})),ce||(ce=O.a.createElement("path",{d:"M4.984 3.563a.333.333 0 00-.468 0l-.275.27a.333.333 0 000 .476l1.266 1.245L4.35 6.69a.333.333 0 000 .475l.275.27c.13.128.338.128.468 0l1.828-1.8a.126.126 0 00-.006-.172l-1.932-1.9zM8 6.333C8 6.15 8.15 6 8.333 6h3.334c.184 0 .333.15.333.333V7c0 .184-.15.333-.333.333H8.333A.333.333 0 018 7v-.667zM5.793 9.963a.33.33 0 00-.127-.243.499.499 0 00-.317-.088.63.63 0 00-.227.036.296.296 0 00-.136.098.237.237 0 00-.047.14.209.209 0 00.025.115.29.29 0 00.086.088.652.652 0 00.136.066c.053.019.113.035.18.05l.25.056c.143.031.27.073.38.125.11.052.203.114.278.186a.72.72 0 01.172.249.835.835 0 01.06.315.814.814 0 01-.14.473.865.865 0 01-.396.303 1.64 1.64 0 01-.62.105c-.244 0-.456-.037-.637-.11a.9.9 0 01-.422-.332 1.01 1.01 0 01-.155-.564h.674c.005.094.03.172.075.234.044.063.106.11.183.143.079.032.17.048.273.048a.672.672 0 00.241-.038.351.351 0 00.155-.107.252.252 0 00.056-.156.215.215 0 00-.052-.14.387.387 0 00-.153-.103 1.579 1.579 0 00-.261-.081l-.304-.071a1.325 1.325 0 01-.595-.28.666.666 0 01-.216-.526.78.78 0 01.145-.473.963.963 0 01.404-.316c.173-.076.37-.114.59-.114.225 0 .42.038.586.115a.902.902 0 01.388.32.855.855 0 01.14.477h-.672zM8.433 9.963a.33.33 0 00-.126-.243.499.499 0 00-.317-.088.63.63 0 00-.227.036.296.296 0 00-.137.098.237.237 0 00-.046.14.209.209 0 00.025.115.29.29 0 00.085.088.652.652 0 00.137.066c.053.019.112.035.179.05l.25.056c.144.031.27.073.38.125.111.052.204.114.279.186a.72.72 0 01.172.249.836.836 0 01.06.315.813.813 0 01-.14.473.865.865 0 01-.396.303 1.64 1.64 0 01-.621.105c-.243 0-.455-.037-.636-.11a.9.9 0 01-.422-.332 1.01 1.01 0 01-.155-.564h.673c.006.094.031.172.076.234.044.063.105.11.183.143.078.032.17.048.273.048a.672.672 0 00.241-.038.351.351 0 00.155-.107.252.252 0 00.055-.156.215.215 0 00-.05-.14.387.387 0 00-.154-.103 1.579 1.579 0 00-.262-.081l-.304-.071a1.326 1.326 0 01-.595-.28.666.666 0 01-.216-.526.78.78 0 01.145-.473.963.963 0 01.405-.316c.172-.076.369-.114.59-.114.225 0 .42.038.586.115a.903.903 0 01.388.32.855.855 0 01.14.477h-.673zM9.501 9.09V12h.704v-1.17h1.146V12h.701V9.09h-.701v1.168h-1.147V9.091h-.703z",fill:"#86909C"})))},oe=r(1712),me=r(1392),se=r.n(me),de="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-detail/alarm-detail-comm/alarm-detail-table/index.tsx";function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){b()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fe=I.a.bind(se.a),ge=[{label:Object(G.g)("全部"),value:"-1"},{label:Object(G.g)("进程"),value:"59"},{label:Object(G.g)("文件创建"),value:"602"},{label:Object(G.g)("DNS解析"),value:"601"},{label:Object(G.g)("网络连接"),value:"42"},{label:Object(G.g)("SSH登录"),value:"4000"}],_e=[{label:Object(G.g)("全部"),value:"-1"},{label:Object(G.g)("进程"),value:"process"},{label:Object(G.g)("网络"),value:"network"},{label:Object(G.g)("文件"),value:"file"},{label:Object(G.g)("其他"),value:"other"}],he={59:O.a.createElement(ie,{__source:{fileName:de,lineNumber:63,columnNumber:9}}),process:O.a.createElement(ie,{__source:{fileName:de,lineNumber:64,columnNumber:12}}),42:O.a.createElement(B,{__source:{fileName:de,lineNumber:65,columnNumber:9}}),network:O.a.createElement(B,{__source:{fileName:de,lineNumber:66,columnNumber:12}}),601:O.a.createElement(Y,{__source:{fileName:de,lineNumber:67,columnNumber:10}}),602:O.a.createElement($,{__source:{fileName:de,lineNumber:68,columnNumber:10}}),file:O.a.createElement($,{__source:{fileName:de,lineNumber:69,columnNumber:9}}),4e3:O.a.createElement(ue,{__source:{fileName:de,lineNumber:70,columnNumber:11}}),other:O.a.createElement(re,{__source:{fileName:de,lineNumber:71,columnNumber:10}})};t.default=function(){var e,t,r,a=null===(e=A.a.parse(location.search))||void 0===e?void 0:e.trace_id,n=null===(t=A.a.parse(location.search))||void 0===t?void 0:t.alarm_type,o=null===(r=A.a.parse(location.search))||void 0===r?void 0:r.data_type,d=Object(H.f)(q.g),p=Object(H.f)(q.f),g=d&&p?"".concat(a,"_RASP"):a,h=Object(H.e)(q.e),k=_()(h,2),I=k[0],S=k[1],K=Object(H.f)(q.d),U=Object(H.f)(q.h),B=d&&p?_e:ge,Q=Object(v.useState)(B[0].value),X=_()(Q,2),Y=X[0],J=X[1],W=Object(H.e)(q.n),Z=_()(W,2),$=Z[0],ee=Z[1],te=Y===B[0].value,re=te&&!$.id,ae=Object(v.useRef)(!1);Object(w.a)((function(){var e,t;if(ae.current)ae.current=!1;else{var r=d&&p?null==$||null===(e=$.node_info)||void 0===e?void 0:e.rasp_data_type:null==$||null===(t=$.node_info)||void 0===t?void 0:t.data_type;B.find((function(e){return e.value===r}))?J(r):J(B[0].value)}}),[$,d,p]);var ne=Object(y.a)(function(){var e=f()(N.a.mark((function e(t){var r,a,n,c,i,l,u,o;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.current,n=t.pageSize,c=null!=$&&$.id?d&&p?{origin_data_id:[null==$?void 0:$.origin_data_id]}:{data_id:[null==$?void 0:$.id]}:b()({trace_id:g},d&&p?"rasp_data_type":"data_type",te?void 0:[Y]),i=null!=$&&$.id?{page:1,page_size:100}:{page:a,page_size:n},e.next=5,Object(M.b)({data:c,params:i});case 5:return l=e.sent,u=l.data,o=l.page_info,e.abrupt("return",{list:null!=u?u:[],total:null!==(r=null==o?void 0:o.total)&&void 0!==r?r:0});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{auto:!0,ready:!!g||!(null==$||!$.id)&&!K,refreshDeps:[K,g,null==$?void 0:$.id,d,p],resetDeps:[Y]}),ce=ne.tableProps,ie=ne.loading,le=function(e,t){return O.a.createElement("div",{style:pe({color:"#4E5969"},t||{}),dangerouslySetInnerHTML:{__html:window.filterXSS(e||"-",{whiteList:{span:["style"]}})},__source:{fileName:de,lineNumber:167,columnNumber:7}})},ue=Object(v.useState)(),me=_()(ue,2),se=me[0],be=me[1],Ne=Object(v.useState)(!1),ve=_()(Ne,2),Oe=ve[0],je=ve[1],xe=[{title:Object(G.g)("源IP"),dataIndex:"sip",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:191,columnNumber:39}}):"-"}},{title:Object(G.g)("登录用户"),dataIndex:"user",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:197,columnNumber:39}}):"-"}},{title:Object(G.g)("登录方式"),dataIndex:"types",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:203,columnNumber:39}}):"-"}},{title:Object(G.g)("登录状态"),dataIndex:"status",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:210,columnNumber:39}}):"-"}},{title:Object(G.g)("主机名"),dataIndex:"hostname",width:"150px",fixed:"right",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:217,columnNumber:39}}):"-"}}],ye=[{title:Object(G.g)("静态文件"),dataIndex:"static_file",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:225,columnNumber:39}}):"-"}},{title:Object(G.g)("静态检测类型"),dataIndex:"types",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:231,columnNumber:39}}):"-"}},{title:Object(G.g)("文件创建时间"),dataIndex:"create_at",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:237,columnNumber:39}}):"-"}},{title:Object(G.g)("文件修改时间"),dataIndex:"modify_at",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:243,columnNumber:39}}):"-"}},{title:Object(G.g)("文件指纹"),dataIndex:"exe_hash",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:249,columnNumber:39}}):"-"}},{title:Object(G.g)("检测时间"),dataIndex:"timestamp",width:"150px",fixed:"right",render:function(e){return e?O.a.createElement(D.a,{content:Object(F.a)(e),__source:{fileName:de,lineNumber:257,columnNumber:15}}):"-"}}],we=[{title:Object(G.g)("内核模块名"),dataIndex:"module_name",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:265,columnNumber:39}}):"-"}},{title:Object(G.g)("系统调用ID"),dataIndex:"syscall_number",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:271,columnNumber:39}}):"-"}},{title:Object(G.g)("中断ID"),dataIndex:"interrupt_number",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:277,columnNumber:39}}):"-"}}],Ee=[{title:Object(G.g)("检测时间"),dataIndex:"timestamp",width:"170px",render:function(e){return e?O.a.createElement(D.a,{content:Object(F.a)(e),__source:{fileName:de,lineNumber:286,columnNumber:15}}):"-"}},{title:Object(G.g)("数据描述"),dataIndex:"desc",width:"300px",render:function(e){return e?le(e):"-"}},{title:Object(G.g)("数据类型"),dataIndex:"data_type",width:"60px",render:function(e){return he[e]}},{title:Object(G.g)("目的IP端口"),dataIndex:"dipdport",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:304,columnNumber:39}}):"-"}},{title:Object(G.g)("SSH"),dataIndex:"ssh",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:310,columnNumber:39}}):"-"}},{title:Object(G.g)("进程树信息"),dataIndex:"pid_tree",width:"300px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:316,columnNumber:39}}):"-"}},{title:Object(G.g)("父进程命令行"),dataIndex:"ppid_argv",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:322,columnNumber:39}}):"-"}},{title:Object(G.g)("源IP"),dataIndex:"sip",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:328,columnNumber:39}}):"-"}},{title:Object(G.g)("源端口"),dataIndex:"sport",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:334,columnNumber:39}}):"-"}},{title:Object(G.g)("外联进程命令行"),dataIndex:"socket_argv",width:"170px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:340,columnNumber:39}}):"-"}}],ke=[{title:Object(G.g)("检测时间"),dataIndex:"timestamp",width:"170px",render:function(e){return e?O.a.createElement(D.a,{content:Object(F.a)(e),__source:{fileName:de,lineNumber:349,columnNumber:15}}):"-"}},{title:Object(G.g)("数据描述"),dataIndex:"desc",width:"300px",render:function(e){return e?le(e):"-"}},{title:Object(G.g)("数据类型"),dataIndex:"data_type",width:"60px",render:function(e){return he[e]}},{title:Object(G.g)("进程树信息"),dataIndex:"pid_tree",width:"300px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:367,columnNumber:39}}):"-"}},{title:Object(G.g)("父进程ID"),dataIndex:"ppid",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:373,columnNumber:39}}):"-"},headerCellStyle:{paddingLeft:8}},{title:Object(G.g)("源IP"),dataIndex:"sip",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:380,columnNumber:39}}):"-"}},{title:Object(G.g)("源端口"),dataIndex:"sport",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:386,columnNumber:39}}):"-"}}],Ie=[{title:Object(G.g)("检测时间"),dataIndex:"timestamp",width:"170px",render:function(e){return e?O.a.createElement(D.a,{content:Object(F.a)(e),__source:{fileName:de,lineNumber:395,columnNumber:15}}):"-"}},{title:Object(G.g)("数据描述"),dataIndex:"desc",width:"300px",render:function(e){return e?le(e):"-"}},{title:Object(G.g)("数据类型"),dataIndex:"data_type",width:"60px",render:function(e){return he[e]}},{title:Object(G.g)("父进程ID"),dataIndex:"ppid",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:413,columnNumber:39}}):"-"},headerCellStyle:{paddingLeft:8}},{title:Object(G.g)("进程树信息"),dataIndex:"pid_tree",width:"300px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:420,columnNumber:39}}):"-"}},{title:Object(G.g)("目的IP端口"),dataIndex:"dipdport",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:426,columnNumber:39}}):"-"}}],Pe=[{title:Object(G.g)("检测时间"),dataIndex:"timestamp",width:"170px",render:function(e){return e?O.a.createElement(D.a,{content:Object(F.a)(e),__source:{fileName:de,lineNumber:435,columnNumber:15}}):"-"}},{title:Object(G.g)("数据描述"),dataIndex:"desc",width:"300px",render:function(e){return e?le(e):"-"}},{title:Object(G.g)("数据类型"),dataIndex:"data_type",width:"60px",render:function(e){return he[e]}},{title:Object(G.g)("父进程ID"),dataIndex:"ppid",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:453,columnNumber:39}}):"-"},headerCellStyle:{paddingLeft:8}},{title:Object(G.g)("进程树信息"),dataIndex:"pid_tree",width:"300px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:460,columnNumber:39}}):"-"}}],Se=[{title:Object(G.g)("检测时间"),dataIndex:"timestamp",width:"170px",render:function(e){return e?O.a.createElement(D.a,{content:Object(F.a)(e),__source:{fileName:de,lineNumber:469,columnNumber:15}}):"-"}},{title:Object(G.g)("数据描述"),dataIndex:"desc",width:"300px",render:function(e){return e?le(e):"-"}},{title:Object(G.g)("数据类型"),dataIndex:"data_type",width:"60px",render:function(e){return he[e]}},{title:Object(G.g)("是否为非法用户名"),dataIndex:"invalid",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:487,columnNumber:39}}):"-"}}],Ae=[{title:Object(G.g)("检测时间"),dataIndex:"timestamp",width:"170px",render:function(e){return e?O.a.createElement(D.a,{content:Object(F.a)(e),__source:{fileName:de,lineNumber:496,columnNumber:15}}):"-"}},{title:Object(G.g)("数据描述"),dataIndex:"desc",width:"300px",render:function(e){return e?le(e):"-"}},{title:Object(G.g)("数据类型"),dataIndex:"rasp_data_type",width:"60px",render:function(e){return he[e]}},{title:Object(G.g)("函数名"),dataIndex:"probe_hook",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:514,columnNumber:39}}):"-"}},{title:Object(G.g)("栈哈希"),dataIndex:"stack_trace_hash",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:520,columnNumber:39}}):"-"}},{title:Object(G.g)("运行时调用栈"),dataIndex:"stack_trace",width:"150px",render:function(e,t){return t.stack_trace_hash?O.a.createElement(R.a,{type:"text",onClick:function(){be(t.stack_trace_hash),je(!0)},__source:{fileName:de,lineNumber:528,columnNumber:11}},Object(G.g)("详情")):"-"},headerCellStyle:{paddingLeft:8}},{title:Object(G.g)("参数"),dataIndex:"args",width:"200px",headerCellStyle:{paddingLeft:8}}],He=[{title:Object(G.g)("检测时间"),dataIndex:"timestamp",width:"170px",render:function(e){return e?O.a.createElement(D.a,{content:Object(F.a)(e),__source:{fileName:de,lineNumber:556,columnNumber:15}}):"-"}},{title:Object(G.g)("数据描述"),dataIndex:"desc",width:"300px",render:function(e){return e?le(e):"-"}},{title:Object(G.g)("进程命令行"),dataIndex:"argv",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:568,columnNumber:39}}):"-"}},{title:Object(G.g)("进程二进制文件"),dataIndex:"exe",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:574,columnNumber:39}}):"-"}},{title:Object(G.g)("进程ID"),dataIndex:"pid",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:580,columnNumber:39}}):"-"},headerCellStyle:{paddingLeft:8}},{title:Object(G.g)("父进程ID"),dataIndex:"ppid",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:587,columnNumber:39}}):"-"},headerCellStyle:{paddingLeft:8}},{title:Object(G.g)("父进程命令行"),dataIndex:"ppid_argv",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:594,columnNumber:39}}):"-"}},{title:Object(G.g)("目的IP端口"),dataIndex:"dipdport",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:600,columnNumber:39}}):"-"}},{title:Object(G.g)("进程树信息"),dataIndex:"pid_tree",width:"300px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:606,columnNumber:39}}):"-"}},{title:Object(G.g)("文件路径"),dataIndex:"file_path",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:612,columnNumber:39}}):"-"}},{title:Object(G.g)("用户ID"),dataIndex:"uid",width:"150px",render:function(e){return e?O.a.createElement(D.a,{content:e,__source:{fileName:de,lineNumber:618,columnNumber:39}}):"-"}}],De=Object(v.useMemo)((function(){return d&&p?Ae:n===T.HidsAlarmType.bruteforce?xe:n===T.HidsAlarmType.static_scan?ye:"700"===o||"701"===o||"702"===o||"703"===o?we:"59"===Y?Ee:"42"===Y?ke:"601"===Y?Ie:"602"===Y?Pe:"4000"===Y?Se:He}),[n,o,Y,d,p]),ze=Object(v.useState)([]),Re=_()(ze,2),Le=Re[0],Ce=Re[1],Te=Object(v.useState)(O.a.createElement(s.a,{loading:!0,__source:{fileName:de,lineNumber:661,columnNumber:59}})),Me=_()(Te,2),Ve=Me[0],Fe=Me[1],Ge=Object(E.a)(f()(N.a.mark((function e(){var t,r,a,n,c=arguments;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:1,e.next=3,Object(M.b)({data:{trace_id:g},params:{page:t,page_size:10}});case 3:r=e.sent,a=r.data,n=void 0===a?[]:a,1===t?Ce(n):n.length?Ce([].concat(m()(Le),m()(n))):Fe("No more data");case 7:case"end":return e.stop()}}),e)}))),{auto:!0,refreshDeps:[g,d,p]}).run;return O.a.createElement("div",{className:fe("container"),__source:{fileName:de,lineNumber:690,columnNumber:5}},O.a.createElement("div",{className:fe("nav"),onClick:function(){S((function(e){return!e}))},__source:{fileName:de,lineNumber:691,columnNumber:7}},O.a.createElement("div",{__source:{fileName:de,lineNumber:697,columnNumber:9}},O.a.createElement("span",{className:fe("icon"),__source:{fileName:de,lineNumber:698,columnNumber:11}},I?O.a.createElement(u.a,{__source:{fileName:de,lineNumber:700,columnNumber:15}}):O.a.createElement("div",{style:{display:"inline-flex",alignItems:"center",transform:"rotate(90deg)"},__source:{fileName:de,lineNumber:702,columnNumber:15}},O.a.createElement(u.a,{__source:{fileName:de,lineNumber:705,columnNumber:17}}))),O.a.createElement("span",{className:fe("title"),__source:{fileName:de,lineNumber:709,columnNumber:11}},Object(G.g)("溯源数据")),!U&&O.a.createElement("span",{className:fe("desc"),__source:{fileName:de,lineNumber:711,columnNumber:13}},Object(G.g)("攻击图谱数据不完整，请下载原始数据进行分析"))),!I&&O.a.createElement("span",{style:Le.length?{cursor:"pointer"}:{cursor:"not-allowed ",opacity:"0.6"},onClick:function(){var e=f()(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),Le.length){e.next=3;break}return e.abrupt("return");case 3:Object(V.a)({url:"/api/v6/trace/download/".concat(g),notifyId:"alarm-export",method:"GET"}),t.stopPropagation();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),className:fe("export"),__source:{fileName:de,lineNumber:718,columnNumber:11}},O.a.createElement(j.b,{__source:{fileName:de,lineNumber:743,columnNumber:13}}))),O.a.createElement(l.a,{style:{margin:0},__source:{fileName:de,lineNumber:748,columnNumber:7}}),!I&&O.a.createElement("div",{className:fe("content"),__source:{fileName:de,lineNumber:751,columnNumber:9}},O.a.createElement("div",{className:fe("select-type"),__source:{fileName:de,lineNumber:752,columnNumber:11}},O.a.createElement(x.a,{style:{width:90},list:B,value:Y,rightContentRender:function(){return""},onChange:function(e){J(e.value),Object(P.isEmpty)($)||(ee({}),ae.current=!0)},__source:{fileName:de,lineNumber:753,columnNumber:13}})),O.a.createElement(l.a,{type:"vertical",style:{height:"100%",margin:0},__source:{fileName:de,lineNumber:770,columnNumber:11}}),O.a.createElement("div",{className:fe("scroll-list"),style:{display:re?"block":"none"},__source:{fileName:de,lineNumber:772,columnNumber:11}},O.a.createElement(i.a,{style:{maxHeight:"292px"},offsetBottom:3,scrollLoading:Le.length<10?null:Ve,onReachBottom:function(e){Ge(e)},dataSource:Le,bordered:!1,hoverable:!1,split:!1,render:function(e,t){return O.a.createElement(i.a.Item,{key:t,__source:{fileName:de,lineNumber:786,columnNumber:19}},O.a.createElement("div",{className:fe("scroll-item"),__source:{fileName:de,lineNumber:787,columnNumber:21}},O.a.createElement("div",{style:{width:"90px"},__source:{fileName:de,lineNumber:788,columnNumber:23}},Object(F.a)(e.timestamp,"MM-DD HH:mm:ss")),O.a.createElement("div",{className:fe("icon"),__source:{fileName:de,lineNumber:791,columnNumber:23}},e.alarm_id?O.a.createElement(oe.a,{__source:{fileName:de,lineNumber:793,columnNumber:27}}):he[(d&&p?e.rasp_data_type:e.data_type)||"42"],t!==Le.length-1&&O.a.createElement("span",{className:fe("line"),__source:{fileName:de,lineNumber:801,columnNumber:61}})),le(e.desc,{wordBreak:"keep-all",whiteSpace:"nowrap",marginRight:10})))},__source:{fileName:de,lineNumber:773,columnNumber:13}})),O.a.createElement("div",{className:fe("table"),style:{display:re?"none":"block"},__source:{fileName:de,lineNumber:814,columnNumber:11}},O.a.createElement(z.a,c()({style:{height:K?"auto":"200px"},scroll:{y:"200px"},rowKey:"_id"},ce,{loading:ie,columns:De,noDataElement:K?O.a.createElement("div",{__source:{fileName:de,lineNumber:825,columnNumber:19}},O.a.createElement(L.a,{__source:{fileName:de,lineNumber:826,columnNumber:21}}),O.a.createElement("span",{__source:{fileName:de,lineNumber:827,columnNumber:21}},Object(G.g)("溯源中"))):null,__source:{fileName:de,lineNumber:815,columnNumber:13}})))),O.a.createElement(C.default,{stack_trace_hash:se,visible:Oe,onCancel:function(){je(!1)},__source:{fileName:de,lineNumber:836,columnNumber:7}}))}}}]);