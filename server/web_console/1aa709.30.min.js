(window.webpackJsonp=window.webpackJsonp||[]).push([[30,388],{1408:function(e,t,n){e.exports={container:"container-eed95b3d52","top-nav-box":"top-nav-box-710c2b6cb6","back-button":"back-button-729406b74e","host-name":"host-name-684f15c748","content-box":"content-box-5528e6b13f",content:"content-f493ad0976","bottom-footer-box":"bottom-footer-box-ddba6e369f",text:"text-229b2ea3d9",number:"number-4146bafed2"}},1626:function(e,t,n){"use strict";n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return f})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"c",(function(){return O})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return j})),n.d(t,"d",(function(){return _})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return N})),n.d(t,"g",(function(){return k})),n.d(t,"j",(function(){return h}));var r,a,u=n(10),c=n.n(u),l=n(54),i=n(12);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.scan_quick="scan_quick",e.scan_full="scan_full",e.scan_file="scan_file"}(a||(a={}));var m=(r={},c()(r,a.scan_quick,Object(i.g)("快速扫描")),c()(r,a.scan_full,Object(i.g)("全盘扫描")),c()(r,a.scan_file,Object(i.g)("端上目录/文件扫描")),r),b=[{label:m[a.scan_file],text:m[a.scan_file],value:a.scan_file},{label:m[a.scan_full],text:m[a.scan_full],value:a.scan_full},{label:m[a.scan_quick],text:m[a.scan_quick],value:a.scan_quick}],f=[{label:Object(i.g)("文件路径"),value:"static_file"},{label:Object(i.g)("文件MD5"),value:"md5_hash"}];function d(e,t){return Object(l.b)({url:"/api/v6/virus/task/hosts",params:e,data:t,method:"POST"},Object(i.g)("获取任务的主机列表"))}function p(e,t){return Object(l.b)({url:"/api/v6/virus/task/list",params:e,data:t,method:"POST"},Object(i.g)("获取任务列表"))}function O(e,t){return Object(l.b)({url:"/api/v6/virus/alarm/list",params:e,data:t,method:"POST"},Object(i.g)("获取告警列表"))}function g(e){return Object(l.b)({url:"/api/v6/virus/alarm/statistics",params:e,method:"GET"},Object(i.g)("获取告警统计数据"))}function j(e){return Object(l.b)({url:"/api/v6/virus/task/statistics",params:e,method:"GET"},Object(i.g)("获取任务统计数据"))}function _(e){var t=e.data;return Object(l.b)({url:"/api/v6/virus/alarm/update",data:t,method:"POST"},Object(i.g)("更新告警处理状态"))}function v(e){return Object(l.b)({url:"/api/v6/virus/whitelist/increase",data:e,method:"POST"},Object(i.g)("新增白名单"))}function N(e){return Object(l.b)(s(s({url:"/api/v6/virus/whitelist/listing"},e),{},{method:"POST"}),Object(i.g)("获取白名单列表"))}function k(e){var t=e.data;return Object(l.b)({url:"/api/v6/virus/whitelist/del",data:t,method:"POST"},Object(i.g)("删除白名单"))}function h(e){return Object(l.b)({url:"/api/v6/virus/whitelist/update",data:e,method:"POST"},Object(i.g)("修改病毒查杀白名单规则名字和注释"))}},1677:function(e,t,n){"use strict";var r,a=n(0),u=n.n(a);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.a=function(e){return u.a.createElement("svg",c({width:12,height:12,fill:"none"},e),r||(r=u.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.934 7.96a.5.5 0 01-.708 0l-2.18-2.18L3.93 7.899a.5.5 0 01-.707 0l-.354-.353a.5.5 0 010-.707l2.829-2.829a.5.5 0 01.707 0l.353.354a.505.505 0 01.048.055L9.287 6.9a.5.5 0 010 .707l-.353.354z",fill:"#4E5969"})))}},378:function(e,t,n){"use strict";n.r(t),n.d(t,"TaskType",(function(){return C}));n(1296);var r=n(1297),a=(n(116),n(42)),u=(n(224),n(97)),c=n(50),l=n.n(c),i=n(28),o=n.n(i),s=n(10),m=n.n(s),b=n(16),f=n.n(b),d=n(0),p=n.n(d),O=n(55),g=n(1607),j=n(794),_=n(1292),v=n(115),N=n.n(v),k=n(423),h=n(406),y=n(1696),E=n(1626),x=n(12),S=n(1677),T=n(1408),w=n.n(T),F="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/create-task/index.tsx";function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C,D=N.a.bind(w.a);!function(e){e.virus="virus",e.agent="agent"}(C||(C={}));t.default=function(){var e=Object(g.a)({task_name:void 0,action:y.TaskTypeEunm.RebootAgent,id_list:[],tags:[],idc:[],platform:[],status:[],hostname:void 0,ip:void 0,agent_id:void 0,version:void 0,isSelectedAllFromFilter:!1,current:1,pageSize:10,step:1,task_type:"agent",cpu_idle:void 0,timeout:void 0}),t=e.value,n=e.setValue,c=Object(d.useMemo)((function(){return A(A({},t),{},{isSelectedAllFromFilter:"boolean"==typeof t.isSelectedAllFromFilter&&t.isSelectedAllFromFilter||"true"===t.isSelectedAllFromFilter,step:Number(t.step)})}),[Object(j.a)(t)]),i=Object(d.useMemo)((function(){return{step:c.step,setStep:function(e){return n((function(t){return A(A({},t),{},{step:e})}))}}}),[c.step]),s=i.step,m=i.setStep,b=Object(d.useMemo)((function(){return c.isSelectedAllFromFilter?{conditions:{tags:c.tags,idc:c.idc,platform:c.platform,status:c.status,hostname:c.hostname,version:c.version,ip:c.ip,agent_id:c.agent_id}}:{id_list:c.id_list}}),[c]),v=Object(_.a)(o()(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.GetTaskHostStatus)({data:b});case 2:return t=e.sent,e.abrupt("return",null==t?void 0:t.data);case 4:case"end":return e.stop()}}),e)}))),{auto:!0,ready:1===s,refreshDeps:[b]}).data,N=Object(d.useMemo)((function(){var e;return null!=c&&c.isSelectedAllFromFilter||null!=c&&null!==(e=c.id_list)&&void 0!==e&&e.length?{allTaskHostNum:(null==v?void 0:v.all_num)||0,errorTaskHostNum:(null==v?void 0:v.error_num)||0}:{allTaskHostNum:0,errorTaskHostNum:0}}),[v,c]),T=N.allTaskHostNum,w=N.errorTaskHostNum,P=Object(O.g)(),q=Object(d.useRef)(null),R=Object(d.useRef)(null),I=Object(d.useState)(!1),H=l()(I,2),V=H[0],z=H[1],M=function(){var e=o()(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==s){e.next=15;break}return e.prev=1,e.next=4,q.current.checkIsSelectedAllFromFilter();case 4:if(T-w){e.next=7;break}return u.a.error(Object(x.g)("当前没有可正常下发任务的主机资产")),e.abrupt("return");case 7:m(2),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),u.a.error(Object(x.g)("请选择主机资产"));case 13:e.next=35;break;case 15:return e.prev=15,e.next=18,R.current.handleCheckFormValid();case 18:e.next=23;break;case 20:return e.prev=20,e.t1=e.catch(15),e.abrupt("return");case 23:if(z(!0),c.task_type!==C.agent){e.next=31;break}return t=c.action===y.TaskTypeEunm.RebootAgent?y.CreateRebootAgentTask:y.CreateSyncConfigTask,e.next=28,t({data:A({task_name:c.task_name,action:c.action},b)});case 28:P.push("/task-list"),e.next=34;break;case 31:return e.next=33,Object(y.CreateVirusTask)(A(A({task_name:c.task_name,action:c.action,file_path:c.action===E.k.scan_file?c.file_path:void 0},b),c.action===E.k.scan_full||c.action===E.k.scan_quick?{cpu_idle:String(null==c?void 0:c.cpu_idle),timeout:String(null==c?void 0:c.timeout)}:{}));case 33:P.push("/virus-alarm-list?_vao_taskListVisible=true");case 34:z(!1);case 35:case"end":return e.stop()}}),e,null,[[1,10],[15,20]])})));return function(){return e.apply(this,arguments)}}();return p.a.createElement("div",{className:D("container"),__source:{fileName:F,lineNumber:200,columnNumber:5}},p.a.createElement("div",{className:D("top-nav-box"),__source:{fileName:F,lineNumber:201,columnNumber:7}},p.a.createElement(a.a,{className:D("back-button"),onClick:function(){P.goBack()},__source:{fileName:F,lineNumber:202,columnNumber:9}},p.a.createElement(S.a,{style:{transform:"rotate(-90deg)"},__source:{fileName:F,lineNumber:208,columnNumber:11}})),p.a.createElement("span",{className:D("host-name"),__source:{fileName:F,lineNumber:210,columnNumber:9}},Object(x.g)("新建任务"))),p.a.createElement("div",{className:D("content-box"),__source:{fileName:F,lineNumber:213,columnNumber:7}},p.a.createElement(r.a,{current:s,style:{width:340,margin:"0 auto",padding:"20px 0"},__source:{fileName:F,lineNumber:214,columnNumber:9}},p.a.createElement(r.a.Step,{title:Object(x.g)("选择主机"),__source:{fileName:F,lineNumber:215,columnNumber:11}}),p.a.createElement(r.a.Step,{title:Object(x.g)("设置任务信息"),__source:{fileName:F,lineNumber:216,columnNumber:11}})),p.a.createElement("div",{className:D("content"),__source:{fileName:F,lineNumber:219,columnNumber:9}},1===s?p.a.createElement(k.default,{ref:q,visible:1===s,filter:c,setFilter:n,__source:{fileName:F,lineNumber:221,columnNumber:13}}):p.a.createElement(h.default,{ref:R,visible:2===s,filter:c,setFilter:n,__source:{fileName:F,lineNumber:228,columnNumber:13}}))),p.a.createElement("div",{className:D("bottom-footer-box"),__source:{fileName:F,lineNumber:238,columnNumber:7}},p.a.createElement("div",{className:D("text"),__source:{fileName:F,lineNumber:239,columnNumber:9}},c.isSelectedAllFromFilter||w?p.a.createElement("div",{__source:{fileName:F,lineNumber:241,columnNumber:13}},Object(x.g)("当前选择"),p.a.createElement("span",{className:D("number"),__source:{fileName:F,lineNumber:243,columnNumber:15}}," ",T," "),Object(x.g)("台主机，其中"),p.a.createElement("span",{className:D("number"),__source:{fileName:F,lineNumber:245,columnNumber:15}}," ",w," "),Object(x.g)("台主机无法正常下发任务、将被自动忽略")):null),p.a.createElement("div",{__source:{fileName:F,lineNumber:250,columnNumber:9}},p.a.createElement(a.a,{style:{marginRight:12},onClick:function(){1===s?P.goBack():m(1)},__source:{fileName:F,lineNumber:251,columnNumber:11}},1===s?Object(x.g)("取消"):Object(x.g)("上一步")),p.a.createElement(a.a,{type:"primary",onClick:M,loading:V,__source:{fileName:F,lineNumber:254,columnNumber:11}},1===s?Object(x.g)("下一步"):Object(x.g)("确定")))))}},406:function(e,t,n){"use strict";n.r(t);n(804);var r,a=n(598),u=n(28),c=n.n(u),l=n(10),i=n.n(l),o=n(50),s=n.n(o),m=(n(225),n(127)),b=(n(197),n(117)),f=n(1),d=n.n(f),p=(n(807),n(605)),O=(n(806),n(199)),g=n(603),j=n.n(g),_=n(16),v=n.n(_),N=n(0),k=n.n(N),h=n(604),y=n(838),E=n(1626),x=n(12),S=n(378),T="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/create-task/task-setting/index.tsx";function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=Object(h.a)(O.a)(r||(r=j()(["\n  padding: 20px;\n\n  .arco-form-label-item {\n    flex: unset;\n  }\n  .arco-form-item-wrapper {\n    flex: unset;\n  }\n"]))),A=function(e){switch(e){case"scan_full":return k.a.createElement(p.a,{type:"warning",style:{marginTop:16},content:Object(x.g)("全盘扫描端上资源占用较高，且时间较长，请在非业务高峰期操作。"),__source:{fileName:T,lineNumber:32,columnNumber:9}});default:return null}},C=function(e){return k.a.createElement(m.a,{__source:{fileName:T,lineNumber:44,columnNumber:3}},Object(x.g)("最大占用空闲CPU的"),k.a.createElement(b.a,d()({style:{width:55}},e,{__source:{fileName:T,lineNumber:46,columnNumber:5}})),"%")},D=function(e){return k.a.createElement(m.a,{__source:{fileName:T,lineNumber:51,columnNumber:3}},Object(x.g)("扫描时间超过"),k.a.createElement(b.a,d()({style:{width:55}},e,{__source:{fileName:T,lineNumber:53,columnNumber:5}})),Object(x.g)("小时，结束扫描"))},q=Object(N.forwardRef)((function(e,t){var n=e.visible,r=e.filter,u=e.setFilter,l="virus"===(null==r?void 0:r.task_type)?E.m:y.taskTypeOptions,i=O.a.useForm(),o=s()(i,1)[0];return Object(N.useEffect)((function(){!["scan_full","scan_quick"].includes(null==r?void 0:r.action)||null!=r&&r.cpu_idle&&null!=r&&r.timeout||u((function(e){return F(F({},e),{},{cpu_idle:e.cpu_idle||30,timeout:e.timeout||48})}))}),[r]),Object(N.useEffect)((function(){n&&o.setFieldsValue(r)}),[n,r]),Object(N.useImperativeHandle)(t,(function(){return{handleCheckFormValid:(e=c()(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.validate();case 2:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})};var e})),k.a.createElement(P,{form:o,colon:!1,labelCol:{style:{width:120}},wrapperCol:{style:{width:"calc(100% - 120px)"}},labelAlign:"right",onChange:function(e,t){if(null!=e&&e.action)return u((function(e){return F(F(F({},e),t),{},{module_id:void 0})})),void o.setFieldValue("module_id",void 0);u((function(e){return F(F({},e),t)}))},__source:{fileName:T,lineNumber:83,columnNumber:5}},k.a.createElement(O.a.Item,{field:"task_name",label:Object(x.g)("任务名称"),rules:[{required:!0,message:Object(x.g)("请输入任务名称")}],__source:{fileName:T,lineNumber:106,columnNumber:7}},k.a.createElement(b.a,{style:{width:"300px"},placeholder:Object(x.g)("请输入任务名称"),__source:{fileName:T,lineNumber:116,columnNumber:9}})),k.a.createElement(O.a.Item,{field:"action",label:Object(x.g)("任务类型"),rules:[{required:!0,message:Object(x.g)("请选择任务类型")}],extra:A(null==r?void 0:r.action),__source:{fileName:T,lineNumber:118,columnNumber:7}},k.a.createElement(a.a.Group,{type:"button",name:"lang",options:l,__source:{fileName:T,lineNumber:129,columnNumber:9}})),r.task_type===S.TaskType.virus&&k.a.createElement(O.a.Item,{shouldUpdate:!0,noStyle:!0,__source:{fileName:T,lineNumber:132,columnNumber:9}},(function(){switch(null==r?void 0:r.action){case E.k.scan_file:return k.a.createElement(O.a.Item,{field:"file_path",label:Object(x.g)("绝对路径"),rules:[{required:!0,message:Object(x.g)("请输入绝对路径")}],__source:{fileName:T,lineNumber:137,columnNumber:19}},k.a.createElement(b.a,{placeholder:Object(x.g)("请输入绝对路径"),__source:{fileName:T,lineNumber:147,columnNumber:21}}));case E.k.scan_quick:case E.k.scan_full:return k.a.createElement(k.a.Fragment,null,k.a.createElement(O.a.Item,{field:"cpu_idle",label:Object(x.g)("资源占用上限"),rules:[{required:!0,message:Object(x.g)("请输入资源占用上限")},{type:"number",min:0,max:100,message:Object(x.g)("请输入0-100的数字")}],normalize:function(e){return e>100?100:e},__source:{fileName:T,lineNumber:155,columnNumber:21}},k.a.createElement(C,{__source:{fileName:T,lineNumber:172,columnNumber:23}})),k.a.createElement(O.a.Item,{field:"timeout",label:Object(x.g)("任务超时时长"),rules:[{required:!0,message:Object(x.g)("请输入任务超时时长")},{type:"number",min:1,max:168,message:Object(x.g)("请输入1-168的数字")}],normalize:function(e){return e>168?168:e},__source:{fileName:T,lineNumber:174,columnNumber:21}},k.a.createElement(D,{__source:{fileName:T,lineNumber:191,columnNumber:23}})));default:return null}})))}));t.default=q},838:function(e,t,n){"use strict";n.r(t),n.d(t,"selectTypeInputOptions",(function(){return u})),n.d(t,"taskTypeOptions",(function(){return c})),n.d(t,"taskStatusOptions",(function(){return l})),n.d(t,"subTaskStatusOptions",(function(){return i})),n.d(t,"virusSubTaskStatusOptions",(function(){return o}));var r=n(1696),a=n(12),u=[{label:Object(a.g)("任务名称"),value:"task_name"},{label:Object(a.g)("创建人"),value:"task_user"}],c=[{label:Object(a.g)("重启客户端"),text:Object(a.g)("重启客户端"),value:r.TaskTypeEunm.RebootAgent},{label:Object(a.g)("同步配置"),text:Object(a.g)("同步配置"),value:r.TaskTypeEunm.SyncConfig}],l=[{label:Object(a.g)("未运行"),text:Object(a.g)("未运行"),value:r.TaskStatusEunm.created,color:"#C9CDD4"},{label:Object(a.g)("运行中"),text:Object(a.g)("运行中"),value:r.TaskStatusEunm.running,color:"#1664FF"},{label:Object(a.g)("运行成功"),text:Object(a.g)("运行成功"),value:r.TaskStatusEunm.finished,color:"#00AA2A"},{label:Object(a.g)("已停止"),text:Object(a.g)("已停止"),value:r.TaskStatusEunm.cancelled,color:"#E63F3F"}],i=[{label:Object(a.g)("未执行"),text:Object(a.g)("未执行"),value:r.TaskStatusEunm.created,color:"#C9CDD4"},{label:Object(a.g)("执行中"),text:Object(a.g)("执行中"),value:r.SubTaskStatusEnum.running,color:"#1664FF"},{label:Object(a.g)("执行成功"),text:Object(a.g)("执行成功"),value:r.SubTaskStatusEnum.succeed,color:"#00AA2A"},{label:Object(a.g)("执行失败"),text:Object(a.g)("执行失败"),value:r.SubTaskStatusEnum.failed,color:"#E63F3F"}],o=[{label:Object(a.g)("未运行"),text:Object(a.g)("未运行"),value:r.TaskStatusEunm.created,color:"#C9CDD4"},{label:Object(a.g)("运行中"),text:Object(a.g)("运行中"),value:r.SubTaskStatusEnum.running,color:"#1664FF"},{label:Object(a.g)("运行成功"),text:Object(a.g)("运行成功"),value:r.SubTaskStatusEnum.succeed,color:"#00AA2A"},{label:Object(a.g)("运行失败"),text:Object(a.g)("运行失败"),value:r.SubTaskStatusEnum.failed,color:"#E63F3F"}]}}]);