(window.webpackJsonp=window.webpackJsonp||[]).push([[253,225,398],{1326:function(e,t,n){e.exports={container:"container-3bc62adbed","first-cell":"first-cell-8ab2c6285d","filter-container":"filter-container-77d16a85e2","select-container":"select-container-dd09eefdea",label:"label-becbbefe86","check-name":"check-name-14da88dcc3","ellipsis-item":"ellipsis-item-7c3a675552","check-result":"check-result-15a003b45c",tip:"tip-90d505222f","add-modal":"add-modal-3cad0806d7","cancel-modal":"cancel-modal-5e56f2ab2f","info-modal":"info-modal-313828e02e"}},1615:function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(115),i=n.n(c),u=n(1623),o=n.n(u),l="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/status-display-component/index.tsx",s=i.a.bind(o.a);t.a=function(e){var t=e.color,n=e.content;return a.a.createElement("div",{className:s("container"),__source:{fileName:l,lineNumber:15,columnNumber:5}},a.a.createElement("div",{className:s("circle"),style:{background:t},__source:{fileName:l,lineNumber:16,columnNumber:7}}),a.a.createElement("div",{className:s("content"),__source:{fileName:l,lineNumber:17,columnNumber:7}},n))}},1617:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"r",(function(){return i})),n.d(t,"i",(function(){return s})),n.d(t,"d",(function(){return f})),n.d(t,"j",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"m",(function(){return m})),n.d(t,"l",(function(){return p})),n.d(t,"f",(function(){return b})),n.d(t,"o",(function(){return v})),n.d(t,"q",(function(){return h})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return O})),n.d(t,"p",(function(){return j})),n.d(t,"k",(function(){return N})),n.d(t,"n",(function(){return _}));var r,a=n(54),c=n(12);!function(e){e.detecting="running",e.finished="finished",e.error="error"}(r||(r={}));var i,u=function(e){var t=e.params;return Object(a.b)({method:"get",url:"/api/v6/baseline/GroupStatistics",params:t},Object(c.g)("获取策略组统计信息"))},o=function(){return Object(a.b)({method:"get",url:"/api/v6/baseline/GetGroupList"},Object(c.g)("获取策略组列表"))};!function(e){e.success="success",e.failure="failed"}(i||(i={}));var l,s=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/baseline/Detect",data:t},Object(c.g)("开始基线检查"),!1)},f=function(e){var t=e.params;return Object(a.b)({method:"get",url:"/api/v6/baseline/GroupCheckStatus",params:t},Object(c.g)("策略组检测状态"))},d=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/baseline/DetectProgressDetail",data:t},Object(c.g)("基线检查进度详情"))};!function(e){e.All="",e.HasRisk="risk",e.NoRisk="unrisk"}(l||(l={}));var b,m=function(e){var t=e.data,n=e.params;return Object(a.b)({method:"post",url:"/api/v6/baseline/GetBaselineList",data:t,params:n},Object(c.g)("获取基线列表"))},p=function(e){var t=e.data,n=e.params;return Object(a.b)({method:"post",url:"/api/v6/baseline/GetBaselineDetailList",data:t,params:n},Object(c.g)("基线详情列表"))};!function(e){e.Fail="error",e.NoPass="failed",e.Pass="passed"}(b||(b={}));var g,v=function(e){var t=e.data,n=e.params;return Object(a.b)({method:"post",url:"/api/v6/baseline/GetCheckResList",data:t,params:n},Object(c.g)("检查结果列表"))},h=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/baseline/GetWhiteHostNum",data:t},Object(c.g)("获取白名单弹框主机数"))};!function(e){e[e.Part=0]="Part",e[e.All=1]="All"}(g||(g={}));var O=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/baseline/ChecklistWhiten",data:t},Object(c.g)("检查项加白"))},j=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/baseline/GetChecklistDetail",data:t},Object(c.g)("获取一个检查项详情"))};function N(e,t){return Object(a.b)({url:"/api/v6/baseline/GetBaselineCheckList",params:e,data:t,method:"POST"},Object(c.g)("获取基线对应检查项列表"))}function _(e,t){return Object(a.b)({url:"/api/v6/baseline/GetCheckHostList",params:e,data:t,method:"POST"},Object(c.g)("获取检查项影响主机列表"))}},1623:function(e,t,n){e.exports={container:"container-5be80ecb83",content:"content-c7c988a72c",circle:"circle-f32e1ad32c"}},1630:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var r,a=n(54),c=n(12);!function(e){e.None="none",e.Running="running",e.Failed="failed",e.Success="success"}(r||(r={}));var i,u=function(e){var t=e.data,n=e.params;return Object(a.b)({method:"post",url:"/api/v6/investigate/file/DescribeDownloadFile",data:t,params:n},Object(c.g)("查询下载文件"))};!function(e){e.virus="virus",e.alarm="alarm"}(i||(i={}));var o=function(e){var t=e.data;return Object(a.b)({method:"post",url:"/api/v6/investigate/file/DownloadHostFile",data:t},Object(c.g)("从客户端下载文件"))},l=function(e){var t=e.params;return Object(a.b)({method:"get",url:"/api/v6/investigate/file/DescribeDownloadStatus",params:t},Object(c.g)("查询文件下载状态"))}},1657:function(e,t,n){"use strict";n.d(t,"n",(function(){return h})),n.d(t,"o",(function(){return O})),n.d(t,"b",(function(){return j})),n.d(t,"l",(function(){return N})),n.d(t,"m",(function(){return _})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return y})),n.d(t,"k",(function(){return E})),n.d(t,"d",(function(){return P})),n.d(t,"p",(function(){return k})),n.d(t,"f",(function(){return S})),n.d(t,"e",(function(){return F})),n.d(t,"i",(function(){return C})),n.d(t,"h",(function(){return D})),n.d(t,"j",(function(){return R})),n.d(t,"g",(function(){return A}));var r,a=n(0),c=n.n(a),i=n(1675),u=n(1615),o=n(1611),l=n(1617),s=n(1630),f=n(1631),d=n(12);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var m=function(e){return c.a.createElement("svg",b({width:12,height:12,fill:"none"},e),r||(r=c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 6A6 6 0 100 6a6 6 0 0012 0zM8.279 4.159l-.424-.424a.343.343 0 00-.485 0L6.005 5.098 4.642 3.735a.343.343 0 00-.485 0l-.424.424a.343.343 0 000 .485l1.363 1.364L3.733 7.37a.343.343 0 000 .485l.424.424a.343.343 0 00.485 0l1.363-1.364L7.37 8.281a.343.343 0 00.485 0l.424-.424a.343.343 0 000-.485L6.915 6.008l1.364-1.364a.343.343 0 000-.485z",fill:"#E63F3F"})))},p=n(1666),g=n(1661),v="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/utils/enum-convert.tsx";function h(e){switch(e){case o.b.low:return"#468DFF";case o.b.danger:return"#8D4EDA";case o.b.mid:return"#FBB02E";case o.b.high:return"#EB635E";case o.b.info:return"#4ACC62";default:return"#fff"}}function O(e){switch(e){case o.b.low:return Object(d.g)("低危");case o.b.danger:return Object(d.g)("严重");case o.b.mid:return Object(d.g)("中危");case o.b.high:return Object(d.g)("高危");case o.b.info:return Object(d.g)("提示");default:return"-"}}function j(e){switch(e){case l.a.All:return Object(d.g)("全部");case l.a.HasRisk:return Object(d.g)("有风险");case l.a.NoRisk:return Object(d.g)("无风险");default:return"-"}}function N(e){switch(e){case l.f.Fail:return Object(d.g)("检查失败");case l.f.NoPass:return Object(d.g)("未通过");case l.f.Pass:return Object(d.g)("已通过");default:return"-"}}function _(e){switch(e){case l.f.Fail:return c.a.createElement(i.a,{__source:{fileName:v,lineNumber:86,columnNumber:9}},c.a.createElement(p.a,{__source:{fileName:v,lineNumber:87,columnNumber:11}}),c.a.createElement("span",{__source:{fileName:v,lineNumber:88,columnNumber:11}},N(e)));case l.f.NoPass:return c.a.createElement(i.a,{__source:{fileName:v,lineNumber:93,columnNumber:9}},c.a.createElement(m,{__source:{fileName:v,lineNumber:94,columnNumber:11}}),c.a.createElement("span",{__source:{fileName:v,lineNumber:95,columnNumber:11}},N(e)));case l.f.Pass:return c.a.createElement(i.a,{__source:{fileName:v,lineNumber:100,columnNumber:9}},c.a.createElement(g.a,{__source:{fileName:v,lineNumber:101,columnNumber:11}}),c.a.createElement("span",{__source:{fileName:v,lineNumber:102,columnNumber:11}},N(e)));default:return"-"}}function w(e){switch(e){case l.g.All:return Object(d.g)("批量加白名单");case l.g.Part:return Object(d.g)("不批量，仅加白当前选择");default:return"-"}}function y(e){switch(e){case l.g.All:return Object(d.g)("批量取消加白");case l.g.Part:return Object(d.g)("不批量，仅取消当前选择");default:return"-"}}function E(e){switch(e){case f.PortType.TCP:return"TCP";case f.PortType.UDP:return"UDP";default:return"-"}}function P(e){var t={running:Object(d.g)("运行中"),exited:Object(d.g)("已退出"),unknown:Object(d.g)("未知"),created:Object(d.g)("已创建")};switch(e){case f.ContainerState.created:return t[f.ContainerState.created];case f.ContainerState.exited:return t[f.ContainerState.exited];case f.ContainerState.running:return t[f.ContainerState.running];case f.ContainerState.unknown:return t[f.ContainerState.unknown];default:return"-"}}function k(e){return e}function S(e){switch(e){case s.e.Failed:return Object(d.g)("已失败");case s.e.Running:return Object(d.g)("进行中");case s.e.Success:return Object(d.g)("已完成");case s.e.None:return Object(d.g)("未查询到");default:return"-"}}function F(e){var t=S(e);switch(e){case s.e.Failed:return c.a.createElement(u.a,{content:t,color:"#E63F3F",__source:{fileName:v,lineNumber:185,columnNumber:14}});case s.e.Running:return c.a.createElement(u.a,{content:t,color:"#1664FF",__source:{fileName:v,lineNumber:187,columnNumber:14}});case s.e.Success:return c.a.createElement(u.a,{content:t,color:"#00AA2A",__source:{fileName:v,lineNumber:189,columnNumber:14}});default:return"-"}}var C=function(e){switch(e){case f.FingerprintServiceRestartType.False:return Object(d.g)("否");case f.FingerprintServiceRestartType.True:return Object(d.g)("是");default:return"-"}},D=function(e){switch(e){case f.FingerprintServiceRestartType.False:return"#C9CDD4";case f.FingerprintServiceRestartType.True:return"#00AA2A";default:return"-"}};function R(e){return e}function A(e){return e}},1661:function(e,t,n){"use strict";var r,a,c,i=n(0),u=n.n(i);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.a=function(e){return u.a.createElement("svg",o({width:12,height:12,fill:"none"},e),r||(r=u.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 0a6 6 0 110 12A6 6 0 016 0z",fill:"#00B42A"})),a||(a=u.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.833 4.296l.287.241c.16.133.18.37.047.528L5.659 8.052a.375.375 0 01-.529.047l-.574-.482 2.749-3.275a.375.375 0 01.528-.046z",fill:"#fff"})),c||(c=u.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.594 6.278l.252-.28a.375.375 0 01.523-.033l1.764 1.518-.48.578a.375.375 0 01-.534.044L3.628 6.812a.375.375 0 01-.034-.534z",fill:"#fff"})))}},1662:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return v})),n.d(t,"d",(function(){return h})),n.d(t,"j",(function(){return O})),n.d(t,"e",(function(){return j})),n.d(t,"g",(function(){return N})),n.d(t,"i",(function(){return _})),n.d(t,"f",(function(){return w}));n(600);var r=n(198),a=n(1),c=n.n(a),i=n(0),u=n.n(i),o=n(1682),l="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/enum-select/factory.tsx";var s=n(1617),f=n(1630),d=n(1631),b=n(1657),m=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=u.a.forwardRef((function(i,s){return u.a.createElement(r.a,c()({ref:s,options:Object(o.b)(e,t,n,a)},i,{__source:{fileName:l,lineNumber:30,columnNumber:5}}))}));return i}(b.b,s.a),p=Object(o.b)(b.a,s.g,[],[s.g.All,s.g.Part]),g=Object(o.b)(b.c,s.g,[],[s.g.All,s.g.Part]),v=Object(o.a)(b.k,d.PortType),h=Object(o.a)(b.d,d.ContainerState),O=Object(o.a)(b.p,d.SoftwareType,[],[d.SoftwareType.dpkg,d.SoftwareType.pypi,d.SoftwareType.rpm,d.SoftwareType.jar]),j=Object(o.a)(b.f,f.e,[f.e.None]),N=Object(o.a)(b.j,d.FingerprintServiceTypeEnum),_=Object(o.a)(b.i,d.FingerprintServiceRestartType),w=Object(o.a)(b.g,d.FingerprintKmodTypeEnum)},1666:function(e,t,n){"use strict";var r,a=n(0),c=n.n(a);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.a=function(e){return c.a.createElement("svg",i({width:12,height:12,fill:"none"},e),r||(r=c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 6A6 6 0 110 6a6 6 0 0112 0zM6.765 7.95a.333.333 0 00-.333-.333h-.867a.333.333 0 00-.333.333v.867c0 .184.149.333.333.333h.867c.184 0 .333-.15.333-.333V7.95zm0-4.896a.333.333 0 00-.333-.333h-.867a.333.333 0 00-.333.333v3.507c0 .184.149.334.333.334h.867c.184 0 .333-.15.333-.334V3.054z",fill:"#86909C"})))}},1675:function(e,t,n){"use strict";var r,a=n(603),c=n.n(a),i=n(604).a.div(r||(r=c()(["\n  display: inline-flex;\n  align-items: center;\n  svg {\n    margin-right: 8px;\n  }\n"])));t.a=i},1682:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return d}));var r=n(10),a=n.n(r),c=n(50),i=n.n(c);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],c=Object.entries(e).filter((function(e){var t=i()(e,1)[0];return Number.isNaN(Number(t))})).map((function(e){var t=i()(e,2);t[0];return t[1]}));if(a.length>0){var u=c.reduce((function(e,t,n){var r=o({},e);return r[t]=n,r}),{});n=a.map((function(e){return c[u[e]]}))}else n=c;return n.filter((function(e){return-1===r.findIndex((function(t){return t===e}))})).map(t)}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=function(t){return{label:e(t),value:t}};return l(t,a,n,r)}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=function(t){return{text:e(t),value:t}};return l(t,a,n,r)}function d(e,t,n){var r,a,c;return n?n[t]:null!==(r=null===(a=function(e){return Object.entries(e).filter((function(e){var t=i()(e,1)[0];return Number.isNaN(Number(t))}))}(e).filter((function(e){var n=i()(e,2);n[0];return n[1]!==t})))||void 0===a||null===(c=a[0])||void 0===c?void 0:c[1])&&void 0!==r?r:t}},829:function(e,t,n){"use strict";n.r(t);n(597);var r=n(226),a=(n(200),n(85)),c=(n(197),n(117)),i=n(10),u=n.n(i),o=(n(224),n(97)),l=n(50),s=n.n(l),f=n(28),d=n.n(f),b=(n(804),n(598)),m=n(16),p=n.n(m),g=n(0),v=n.n(g),h=n(1292),O=n(115),j=n.n(O),N=n(1662),_=n(1617),w=n(12),y=n(1326),E=n.n(y),P="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/host-detail/baseline-list/baseline-detect/assets-risk-detail/add-white-modal.tsx";function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=b.a.Group,C=j.a.bind(E.a);t.default=function(e){var t,n=e.checklistIds,i=e.instanceId,u=e.baselineId,l=e.visible,f=e.onVisibleChange,b=e.onSuccess,m=n.length,O=m<=1,j=Object(h.a)(d()(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.q)({data:{baseline_id:u,checklist_id:n[0],if_whiten:!1}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{auto:!0,ready:O&&!!n[0]}),y=j.data,E=j.loading,k=Object(g.useState)({range:_.g.Part,white_desc:""}),D=s()(k,2),R=D[0],A=D[1];return v.a.createElement(r.a,{className:C("add-modal"),autoFocus:!1,visible:l,title:Object(w.g)("加白名单"),onCancel:function(){return f(!1)},onOk:d()(p.a.mark((function e(){var t,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=R.range,r=R.white_desc,a=i,t===_.g.All&&(a=""),e.next=5,Object(_.h)({data:{checklist_id_list:n,agent_id_list:[a],baseline_id:u,whitelist_detail:r||void 0,if_whiten:!0}});case 5:o.a.success(Object(w.g)("加白成功")),f(!1),b();case 8:case"end":return e.stop()}}),e)}))),__source:{fileName:P,lineNumber:61,columnNumber:5}},v.a.createElement(a.a,{loading:E,style:{width:"100%"},__source:{fileName:P,lineNumber:87,columnNumber:7}},O?v.a.createElement(v.a.Fragment,null,v.a.createElement("div",{className:C("tip"),__source:{fileName:P,lineNumber:90,columnNumber:13}},Object(w.g)("当前基线下有{placeholder1}台主机存在该风险，你可以选择批量加白：",{placeholder1:null!==(t=null==y?void 0:y.host_num)&&void 0!==t?t:0})),v.a.createElement("div",{className:C("tip"),__source:{fileName:P,lineNumber:95,columnNumber:13}},v.a.createElement(F,{options:N.a,value:R.range,onChange:function(e){return A(S(S({},R),{},{range:e}))},__source:{fileName:P,lineNumber:96,columnNumber:15}}))):v.a.createElement("div",{className:C("tip"),__source:{fileName:P,lineNumber:104,columnNumber:11}},Object(w.g)("您已选择{checklistIdNum}项检查项，是否确定加白名单？",{checklistIdNum:m})),v.a.createElement(c.a.TextArea,{style:{height:80},placeholder:Object(w.g)("填写本次操作说明备注，便于后续查看"),value:R.white_desc,onChange:function(e){return A(S(S({},R),{},{white_desc:e}))},__source:{fileName:P,lineNumber:110,columnNumber:9}})))}}}]);