(window.webpackJsonp=window.webpackJsonp||[]).push([[125,368,511],{1387:function(e,t,n){e.exports={container:"container-869b67a78e","first-cell":"first-cell-d927aea19c","filter-container":"filter-container-607fa08ec4","select-container":"select-container-33bffdb419",label:"label-f0e1e3cdc5","check-name":"check-name-8372193bd6","ellipsis-item":"ellipsis-item-605bec59b9","check-result":"check-result-c781a8819a",tip:"tip-813ff091f0","info-modal":"info-modal-9ede8b4eb0",table:"table-d97322f905","table-empty":"table-empty-4e1025c1ce","table-container":"table-container-cef3e86ed5",arrow:"arrow-9a5a52f745","arrow-active":"arrow-active-607f161293"}},1413:function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n.n(a);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.default=function(e){return c.a.createElement("svg",i({width:16,height:16,fill:"none"},e),r||(r=c.a.createElement("path",{d:"M6.98 12.267a1 1 0 01-1.648-.762V4.496a1 1 0 011.648-.762l4.122 3.504a1 1 0 010 1.524L6.98 12.267z",fill:"currentColor"})))}},1619:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,a,c=n(603),i=n.n(c),l=n(0),o=n.n(l),u=n(604),s=n(12),m="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/detecting-label/index.tsx",b=u.a.div(r||(r=i()(["\n  @keyframes spin {\n    0% {\n      transform: rotate(0deg) rotateX(180deg);\n    }\n    50% {\n      transform: rotate(180deg) rotateX(180deg);\n    }\n    100% {\n      transform: rotate(360deg) rotateX(180deg);\n    }\n  }\n\n  display: inline-flex;\n  align-items: center;\n  justify-content: flex-end;\n  animation: spin 1.5s linear infinite;\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  margin-right: 8px;\n  background: conic-gradient(\n    from 114.04deg at 50% 50%,\n    #165dff -3.75deg,\n    rgba(22, 93, 255, 0) 331.83deg,\n    #165dff 339.88deg,\n    #165dff 356.25deg,\n    rgba(22, 93, 255, 0) 691.83deg\n  );\n  &::before {\n    content: ' ';\n    height: 8px;\n    width: 8px;\n    border-radius: 50%;\n    background: #fff;\n  }\n  &::after {\n    content: ' ';\n    height: 2px;\n    width: 2px;\n    border-radius: 50%;\n    background: #165dff;\n  }\n"]))),d=u.a.div(a||(a=i()(["\n  display: inline-flex;\n  align-items: center;\n  font-size: 12px;\n  line-height: 20px;\n"])));t.b=function(e){var t=e.progress,n=e.label,r=void 0===n?Object(s.g)("检查中"):n,a=e.className,c=!!t||0===t;return o.a.createElement(d,{className:a,__source:{fileName:m,lineNumber:68,columnNumber:5}},o.a.createElement(b,{className:"arco-icon-loading",__source:{fileName:m,lineNumber:69,columnNumber:7}}),o.a.createElement("span",{__source:{fileName:m,lineNumber:70,columnNumber:7}},r),c&&o.a.createElement("span",{__source:{fileName:m,lineNumber:71,columnNumber:23}}," ",t,"%"))}},1659:function(e,t,n){"use strict";n(162);var r,a=n(67),c=n(603),i=n.n(c),l=n(0),o=n.n(l),u=n(604),s=n(1657),m=n(12),b="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/risk-label/risk-light-label/index.tsx",d=u.a.div(r||(r=i()(["\n  display: inline-block;\n  padding: 0 8px;\n  line-height: 20px;\n  font-weight: 500;\n  font-size: 12px;\n  border-radius: 2px;\n  color: #ffffff;\n"])));t.a=function(e){var t=e.riskLevel,n=e.count,r=e.mode,c=void 0===r?"text":r,i=Object(s.n)(t),l=Object(s.o)(t);return t?"count"===c&&n?o.a.createElement(a.a,{content:l,__source:{fileName:b,lineNumber:30,columnNumber:9}},o.a.createElement(d,{style:{backgroundColor:i},__source:{fileName:b,lineNumber:31,columnNumber:11}},n)):"text"===c?o.a.createElement(d,{style:{backgroundColor:i},__source:{fileName:b,lineNumber:36,columnNumber:14}},l):null:o.a.createElement(d,{style:{backgroundColor:"#22BB43"},__source:{fileName:b,lineNumber:41,columnNumber:10}},Object(m.g)("无风险"))}},1663:function(e,t,n){"use strict";n(200);var r=n(85),a=n(10),c=n.n(a),i=(n(224),n(97)),l=n(0),o=n.n(l),u=n(12),s="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/loading/index.tsx";function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){var t=e.error;return Object(l.useEffect)((function(){t&&(console.warn(t),i.a.error({content:Object(u.g)("加载失败，请刷新页面重试！")}))})),t?null:o.a.createElement("div",{style:b({height:"100%",background:"#fff"},e.style),__source:{fileName:s,lineNumber:21,columnNumber:5}},o.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},__source:{fileName:s,lineNumber:22,columnNumber:7}},o.a.createElement(r.a,{size:20,__source:{fileName:s,lineNumber:30,columnNumber:9}})))}},1695:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n(10),a=n.n(r),c=n(0),i=n.n(c),l=n(2),o=n.n(l),u=n(1657),s=n(1611),m=["code"];function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=[{key:"critical",code:s.b.danger},{key:"high",code:s.b.high},{key:"medium",code:s.b.mid},{key:"low",code:s.b.low},{key:"info",code:s.b.info}].map((function(e){var t=e.code;return d(d({},o()(e,m)),{},{code:t,title:Object(u.o)(t),color:Object(u.n)(t)})})),N=(n(1659),"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/global/risk-label/index.tsx");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e){var t,n=e.risk,r=e.style;if(void 0===n)return i.a.createElement("div",{__source:{fileName:N,lineNumber:23,columnNumber:34}},"-");var a,c,l,o,u=(a=n,o=f.findIndex((function(e){return e.code===a})),{color:null===(c=f[o])||void 0===c?void 0:c.color,title:null===(l=f[o])||void 0===l?void 0:l.title});return i.a.createElement("div",{style:g({display:"inline-flex",alignItems:"center",flexWrap:"nowrap"},r),__source:{fileName:N,lineNumber:26,columnNumber:5}},i.a.createElement("div",{style:null!=u&&u.color?{backgroundColor:u.color,height:6,width:6,borderRadius:"50%",marginRight:6}:void 0,__source:{fileName:N,lineNumber:34,columnNumber:7}}),i.a.createElement("div",{__source:{fileName:N,lineNumber:47,columnNumber:7}},null!==(t=null==u?void 0:u.title)&&void 0!==t?t:"-"))}},415:function(e,t,n){"use strict";n.r(t);n(1314);var r=n(810),a=n(1),c=n.n(a),i=(n(224),n(97)),l=(n(197),n(117)),o=(n(116),n(42)),u=(n(299),n(165)),s=(n(162),n(67)),m=n(28),b=n.n(m),d=n(50),f=n.n(d),N=n(16),p=n.n(N),g=n(0),_=n.n(g),h=n(115),v=n.n(h),O=n(52),y=n(1613),j=n(1675),k=n(1619),E=n(1695),w=n(1659),x=n(858),D=n(1617),P=n(1657),I=n(12),S=n(1667),C=n(145),R=n(1699),z=n(1387),B=n.n(z),F=n(811),L=n(1413),T="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/baseline-detect/baseline-detail-page/assets-risk-detail/index.tsx",G=v.a.bind(B.a);t.default=function(e){var t,n=Object(O.f)(C.l),a=Object(g.useContext)(F.BaselineDetectDetailCtx),m=a.baselineId,d=a.policyGroupId,N=a.instanceId,h=a.refreshFn,v=e.outerFilter,z=e.setOuterFilter,B=e.handleWhiteInfo,q=Object(g.useState)({checklistId:-1,baselineId:m}),K=f()(q,2),X=K[0],J=K[1],M=Object(g.useState)(-1),V=f()(M,2),W=V[0],A=V[1],H=Object(g.useState)(void 0),Q=f()(H,2),U=Q[0],Y=Q[1],Z=Object(S.b)(function(){var e=b()(p.a.mark((function e(t){var n,r,a,c,i,l,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.current,i=t.pageSize,l=v,e.next=4,Object(D.o)({data:{baseline_id:m,agent_id:N,checklist_name:l||void 0},params:{page:c,page_size:i}});case 4:return(o=e.sent).data.some((function(e){return Object(F.isDetectingStatus)(e.detect_status)}))?Y(1e4):Y(void 0),e.abrupt("return",{list:null!==(n=o.data)&&void 0!==n?n:[],total:null!==(r=null===(a=o.page_info)||void 0===a?void 0:a.total)&&void 0!==r?r:0});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{ready:Number.isFinite(m)&&!!N&&Number.isFinite(d),resetDeps:[m,N],debounceInterval:300,debounceResetDeps:[v],pollingInterval:U}),$=Z.data,ee=Z.tableProps,te=Z.refresh;h.assetsRiskDetail=te;var ne=Object(g.useState)({keys:[],rows:[]}),re=f()(ne,2),ae=re[0],ce=re[1],ie=ae.keys.length>0;Object(g.useEffect)((function(){ce({keys:[],rows:[]})}),[$]);var le=[{title:"",dataIndex:"checklist_id",width:16,render:function(e){return _.a.createElement("div",{className:G("arrow",W===e&&"arrow-active"),__source:{fileName:T,lineNumber:112,columnNumber:9}},_.a.createElement(L.default,{__source:{fileName:T,lineNumber:113,columnNumber:11}}))}},{title:Object(I.g)("检查项"),className:G("first-cell"),render:function(e,t){var n,r=t.level,a=t.checklist_name,c=t.checklist_status;return n=t.whitelist_status||c!==D.f.NoPass?_.a.createElement(E.a,{risk:r,style:{color:Object(P.n)(r)},__source:{fileName:T,lineNumber:126,columnNumber:13}}):_.a.createElement(w.a,{riskLevel:r,__source:{fileName:T,lineNumber:129,columnNumber:24}}),_.a.createElement("div",{className:G("check-name"),__source:{fileName:T,lineNumber:133,columnNumber:11}},n,_.a.createElement("div",{className:G("ellipsis-item"),__source:{fileName:T,lineNumber:135,columnNumber:13}},a))}},{title:Object(I.g)("检查结果"),width:I.d?160:128,render:function(e,t){var n=t.checklist_status,r=t.failed_detail,a=t.whitelist_status,c=t.whitelist_detail,i=t.detect_status;return Object(F.isDetectingStatus)(i)?_.a.createElement(k.b,{__source:{fileName:T,lineNumber:152,columnNumber:18}}):n===D.f.Fail?_.a.createElement("div",{className:G("check-result"),__source:{fileName:T,lineNumber:156,columnNumber:13}},Object(P.m)(n),_.a.createElement(s.a,{content:r,__source:{fileName:T,lineNumber:158,columnNumber:15}},_.a.createElement("span",{className:G("tip"),__source:{fileName:T,lineNumber:159,columnNumber:17}},Object(I.g)("说明")))):a?_.a.createElement("div",{className:G("check-result"),__source:{fileName:T,lineNumber:166,columnNumber:13}},_.a.createElement(j.a,{__source:{fileName:T,lineNumber:167,columnNumber:15}},_.a.createElement(R.a,{__source:{fileName:T,lineNumber:168,columnNumber:17}}),_.a.createElement("span",{__source:{fileName:T,lineNumber:169,columnNumber:17}},Object(I.g)("已加白"))),c&&_.a.createElement(s.a,{content:c,__source:{fileName:T,lineNumber:172,columnNumber:17}},_.a.createElement("span",{className:G("tip"),__source:{fileName:T,lineNumber:173,columnNumber:19}},Object(I.g)("备注")))):Object(P.m)(n)}},{title:Object(I.g)("操作"),headerCellStyle:{paddingLeft:"5px",paddingRight:"0"},width:I.d?152:90,render:function(e,t){var r=t.whitelist_status,a=t.checklist_status,c=t.checklist_id,i=!!r,l=!i&&a===D.f.NoPass;return _.a.createElement("div",{__source:{fileName:T,lineNumber:195,columnNumber:11}},l&&_.a.createElement(s.a,{disabled:n,content:Object(I.g)("当前用户无编辑权限"),__source:{fileName:T,lineNumber:197,columnNumber:15}},_.a.createElement(u.a,{style:{width:"fit-content"},disabled:!n,onClick:function(){return B([c],!0)},__source:{fileName:T,lineNumber:198,columnNumber:17}},Object(I.g)("加白名单"))),i&&_.a.createElement(s.a,{disabled:n,content:Object(I.g)("当前用户无编辑权限"),__source:{fileName:T,lineNumber:208,columnNumber:15}},_.a.createElement(u.a,{style:{width:"fit-content"},disabled:!n,onClick:function(){return B([c],!1)},__source:{fileName:T,lineNumber:209,columnNumber:17}},Object(I.g)("取消加白"))),!l&&!i&&_.a.createElement("span",{style:{padding:"1px 4px"},__source:{fileName:T,lineNumber:218,columnNumber:42}},"-"))}}];return _.a.createElement("div",{className:G("container"),__source:{fileName:T,lineNumber:225,columnNumber:5}},_.a.createElement("div",{className:G("filter-container"),__source:{fileName:T,lineNumber:226,columnNumber:7}},_.a.createElement("div",{className:G("select-container"),__source:{fileName:T,lineNumber:227,columnNumber:9}},_.a.createElement(s.a,{content:Object(I.g)("暂无可导出数据"),trigger:"hover",disabled:!(null==ee||null===(t=ee.data)||void 0===t||!t.length),getPopupContainer:function(){return document.querySelector("#root")},__source:{fileName:T,lineNumber:228,columnNumber:11}}),_.a.createElement(s.a,{content:Object(I.g)("请先在下方选择内容，再批量加白名单"),disabled:ie,getPopupContainer:function(){return document.querySelector("#root")},__source:{fileName:T,lineNumber:234,columnNumber:11}},_.a.createElement(o.a,{onClick:function(){return B(ae.keys,!0)},disabled:!ie,__source:{fileName:T,lineNumber:239,columnNumber:13}},Object(I.g)("批量加白名单")))),_.a.createElement("div",{__source:{fileName:T,lineNumber:247,columnNumber:9}},_.a.createElement(l.a.Search,{style:{width:360,marginRight:12},value:v,maxLength:255,allowClear:!0,placeholder:Object(I.g)("请搜索检查项名称"),onChange:function(e){z(e)},__source:{fileName:T,lineNumber:248,columnNumber:11}}),_.a.createElement(y.a,{onRefresh:b()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te();case 2:i.a.success(Object(I.g)("刷新成功"));case 3:case"end":return e.stop()}}),e)}))),__source:{fileName:T,lineNumber:258,columnNumber:11}}))),_.a.createElement("div",{className:G("table-container"),__source:{fileName:T,lineNumber:266,columnNumber:7}},_.a.createElement(r.a,c()({className:G("table",!ee.data.length&&"table-empty"),expandedRowKeys:[W],expandedRowRender:function(){return _.a.createElement(x.default,c()({},X,{__source:{fileName:T,lineNumber:270,columnNumber:36}}))},expandProps:{width:0,expandRowByClick:!0,icon:null},onRow:function(e){return{onClick:function(t){var n;"arco-checkbox-mask"!==t.target.className&&("arco-link"!==t.target.className&&(n={checklistId:e.checklist_id===W?-1:e.checklist_id,baselineId:m},J(n),A(n.checklistId)))}}},columns:le},ee,{rowKey:"checklist_id",rowSelection:{type:"checkbox",selectedRowKeys:ae.keys,onChange:function(e,t){ce({keys:e,rows:t})},checkboxProps:function(e){return{disabled:e.whitelist_status||e.checklist_status!==D.f.NoPass}}},__source:{fileName:T,lineNumber:267,columnNumber:9}}))))}},811:function(e,t,n){"use strict";n.r(t),n.d(t,"BaselineDetectCtx",(function(){return l})),n.d(t,"BaselineDetectDetailCtx",(function(){return o})),n.d(t,"useDetectingTransferFinish",(function(){return u})),n.d(t,"isDetectingStatus",(function(){return s})),n.d(t,"isFinishDetectStatus",(function(){return m})),n.d(t,"isTransferDetectFinish",(function(){return b})),n.d(t,"POLLING_INTERVAL_TIME",(function(){return d}));var r=n(0),a=n.n(r),c=n(163),i=n(1617),l=a.a.createContext({policyGroupId:0,policyDetectStatus:i.b.finished,loadingPostBaselineDetect:!1,neverDetect:!0,taskIsDetecting:!1,handleBaselineDetect:function(){},handleSomeDetect:function(){},handleDetectSuccess:function(){},progress:0,loadingDetectCondition:!1,baselineType:void 0}),o=a.a.createContext({policyGroupId:0,policyDetectStatus:i.b.finished,loadingPostBaselineDetect:!1,neverDetect:!0,taskIsDetecting:!1,handleBaselineDetect:function(){},handleSomeDetect:function(){},handleDetectSuccess:function(){},progress:0,loadingDetectCondition:!1,instanceId:void 0,baselineId:void 0,baselineType:void 0});function u(){var e=Object(r.useRef)();return{isTransferDetectStatus:function(t){var n,r=t.detectStatus,a=t.policyGroupId,i=null!==(n=e.current)&&void 0!==n?n:{},l=i.detectStatus,o=i.policyGroupId,u=b(r,l)&&Object(c.eq)(o,a);return e.current=t,u},preData:e}}function s(e){return e===i.b.detecting}function m(e){return e===i.b.finished}function b(e,t){return e===i.b.finished&&t===i.b.detecting}var d=1e4},858:function(e,t,n){"use strict";n.r(t);var r=n(28),a=n.n(r),c=(n(595),n(298)),i=n(16),l=n.n(i),o=n(0),u=n.n(o),s=n(1292),m=n(115),b=n.n(m),d=n(1663),f=n(1617),N=n(12),p=n(1387),g=n.n(p),_=n(811),h="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/baseline-detect/baseline-detail-page/assets-risk-detail/risk-info.tsx",v=c.a.Row,O=c.a.Col,y=b.a.bind(g.a);t.default=function(e){var t=e.checklistId,n=e.baselineId,r=Object(o.useContext)(_.BaselineDetectDetailCtx).instanceId,c=Object(s.a)(a()(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.p)({data:{baseline_id:n,checklist_id:t,agent_id:r}});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)}))),{ready:!!t&&!!n,auto:!0}),i=c.data,m=c.loading,b=null!=i?i:{},p=b.resolve,g=b.description;return u.a.createElement("div",{className:y("info-modal"),__source:{fileName:h,lineNumber:47,columnNumber:5}},m||!i?u.a.createElement("div",{style:{height:100},__source:{fileName:h,lineNumber:49,columnNumber:9}},u.a.createElement(d.a,{style:{background:"transparent"},__source:{fileName:h,lineNumber:50,columnNumber:11}})):u.a.createElement(u.a.Fragment,null,u.a.createElement(v,{__source:{fileName:h,lineNumber:54,columnNumber:11}},u.a.createElement(O,{__source:{fileName:h,lineNumber:55,columnNumber:13}},u.a.createElement("span",{__source:{fileName:h,lineNumber:56,columnNumber:15}},Object(N.g)("描述")),u.a.createElement("span",{__source:{fileName:h,lineNumber:57,columnNumber:15}},g||"-"))),u.a.createElement(v,{__source:{fileName:h,lineNumber:60,columnNumber:11}},u.a.createElement(O,{__source:{fileName:h,lineNumber:61,columnNumber:13}},u.a.createElement("span",{__source:{fileName:h,lineNumber:62,columnNumber:15}},Object(N.g)("加固建议")),u.a.createElement("span",{__source:{fileName:h,lineNumber:63,columnNumber:15}},p||"-")))))}}}]);