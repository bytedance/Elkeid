(window.webpackJsonp=window.webpackJsonp||[]).push([[144,426],{1460:function(e,n,r){e.exports={modal:"modal-e84063fb07","modal-warp":"modal-warp-0151ce33df",wrapper:"wrapper-a70f7fd057","drawer-wrapper":"drawer-wrapper-a9c67cef7a"}},1703:function(e,n,r){"use strict";r.d(n,"h",(function(){return t})),r.d(n,"a",(function(){return c})),r.d(n,"e",(function(){return i})),r.d(n,"f",(function(){return u})),r.d(n,"g",(function(){return l})),r.d(n,"c",(function(){return s})),r.d(n,"d",(function(){return m})),r.d(n,"b",(function(){return b}));var t,o=r(54),a=r(12);function c(e,n){return Object(o.b)({url:"/api/v6/kube/GetConfigList",params:e,data:n,method:"POST"},Object(a.g)("获取容器集群配置列表"))}function i(e){return Object(o.b)({url:"/api/v6/kube/AddConfig",data:e,method:"POST"},Object(a.g)("添加集群"))}function u(e){return Object(o.b)({url:"/api/v6/kube/DelConfig",data:e,method:"POST"},Object(a.g)("取消集群链接"))}function l(e){return Object(o.b)({url:"/api/v6/kube/RenameConfig",data:e,method:"POST"},Object(a.g)("重命名集群"))}function s(){return Object(o.b)({url:"/api/v6/kube/PolicyDownload",method:"GET",responseType:"blob"},Object(a.g)("集群policy文件下载"),!1,!1)}function m(e){return Object(o.b)({url:"/api/v6/kube/WebhookDownload",params:e,method:"GET",responseType:"blob"},Object(a.g)("集群webhook文件下载"))}function b(){return Object(o.b)({url:"/api/v6/kube/KubeCreateShDownload",method:"GET",responseType:"blob"},Object(a.g)("k8s创建kube脚本文件下载"))}!function(e){e["正常运行"]="active",e["未安装"]="inactive",e["异常"]="error",e["安装失败"]="install_fail",e.active="正常运行",e.inactive="未安装",e.error="异常",e.install_fail="安装失败"}(t||(t={}))},1718:function(e,n,r){"use strict";n.a=function(e,n){var r,t=new Set,o={},a=[];Object.keys(n).forEach((function(n){var r=new RegExp("\\{".concat(n,"\\}"),"g"),a=Array.from(null==e?void 0:e.matchAll(r));null==a||a.forEach((function(e){var r=e.index;(function(e,n){for(;e<n;){if(t.has(e))return!0;e++}return!1})(r,r+n.length+2)||(!function(e,n){for(;e<n;)t.add(e),e++}(r,r+n.length+2),o[r]=n)}))}));for(var c=0;c<e.length;){var i,u=o[c];if(u)r&&(a.push(r),r=void 0),a.push(null===(i=n[u])||void 0===i?void 0:i.call(n)),c+=u.length+2;else r=(r||"")+e[c],c++}return r&&a.push(r),a}},1749:function(e,n,r){"use strict";var t=r(0),o=r.n(t),a=r(115),c=r.n(a),i=r(1755),u=r.n(i),l="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/readonly-code-block/index.tsx",s=c.a.bind(u.a);n.a=function(e){var n=e.code,r=e.highlights,t=void 0===r?[]:r,a=e.style,c=void 0===a?{}:a,i=new Set(t),u="string"==typeof n?n.split("\n").map((function(e,n){return{code:e,style:{background:i.has(n+1)?"#E8F4FF":void 0}}})):n.map((function(e){return"string"==typeof e?{code:e}:e}));return o.a.createElement("div",{className:s("container"),style:c,__source:{fileName:l,lineNumber:32,columnNumber:5}},o.a.createElement("div",{className:s("lines-gutter"),__source:{fileName:l,lineNumber:33,columnNumber:7}},u.map((function(e,n){return o.a.createElement("p",{key:n,__source:{fileName:l,lineNumber:35,columnNumber:11}},n+1)}))),o.a.createElement("div",{className:s("code-container"),__source:{fileName:l,lineNumber:38,columnNumber:7}},u.map((function(e,n){var r=e.code,t=e.style,a=void 0===t?{}:t;return o.a.createElement("code",{key:n,style:a,__source:{fileName:l,lineNumber:40,columnNumber:11}},r)}))))}},1755:function(e,n,r){e.exports={container:"container-f62ec6cf8a","lines-gutter":"lines-gutter-31fdc2c602","code-container":"code-container-cf098acda3"}},453:function(e,n,r){"use strict";r.r(n);r(1294);var t=r(1295),o=(r(597),r(226)),a=(r(299),r(165)),c=(r(197),r(117)),i=(r(807),r(605)),u=r(28),l=r.n(u),s=(r(806),r(199)),m=r(50),b=r.n(m),d=r(16),f=r.n(d),p=r(0),N=r.n(p),g=r(115),v=r.n(g),_=r(1749),h=r(1703),k=r(12),O=r(1718),w=r(1460),j=r.n(w),E="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/kube-config/add-cluster-modal/index.tsx",y=v.a.bind(j.a);n.default=function(e){var n=e.visible,r=void 0!==n&&n,u=e.onCancel,m=void 0===u?function(){}:u,d=e.onConfirm,g=void 0===d?function(){}:d,v=Object(p.useState)(!1),w=b()(v,2),j=w[0],C=w[1],x=s.a.useForm(),G=b()(x,1)[0];return N.a.createElement("div",{className:y("warpper"),__source:{fileName:E,lineNumber:30,columnNumber:5}},N.a.createElement(o.a,{wrapClassName:y("modal-warp"),title:N.a.createElement("div",{style:{textAlign:"left"},__source:{fileName:E,lineNumber:33,columnNumber:16}},Object(k.g)("添加集群")),visible:r,className:y("modal"),onCancel:m,getPopupContainer:function(){return document.getElementById("content-root")},onConfirm:function(){G.validate().then((function(e){return l()(f.a.mark((function n(){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(h.e)(e);case 3:G.resetFields(),g(),n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()})).catch()},__source:{fileName:E,lineNumber:31,columnNumber:7}},N.a.createElement(i.a,{style:{marginBottom:20,marginLeft:-20,width:600},type:"info",banner:!0,showIcon:!1,content:Object(k.g)("集群添加完成后，请前往资产中心-容器集群页面，根据指引安装安全组件，并确保组件正常运行"),__source:{fileName:E,lineNumber:60,columnNumber:9}}),N.a.createElement(s.a,{form:G,__source:{fileName:E,lineNumber:69,columnNumber:9}},N.a.createElement(s.a.Item,{label:Object(k.g)("集群名称"),field:"cluster_name",rules:[{required:!0,message:Object(k.g)("请输入集群名称")}],required:!0,__source:{fileName:E,lineNumber:70,columnNumber:11}},N.a.createElement(c.a,{placeholder:Object(k.g)("请输入"),__source:{fileName:E,lineNumber:81,columnNumber:13}})),N.a.createElement(s.a.Item,{label:Object(k.g)("集群区域"),field:"cluster_region",rules:[{required:!0,message:Object(k.g)("请输入集群区域")}],required:!0,__source:{fileName:E,lineNumber:83,columnNumber:11}},N.a.createElement(c.a,{style:{width:220},placeholder:Object(k.g)("请输入"),__source:{fileName:E,lineNumber:94,columnNumber:13}})),N.a.createElement(s.a.Item,{label:"kubeconfig",field:"kube_config",rules:[{required:!0,message:Object(k.g)("请输入kubeconfig")}],required:!0,extra:N.a.createElement("ul",{style:{listStyle:"outside",paddingLeft:20},__source:{fileName:E,lineNumber:107,columnNumber:15}},N.a.createElement("li",{__source:{fileName:E,lineNumber:108,columnNumber:17}},Object(k.g)("请将集群连接配置文件（kubeconfig）的内容复制粘贴到输入框。")),N.a.createElement("li",{__source:{fileName:E,lineNumber:109,columnNumber:17}},Object(k.g)("注：请确保 kubeconfig 中的 UserAccount 具有足够的权限，以便平台实现集群资产获取、云原生安全组件安装等功能。")),N.a.createElement("li",{__source:{fileName:E,lineNumber:114,columnNumber:17}},Object(O.a)(Object(k.g)("目前，请提供具有{link}的用户账户的 kubeconfig 文件。"),{link:function(){return N.a.createElement(a.a,{onClick:function(){C(!0)},__source:{fileName:E,lineNumber:119,columnNumber:25}},Object(k.g)("这些权限"))}}),Object(O.a)(Object(k.g)("您也可以参考{link}生成 kubeconfig 并在集群中创建对应的 ClusterRole & ClusterRoleBinding 对象。"),{link:function(){return N.a.createElement(a.a,{onClick:function(){Object(h.b)()},__source:{fileName:E,lineNumber:135,columnNumber:25}},Object(k.g)("此脚本"))}}))),__source:{fileName:E,lineNumber:96,columnNumber:11}},N.a.createElement(c.a.TextArea,{style:{height:80},placeholder:Object(k.g)("请将集群连接配置文件（kubeconfig）复制粘贴在此处"),__source:{fileName:E,lineNumber:149,columnNumber:13}})))),N.a.createElement(t.a,{wrapClassName:"drawer-wrapper-z1002",title:Object(k.g)("权限"),footer:null,style:{width:560},visible:j,getPopupContainer:function(){return document.querySelector("#content-root")},onCancel:function(){return C(!1)},__source:{fileName:E,lineNumber:161,columnNumber:7}},N.a.createElement(_.a,{code:'apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: elkeid-cwpp-console\n  labels:\n    app: elkeid-cwpp-console\nrules:\n- apiGroups:\n  - ""\n  resources:\n  - nodes\n  - pods\n  - replicationcontrollers\n  - namespaces\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - apps\n  resources:\n  - daemonsets\n  - deployments\n  - replicasets\n  - statefulsets\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - batch\n  resources:\n  - jobs\n  - cronjobs\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - "apiextensions.k8s.io"\n  resources:\n  - customresourcedefinitions\n  verbs:\n  - "*"\n- apiGroups:\n  - "rbac.authorization.k8s.io"\n  resources:\n  - clusterrolebindings\n  - clusterroles\n  verbs:\n  - "*"\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: elkeid-cwpp-console\n  namespace: elkeid\n  labels:\n    app: elkeid-cwpp-console\nrules:\n- apiGroups:\n  - ""\n  resources:\n  - namespaces\n  resourceNames:\n  - elkeid\n  verbs:\n  - "*"\n- apiGroups:\n  - ""\n  resources:\n  - serviceaccounts\n  - secrets\n  - configmaps\n  verbs:\n  - "*"\n- apiGroups:\n  - apps\n  resources:\n  - deployments\n  verbs:\n  - "*"\n- apiGroups:\n  - "rbac.authorization.k8s.io"\n  resources:\n  - rolebindings\n  - roles\n  verbs:\n  - "*"',__source:{fileName:E,lineNumber:172,columnNumber:9}})))}}}]);