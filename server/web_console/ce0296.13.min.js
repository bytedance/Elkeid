(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1609:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));n(299);var r=n(165),l=n(0),c=n.n(l),o=n(55),i=n(164),a=n.n(i),u=n(147),m=n(166);function s(){return(m.a?location.pathname.slice(null===m.a||void 0===m.a?void 0:m.a.length):location.pathname)+encodeURIComponent(location.search)}t.a=function(e){var t=e.defaultLink,n=e.defaultTitle,i=Object(o.g)();var m=Object(l.useMemo)((function(){return function(){var e,t=null===(e=a.a.parse(location.search))||void 0===e?void 0:e.breadcrumbLinkFrom;if(t){var n,r,l,c,o="";if(null!=t&&null!==(n=t.indexOf)&&void 0!==n&&n.call(t,"?"))o=null==t||null===(l=t.split)||void 0===l||null===(c=l.call(t,"?"))||void 0===c?void 0:c[0];else o=t;var i=null===u.c||void 0===u.c||null===(r=u.c.find)||void 0===r?void 0:r.call(u.c,(function(e){return(null==e?void 0:e.path)===o&&(null==e?void 0:e.name)}));if(i)return{link:t,title:null==i?void 0:i.name}}return{link:void 0,title:void 0}}()}),[]),s=m.link,b=m.title;return c.a.createElement(r.a,{style:{color:"#4E5969"},onClick:function(){i.push(s||t)},__source:{fileName:"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/breadcrumb-link.tsx",lineNumber:63,columnNumber:5}},b||n)}},1616:function(e,t,n){"use strict";n(803);var r=n(227),l=n(10),c=n.n(l),o=n(0),i=n.n(o),a="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/ellipsis-box/index.tsx";function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){var t=e.content,n=e.style,l=e.className,c=e.tooltipProps;return i.a.createElement(r.a.Paragraph,{className:l,style:m({marginBottom:0},n),ellipsis:{rows:1,showTooltip:{type:"tooltip",props:m(m({},c),{},{content:i.a.createElement("span",{style:{wordBreak:"break-all"},__source:{fileName:a,lineNumber:22,columnNumber:22}},t)})}},key:t,__source:{fileName:a,lineNumber:13,columnNumber:5}},t)}},1636:function(e,t,n){"use strict";function r(e){if(e>=1e3&&e<1e4){var t=(e/1e3).toFixed(1);return-1!==t.indexOf(".0")&&(t=t.slice(0,t.length-2)),"".concat(t,"k")}if(e>=1e4){var n=(e/1e4).toFixed(1);return-1!==n.indexOf(".0")&&(n=n.slice(0,n.length-2)),"".concat(n,"w")}return"".concat(e)}n.d(t,"a",(function(){return r}))},1656:function(e,t,n){"use strict";n(162);var r,l=n(67),c=n(1328),o=n(10),i=n.n(o),a=n(0),u=n.n(a),m=n(799),s=n(115),b=n.n(s),d=n(196),f=n(1636),p=n(1660),v=n.n(p);function N(){return(N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var g=function(e){return u.a.createElement("svg",N({width:6,height:8,fill:"none"},e),r||(r=u.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.04 6.934a.5.5 0 010-.708l2.18-2.18L1.101 1.93a.5.5 0 010-.707l.353-.354a.5.5 0 01.707 0l2.829 2.828a.5.5 0 010 .708l-.354.353a.504.504 0 01-.055.048L2.1 7.287a.5.5 0 01-.707 0l-.354-.353z",fill:"currentColor"})))},_="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/count-box/index.tsx";function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=b.a.bind(v.a);t.a=function(e){var t=e.title,n=e.count,r=e.containerStyle,o=e.util,i=e.onClick,a=e.description;return u.a.createElement("div",{className:j("container",i&&"onclick"),style:h({},r),onClick:function(){i&&i()},__source:{fileName:_,lineNumber:35,columnNumber:5}},u.a.createElement("div",{className:j("title"),__source:{fileName:_,lineNumber:42,columnNumber:7}},u.a.createElement(m.a,{__source:{fileName:_,lineNumber:43,columnNumber:9}},t,i&&u.a.createElement(g,{__source:{fileName:_,lineNumber:45,columnNumber:23}}),a&&u.a.createElement(l.a,{content:a,__source:{fileName:_,lineNumber:47,columnNumber:13}},u.a.createElement(c.a,{__source:{fileName:_,lineNumber:48,columnNumber:15}})))),u.a.createElement("div",{className:j("count-box"),__source:{fileName:_,lineNumber:53,columnNumber:7}},u.a.createElement("span",{className:j("count"),__source:{fileName:_,lineNumber:54,columnNumber:9}},u.a.createElement(d.c,{__source:{fileName:_,lineNumber:55,columnNumber:11}},void 0===n?"-":Object(f.a)(n))),u.a.createElement("span",{className:j("util"),__source:{fileName:_,lineNumber:59,columnNumber:9}},o)))}},1660:function(e,t,n){e.exports={container:"container-7a1454a3b0",onclick:"onclick-f44f298af4",title:"title-b0e4e17406","count-box":"count-box-9b4b5d88dd",count:"count-c32c42556a",util:"util-4b537f2a04"}},1722:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(595);var r=n(298),l=n(0),c=n.n(l),o=n(115),i=n.n(o),a=n(1742),u=n.n(a),m="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/detail-box/index.tsx",s=i.a.bind(u.a),b=r.a.Row,d=r.a.Col,f=function(e){var t=e.records,n=void 0===t?[]:t,r=e.divider,l=void 0===r||r,o=e.title,i=e.style,a=void 0===i?{}:i;return c.a.createElement("div",{className:s("container",l&&"container-divide"),style:a,__source:{fileName:m,lineNumber:26,columnNumber:5}},c.a.createElement("div",{className:s("title"),__source:{fileName:m,lineNumber:27,columnNumber:7}},o),c.a.createElement(b,{gutter:[16,16],__source:{fileName:m,lineNumber:28,columnNumber:7}},n.map((function(e,t){return c.a.createElement(d,{span:e.col||12,key:"".concat(t,"_").concat(e.key||e.title),__source:{fileName:m,lineNumber:30,columnNumber:11}},e.title&&c.a.createElement("div",{className:s("info-title"),__source:{fileName:m,lineNumber:31,columnNumber:30}},e.title),e.content&&c.a.createElement("div",{className:s("info-content"),__source:{fileName:m,lineNumber:32,columnNumber:32}},e.content))}))))}},1742:function(e,t,n){e.exports={container:"container-0eb7083549","container-divide":"container-divide-616dc9618a",title:"title-459463726c","info-title":"info-title-9273b91a39","info-content":"info-content-2962793005"}},1743:function(e,t,n){"use strict";var r=n(10),l=n.n(r),c=n(0),o=n.n(c),i=n(115),a=n.n(i),u=n(1616),m=n(1636),s=n(1744),b=n.n(s),d="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/formatted-legend/index.tsx";function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=a.a.bind(b.a);t.a=function(e){var t,n,r,l,c,i=(null!==(t=e.leftGap)&&void 0!==t?t:0)+(null!==(n=e.rightGap)&&void 0!==n?n:0)+(null!==(r=e.width)&&void 0!==r?r:80),a="row"===e.flow?{width:i*e.cols||0,flexBasis:i*e.cols||0,flexShrink:0}:{height:(null!==(l=e.height)&&void 0!==l?l:28)*e.rows||0,width:Math.ceil(e.data.length/e.rows)*i||0,flexBasis:Math.ceil(e.data.length/e.rows)*i||0,flexShrink:0};return o.a.createElement("div",{className:v("legend-container"),style:p({flexFlow:null!==(c=e.flow)&&void 0!==c?c:"row"},a),__source:{fileName:d,lineNumber:44,columnNumber:5}},e.data.map((function(t){var n,r,l,c,i;return o.a.createElement("div",{className:v("legend-box"),style:{width:null!==(n=e.width)&&void 0!==n?n:80,height:null!==(r=e.height)&&void 0!==r?r:28,marginLeft:null!==(l=e.leftGap)&&void 0!==l?l:0,marginRight:null!==(c=e.rightGap)&&void 0!==c?c:0},key:t.label,onClick:function(){return e.onClick&&e.onClick(t)},__source:{fileName:d,lineNumber:52,columnNumber:9}},o.a.createElement("div",{className:v("icon","icon-".concat(null!==(i=e.iconShape)&&void 0!==i?i:"circle"),e.mini&&"icon-mini"),style:{backgroundColor:t.color},__source:{fileName:d,lineNumber:63,columnNumber:11}}),o.a.createElement(u.a,{content:t.label,className:v("label",e.hoverable&&"label-hover"),__source:{fileName:d,lineNumber:67,columnNumber:11}}),o.a.createElement("div",{className:v("count"),__source:{fileName:d,lineNumber:71,columnNumber:11}},o.a.createElement(u.a,{content:Object(m.a)(+t.count)||"0",__source:{fileName:d,lineNumber:72,columnNumber:13}})))})))}},1744:function(e,t,n){e.exports={"legend-container":"legend-container-c49504a44d","legend-box":"legend-box-681c5866a9",icon:"icon-d9a24dfeaa","icon-circle":"icon-circle-cf43244ad6","icon-mini":"icon-mini-a7b1934365",label:"label-2174b61860","label-hover":"label-hover-93ec456d30",count:"count-b713de2f75"}},1745:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return d}));var r,l,c=n(10),o=n.n(c),i=n(54),a=n(12);function u(){return Object(i.b)({url:"/api/v6/exposure/DescribeHostStatistics",method:"GET"},Object(a.g)("获取主机风险统计信息"))}!function(e){e.ip="ip",e.service="service"}(l||(l={}));var m=(r={},o()(r,l.ip,Object(a.g)("公网暴露")),o()(r,l.service,Object(a.g)("对外服务")),r);function s(e,t){return Object(i.b)({url:"/api/v6/exposure/DescribeHosts",params:e,data:t,method:"POST"},Object(a.g)("获取主机暴露面列表"))}function b(e){return Object(i.b)({url:"/api/v6/exposure/DescribeHostDetail",params:e,method:"GET"},Object(a.g)("获取主机暴露面详情"))}function d(e,t){return Object(i.b)({url:"/api/v6/exposure/DescribeHostServices",params:e,data:t,method:"POST"},Object(a.g)("获取主机暴露面服务列表"))}},446:function(e,t,n){"use strict";n.r(t);n(1294);var r=n(1295),l=(n(1314),n(810)),c=n(1),o=n.n(c),i=n(28),a=n.n(i),u=n(16),m=n.n(u),s=n(0),b=n.n(s),d=n(55),f=n(1603),p=n(599),v=n(1292),N=n(1609),g=n(1656),_=n(1722),O=n(1616),h=n(1743),j=n(594),y=n(1745),x=n(12),E="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/exposure/host-exposure/exposure-detail-drawer/index.tsx";t.default=function(e){var t,n,c=e.id,i=e.visible,u=void 0!==i&&i,s=e.onClose,w=Object(d.g)(),k=Object(v.a)(a()(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.a)({agent_id:c});case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),{ready:u,auto:!0,refreshDeps:[c]}).data,P=Object(p.a)(function(){var e=a()(m.a.mark((function e(t){var n,r,l,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.current,r=t.pageSize,e.next=3,Object(y.d)({page:n,page_size:r},{agent_id:c});case 3:return l=e.sent,o=l.data,i=l.page_info,e.abrupt("return",{list:o,total:(null==i?void 0:i.total)||0});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{ready:u,auto:!0,debounceInterval:300,refreshDeps:[c]}).tableProps,F=[{title:Object(x.g)("序号"),dataIndex:"index",render:function(e){return void 0===e?"-":e}},{title:Object(x.g)("服务/进程"),dataIndex:"name",render:function(e){return e||"-"}},{title:Object(x.g)("端口号"),dataIndex:"port",render:function(e){return e||"-"}},{title:Object(x.g)("版本号"),dataIndex:"version",render:function(e){return e||"-"}},{title:Object(x.g)("路径"),dataIndex:"path",render:function(e){return e?b.a.createElement(O.a,{content:e,__source:{fileName:E,lineNumber:84,columnNumber:29}}):"-"}},{title:Object(x.g)("容器名"),dataIndex:"container_name",render:function(e,t){return e?b.a.createElement(j.a,{href:"/kube-detail?name=".concat(e,"&clusterId=").concat(null==t?void 0:t.container_id),target:"_blank",style:{marginLeft:-8},__source:{fileName:E,lineNumber:94,columnNumber:11}},e):"-"}}];return b.a.createElement(r.a,{title:Object(x.g)("暴露面详情"),style:{width:900},getPopupContainer:function(){return document.getElementById("content-root")},footer:null,visible:u,onCancel:s,__source:{fileName:E,lineNumber:108,columnNumber:5}},b.a.createElement(_.a,{title:Object(x.g)("主机基础信息"),style:{padding:0},records:[{title:Object(x.g)("主机名"),content:(null==k?void 0:k.hostname)||"-",col:6},{title:Object(x.g)("操作系统"),content:(null==k?void 0:k.platform)||"-",col:6},{title:Object(x.g)("内网 IP"),content:null!=k&&null!==(t=k.intranet_ipv4)&&void 0!==t&&t.length?b.a.createElement(f.a,{list:null==k?void 0:k.intranet_ipv4,__source:{fileName:E,lineNumber:135,columnNumber:15}}):"-",col:6},{title:Object(x.g)("外网 IP"),content:null!=k&&null!==(n=k.extranet_ipv4)&&void 0!==n&&n.length?b.a.createElement(f.a,{list:null==k?void 0:k.extranet_ipv4,__source:{fileName:E,lineNumber:144,columnNumber:15}}):"-",col:6}],__source:{fileName:E,lineNumber:118,columnNumber:7}}),b.a.createElement(_.a,{title:Object(x.g)("风险信息"),style:{padding:"20px 0 0 0"},records:[{content:b.a.createElement("div",{style:{background:"#F6F7FB",borderRadius:2,padding:"8px 16px 0 16px",display:"flex"},__source:{fileName:E,lineNumber:158,columnNumber:15}},b.a.createElement(g.a,{title:Object(x.g)("告警"),count:Object.values((null==k?void 0:k.alarm)||{}).reduce((function(e,t){return e+t}),0),onClick:function(){return w.push("/host-detail?activeTab=".concat("securityAlarm","&agentId=",c,"&breadcrumbLinkFrom=").concat(Object(N.b)()))},__source:{fileName:E,lineNumber:166,columnNumber:17}}),b.a.createElement(h.a,{mini:!0,rows:2,leftGap:10,width:80,data:[{label:Object(x.g)("紧急"),count:null==k?void 0:k.alarm.critical,color:"#E63F3F"},{label:Object(x.g)("高危"),count:null==k?void 0:k.alarm.high,color:"#846BCE"},{label:Object(x.g)("中危"),count:null==k?void 0:k.alarm.medium,color:"#FEC745"},{label:Object(x.g)("低危"),count:null==k?void 0:k.alarm.low,color:"#468DFF"}],__source:{fileName:E,lineNumber:175,columnNumber:17}})),col:8},{content:b.a.createElement("div",{style:{background:"#F6F7FB",borderRadius:2,padding:"8px 16px 0 16px",display:"flex"},__source:{fileName:E,lineNumber:209,columnNumber:15}},b.a.createElement(g.a,{title:Object(x.g)("漏洞"),count:Object.values((null==k?void 0:k.high_available_vuln)||{}).reduce((function(e,t){return e+t}),0),onClick:function(){return w.push("/host-detail?activeTab=".concat("vulnerabilityRisk","&agentId=",c,"&breadcrumbLinkFrom=").concat(Object(N.b)()))},__source:{fileName:E,lineNumber:217,columnNumber:17}}),b.a.createElement(h.a,{mini:!0,rows:2,leftGap:10,width:80,data:[{label:Object(x.g)("紧急"),count:null==k?void 0:k.high_available_vuln.critical,color:"#E63F3F"},{label:Object(x.g)("高危"),count:null==k?void 0:k.high_available_vuln.high,color:"#846BCE"},{label:Object(x.g)("中危"),count:null==k?void 0:k.high_available_vuln.medium,color:"#FEC745"},{label:Object(x.g)("低危"),count:null==k?void 0:k.high_available_vuln.low,color:"#468DFF"}],__source:{fileName:E,lineNumber:229,columnNumber:17}})),col:8},{content:b.a.createElement("div",{style:{background:"#F6F7FB",borderRadius:2,padding:"8px 16px 0 16px",display:"flex"},__source:{fileName:E,lineNumber:263,columnNumber:15}},b.a.createElement(g.a,{title:Object(x.g)("基线"),count:Object.values((null==k?void 0:k.baseline)||{}).reduce((function(e,t){return e+t}),0),onClick:function(){return w.push("/host-detail?activeTab=".concat("baselineRisk","&agentId=",c,"&breadcrumbLinkFrom=").concat(Object(N.b)()))},__source:{fileName:E,lineNumber:271,columnNumber:17}}),b.a.createElement(h.a,{mini:!0,rows:2,leftGap:10,width:80,data:[{label:Object(x.g)("紧急"),count:null==k?void 0:k.baseline.critical,color:"#E63F3F"},{label:Object(x.g)("高危"),count:null==k?void 0:k.baseline.high,color:"#846BCE"},{label:Object(x.g)("中危"),count:null==k?void 0:k.baseline.medium,color:"#FEC745"},{label:Object(x.g)("低危"),count:null==k?void 0:k.baseline.low,color:"#468DFF"}],__source:{fileName:E,lineNumber:280,columnNumber:17}})),col:8}],__source:{fileName:E,lineNumber:152,columnNumber:7}}),b.a.createElement(_.a,{title:Object(x.g)("暴露服务"),style:{padding:"20px 0 16px 0 "},divider:!1,__source:{fileName:E,lineNumber:314,columnNumber:7}}),b.a.createElement(l.a,o()({border:null,rowKey:"_id",columns:F},P,{__source:{fileName:E,lineNumber:315,columnNumber:7}})))}}}]);