(window.webpackJsonp=window.webpackJsonp||[]).push([[118,136,190,314,315,448,449,450],{1422:function(e,t,n){e.exports={container:"container-fb23dc4353"}},1479:function(e,t,n){e.exports={container:"container-ba3c49f6e0","content-box":"content-box-23d3a8a006",content:"content-c4285eedb5","top-box":"top-box-5a98d5d505",title:"title-ae543ed047",time:"time-70e781ea00"}},1541:function(e,t,n){e.exports={"event-box":"event-box-0c1d0dff10","empty-box":"empty-box-07dc388ffb"}},1608:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),i=n.n(r),o=n(70),c=n.n(o),a="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/utils/get-display-time.tsx";function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var r=c.a.unix(e).format(t);if(n){var o=null==r?void 0:r.split(" ");return i.a.createElement(i.a.Fragment,null,null==o?void 0:o.map((function(e){return i.a.createElement("div",{key:e,__source:{fileName:a,lineNumber:12,columnNumber:13}},e)})))}return r}return"-"}},1609:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));n(299);var r=n(165),i=n(0),o=n.n(i),c=n(55),a=n(164),l=n.n(a),u=n(147),m=n(166);function s(){return(m.a?location.pathname.slice(null===m.a||void 0===m.a?void 0:m.a.length):location.pathname)+encodeURIComponent(location.search)}t.a=function(e){var t=e.defaultLink,n=e.defaultTitle,a=Object(c.g)();var m=Object(i.useMemo)((function(){return function(){var e,t=null===(e=l.a.parse(location.search))||void 0===e?void 0:e.breadcrumbLinkFrom;if(t){var n,r,i,o,c="";if(null!=t&&null!==(n=t.indexOf)&&void 0!==n&&n.call(t,"?"))c=null==t||null===(i=t.split)||void 0===i||null===(o=i.call(t,"?"))||void 0===o?void 0:o[0];else c=t;var a=null===u.c||void 0===u.c||null===(r=u.c.find)||void 0===r?void 0:r.call(u.c,(function(e){return(null==e?void 0:e.path)===c&&(null==e?void 0:e.name)}));if(a)return{link:t,title:null==a?void 0:a.name}}return{link:void 0,title:void 0}}()}),[]),s=m.link,v=m.title;return o.a.createElement(r.a,{style:{color:"#4E5969"},onClick:function(){a.push(s||t)},__source:{fileName:"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/breadcrumb-link.tsx",lineNumber:63,columnNumber:5}},v||n)}},1687:function(e,t,n){"use strict";n.r(t),n.d(t,"GetDescribeAsset",(function(){return a})),n.d(t,"EventflowEventType",(function(){return r})),n.d(t,"OverviewAlarmLevel",(function(){return i})),n.d(t,"GetOverviewAlarm",(function(){return u})),n.d(t,"GetOverviewAgentRisk",(function(){return m})),n.d(t,"GetOverviewVulnRisk",(function(){return s})),n.d(t,"GetOverviewBaselineRisk",(function(){return v})),n.d(t,"GetOverviewDescribeAgent",(function(){return d})),n.d(t,"ServiceStatusType",(function(){return l})),n.d(t,"GetServiceStatus",(function(){return b}));var r,i,o=n(54),c=n(12),a=function(){return Object(o.b)({method:"get",url:"/api/v6/overview/DescribeAsset"},Object(c.g)("获取资产概览信息"))};!function(e){e.host="host",e.rasp="rasp",e.kube="kube"}(r||(r={})),function(e){e[e.critical=0]="critical",e[e.high=1]="high",e[e.medium=2]="medium",e[e.low=3]="low"}(i||(i={}));var l,u=function(){return Object(o.b)({method:"get",url:"/api/v6/overview/alarm"},Object(c.g)("获取安全告警统计信息"))},m=function(){return Object(o.b)({method:"get",url:"/api/v6/overview/agentRisk"},Object(c.g)("获取主机风险分布信息"))},s=function(){return Object(o.b)({method:"get",url:"/api/v6/overview/vulnRisk"},Object(c.g)("获取漏洞风险数据"))},v=function(){return Object(o.b)({method:"get",url:"/api/v6/overview/baselineRisk"},Object(c.g)("获取基线风险数据"))},d=function(){return Object(o.b)({method:"get",url:"/api/v6/overview/DescribeAgent"},Object(c.g)("获取Agent概览数据"))};!function(e){e.low="low",e.middle="middle",e.high="high",e.unavailable="unavailable"}(l||(l={}));var b=function(){return Object(o.b)({method:"get",url:"/api/v6/monitor/ServiceStatus"},Object(c.g)("获取后端服务状态数据"))}},426:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(115),c=n.n(o),a=n(1687),l=n(12),u=n(1422),m=n.n(u),s=c.a.bind(m.a);t.default=function(e){var t=e.value;return i.a.createElement("div",{className:s("container"),__source:{fileName:"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/overview/event-stream/event-steam-item/type-display/index.tsx",lineNumber:17,columnNumber:5}},t===a.EventflowEventType.host?Object(l.g)("主机"):t===a.EventflowEventType.kube?Object(l.g)("容器集群"):"RASP")}},462:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(55),c=n(780),a=n(800),l=n(115),u=n.n(l),m=n(1609),s=n(426),v=n(1687),d=n(1608),b=n(1479),f=n.n(b),p="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/overview/event-stream/event-steam-item/index.tsx",g=u.a.bind(f.a);t.default=function(e){var t=e.value,n=Object(o.g)();return i.a.createElement("div",{className:g("container"),__source:{fileName:p,lineNumber:23,columnNumber:5}},i.a.createElement(c.a,{justify:"space-between",className:g("top-box"),__source:{fileName:p,lineNumber:24,columnNumber:7}},i.a.createElement(c.a,{align:"center",__source:{fileName:p,lineNumber:25,columnNumber:9}},i.a.createElement(s.default,{value:null==t?void 0:t.event_type,__source:{fileName:p,lineNumber:26,columnNumber:11}}),i.a.createElement(a.a,{className:g("title"),maxWidth:250,onClick:function(){n.push("/".concat((null==t?void 0:t.event_type)===v.EventflowEventType.host?"":"".concat(null==t?void 0:t.event_type,"-"),"event-detail?eventId=").concat(null==t?void 0:t.event_id,"&breadcrumbLinkFrom=").concat(Object(m.b)()))},__source:{fileName:p,lineNumber:27,columnNumber:11}},null==t?void 0:t.event_title)),i.a.createElement("div",{className:g("time"),__source:{fileName:p,lineNumber:43,columnNumber:9}},Object(d.a)(null==t?void 0:t.event_time))),i.a.createElement(a.a,{className:g("content"),maxWidth:440,__source:{fileName:p,lineNumber:46,columnNumber:7}},null==t?void 0:t.event_content))}},525:function(e,t,n){"use strict";n.r(t);n(306);var r=n(601),i=n(10),o=n.n(i),c=n(51),a=n.n(c),l=n(50),u=n.n(l),m=n(0),s=n.n(m),v=n(115),d=n.n(v),b=n(1332),f=n(1319),p=n(596),g=n(462),h=n(54),O=n(12),N=n(74),j=n(166),_=n(1541),w=n.n(_),y="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/overview/event-stream/index.tsx";function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=d.a.bind(w.a);t.default=function(){var e=Object(m.useState)([]),t=u()(e,2),n=t[0],i=t[1],o=Object(m.useState)(),c=u()(o,2),l=c[0],v=c[1];return Object(m.useEffect)((function(){!function e(){var t=Object(N.a)(),n=new f.SSE("".concat(h.a,"/api/v6/overview/eventflow"),{headers:{Token:t},method:"GET"});v(n),n.addEventListener("open",(function(){i([])}),!1),n.addEventListener("message",(function(e){var t=JSON.parse(e.data)||{};i((function(e){var n=[x({id:Object(b.a)()},t)].concat(a()(e));return(null==n?void 0:n.length)>20?null==n?void 0:n.slice(0,5):n}))}),!1),n.addEventListener("error",(function(t){var r,i;401===(null==t||null===(r=t.source)||void 0===r||null===(i=r.xhr)||void 0===i?void 0:i.status)?(n.close(),Object(N.b)(),Object(N.e)(),location.href="".concat(j.a,"/user/login?url=").concat(encodeURIComponent(location.href))):(n.close(),e())}),!1),n.stream()}()}),[]),Object(m.useEffect)((function(){return function(){l&&(l.listeners={},null==l||l.close())}}),[l]),s.a.createElement(p.a,{containerStyle:{minHeight:272,maxHeight:272,marginBottom:16,flexShrink:0},contentStyle:{display:"flex",paddingTop:20},title:Object(O.g)("实时事件流"),isCard:!0,__source:{fileName:y,lineNumber:87,columnNumber:5}},s.a.createElement("div",{className:k("event-box"),__source:{fileName:y,lineNumber:98,columnNumber:7}},null!=n&&n.length?null==n?void 0:n.map((function(e){return s.a.createElement(g.default,{value:e,key:null==e?void 0:e.id,__source:{fileName:y,lineNumber:100,columnNumber:31}})})):s.a.createElement("div",{className:k("empty-box"),__source:{fileName:y,lineNumber:102,columnNumber:11}},s.a.createElement(r.a,{__source:{fileName:y,lineNumber:103,columnNumber:13}}))))}}}]);