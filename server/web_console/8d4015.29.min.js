(window.webpackJsonp=window.webpackJsonp||[]).push([[29,182,312,491,494],{1502:function(e,t,r){e.exports={title:"title-b02516a0d2"}},1559:function(e,t,r){e.exports={title:"title-9042563b91"}},1748:function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return s}));var n=r(12),l=function(e,t){if(e)if(e.length<4&&t(Object(n.g)("用户名不少于4个字符")),e.length>16)t(Object(n.g)("用户名不超过16个字符"));else{/^[\u4e00-\u9fa5a-zA-Z0-9]+$/.test(e)||t(Object(n.g)("仅支持英文、汉字、数字，不支持特殊字符"))}},a=function(e,t){if(e)if(e.length<8)t(Object(n.g)("密码不少于8个字符"));else if(e.length>30)t(Object(n.g)("密码不超过30个字符"));else{/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()+=-\?;,./{}|\":<>\[\]\\\' ~_`]).{8,30}/.test(e)||t(Object(n.g)("必须包含大小英文字母、数字和特殊字符"))}},o=r(50),i=r.n(o),u=r(1505),c=r.n(u),s=function(e,t){try{if(null!=e&&e.includes("/")){var r=e.split("/"),l=i()(r,2),a=l[0],o=l[1];if(!a)return void t(Object(n.g)("非法IP地址段"));if(!c.a.isV4Format(a)&&!c.a.isV6Format(a))return void t(Object(n.g)("非法IP地址段"));if(Number(o)<16||Number(o)>32)return void t(Object(n.g)("子网掩码仅支持16-32"))}else if(!c.a.isV4Format(e)&&!c.a.isV6Format(e))return void t(Object(n.g)("非法IP地址"))}catch(e){t(Object(n.g)("非法IP地址"))}}},440:function(e,t,r){"use strict";r.r(t),r.d(t,"IpInputTag",(function(){return V}));r(197);var n,l=r(117),a=(r(807),r(605)),o=r(10),i=r.n(o),u=r(28),c=r.n(u),s=r(50),m=r.n(s),b=(r(889),r(618)),f=(r(806),r(199)),d=r(603),p=r.n(d),_=r(16),g=r.n(_),N=r(0),O=r.n(N),v=r(115),j=r.n(v),E=r(604),h=r(864),w=r(613),x=r(56),y=r(12),U=r(1748),I=r(1502),C=r.n(I),F="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/user/add-user-modal/index.tsx";function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var L=j.a.bind(C.a),R=Object(E.a)(f.a)(n||(n=p()(["\n  /* .arco-form-label-item > label {\n    padding-left: 4px !important;\n  } */\n"]))),k={username:"",password:"",re_password:"",role:x.UserLevelEnum.normal_user,authority:Object(h.getRolePermission)(x.UserLevelEnum.normal_user),explanation:"",ip_limit:!1,source_ip_list:[]},V=function(e){var t=e.value,r=void 0===t?[]:t,n=e.onChange,l=f.a.useFormContext().form;return O.a.createElement(b.a,{placeholder:Object(y.g)("输入ip后，按enter键，继续输入"),style:{width:"100%"},value:r,onChange:n,validate:function(e){var t;return Object(U.a)(e,(function(e){t=e})),t?(l.setFields({source_ip_list:{error:{message:t}}}),!1):null==r||!r.includes(e)||(l.setFields({source_ip_list:{error:{message:Object(y.g)("ip名称重复")}}}),!1)},__source:{fileName:F,lineNumber:38,columnNumber:5}})};t.default=function(e){var t=e.visible,r=e.handleConfirm,n=e.handleCancel,o=f.a.useForm(),u=m()(o,1)[0],s=f.a.useWatch("re_password",u),b=Object(N.useState)(!1),d=m()(b,2),p=d[0],_=d[1];Object(N.useEffect)((function(){s&&!p&&_(!0),t||_(!1)}),[s,t]);var v=function(){var e=c()(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.validate();case 2:return t=e.sent,n=t.role,e.next=6,Object(x.CreateUser)({data:{username:t.username,password:t.password,level:n,ip_limit:null==t?void 0:t.ip_limit,source_ip_list:(null==t?void 0:t.source_ip_list)||[]}});case 6:r();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=Object(N.useState)(!1),E=m()(j,2),I=E[0],C=E[1];return Object(N.useEffect)((function(){t||(u.setFieldsValue(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},k)),C(!1))}),[t]),O.a.createElement(w.b,{visible:t,onCancel:n,onOk:v,style:{width:y.d?600:520},title:Object(y.g)("新增用户"),mountOnEnter:!1,unmountOnExit:!0,__source:{fileName:F,lineNumber:125,columnNumber:5}},O.a.createElement(f.a.Provider,{onFormValuesChange:function(e,t){Object.keys(t).includes("password")&&t.password&&p&&u.validate(["re_password"]).catch((function(){}))},__source:{fileName:F,lineNumber:134,columnNumber:7}},O.a.createElement(R,{initialValues:k,form:u,colon:!1,labelAlign:"right",labelCol:{span:y.d?6:4},wrapperCol:{span:y.d?18:20},__source:{fileName:F,lineNumber:145,columnNumber:9}},O.a.createElement(a.a,{style:{margin:"-24px -20px 20px -20px",width:"calc(100% + 40px)",padding:"8px 20px"},showIcon:!1,type:"info",content:Object(y.g)("采用 SHA256 存储用户信息"),__source:{fileName:F,lineNumber:157,columnNumber:11}}),O.a.createElement("div",{className:L("title"),__source:{fileName:F,lineNumber:167,columnNumber:11}},Object(y.g)("用户信息")),O.a.createElement(f.a.Item,{field:"username",label:Object(y.g)("用户名"),rules:[{required:!0,message:Object(y.g)("请输入用户名")},{validator:U.b}],__source:{fileName:F,lineNumber:168,columnNumber:11}},O.a.createElement(l.a,{autoComplete:"off",placeholder:Object(y.g)("用户名支持中英文和数字，不少于4个字符，最多16个字符"),__source:{fileName:F,lineNumber:181,columnNumber:13}})),O.a.createElement(f.a.Item,{field:"password",label:Object(y.g)("密码"),rules:[{required:!0,message:Object(y.g)("请输入密码")},{validator:U.c}],__source:{fileName:F,lineNumber:186,columnNumber:11}},O.a.createElement(l.a.Password,{autoComplete:"new-password",placeholder:Object(y.g)("密码长度8到30个字符，必须包含大小写字母，数字和特殊字符"),__source:{fileName:F,lineNumber:199,columnNumber:13}})),O.a.createElement(f.a.Item,{field:"re_password",label:Object(y.g)("确认密码"),rules:[{required:!0,message:Object(y.g)("请确认密码")},{validator:function(e,t){e!==u.getFieldValue("password")&&t(Object(y.g)("二次确认密码不正确"))}}],__source:{fileName:F,lineNumber:204,columnNumber:11}},O.a.createElement(l.a.Password,{autoComplete:"off",placeholder:Object(y.g)("请再次输入密码"),__source:{fileName:F,lineNumber:222,columnNumber:13}})),O.a.createElement("div",{className:L("title"),style:{marginTop:10},__source:{fileName:F,lineNumber:225,columnNumber:11}},Object(y.g)("用户权限")),O.a.createElement(f.a.Item,{field:"role",label:Object(y.g)("用户角色"),__source:{fileName:F,lineNumber:228,columnNumber:11}},h.getRoleOptionList),O.a.createElement(f.a.Item,{shouldUpdate:!0,field:"explanation",label:Object(y.g)("说明"),__source:{fileName:F,lineNumber:231,columnNumber:11}},(function(e){return O.a.createElement("div",{__source:{fileName:F,lineNumber:233,columnNumber:22}},Object(y.g)(Object(h.getRoleDesc)(e.role)))})),O.a.createElement(f.a.Item,{shouldUpdate:!0,field:"authority",label:Object(y.g)("用户权限"),__source:{fileName:F,lineNumber:236,columnNumber:11}},(function(e){return O.a.createElement("div",{__source:{fileName:F,lineNumber:238,columnNumber:22}},Object(y.g)(Object(h.getRolePermission)(e.role)))})),I&&O.a.createElement(f.a.Item,{field:"source_ip_list",style:{marginTop:16,marginBottom:0},wrapperCol:{span:24},rules:[{required:!0,message:Object(y.g)("请输入 IP")},{validator:function(e,t){null==e||e.forEach((function(e){return Object(U.a)(e,t)}))}}],__source:{fileName:F,lineNumber:242,columnNumber:13}},O.a.createElement(V,{__source:{fileName:F,lineNumber:261,columnNumber:15}})))))}},488:function(e,t,r){"use strict";r.r(t);r(197);var n,l=r(117),a=(r(807),r(605)),o=r(28),i=r.n(o),u=r(50),c=r.n(u),s=(r(806),r(199)),m=r(603),b=r.n(m),f=r(16),d=r.n(f),p=r(0),_=r.n(p),g=r(115),N=r.n(g),O=r(604),v=r(613),j=r(440),E=r(864),h=r(56),w=r(12),x=r(1748),y=r(1559),U=r.n(y),I="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/user/edit-user-modal/index.tsx",C=N.a.bind(U.a),F=Object(O.a)(s.a)(n||(n=b()(["\n  /* .arco-form-label-item > label {\n    padding-left: 4px !important;\n  } */\n"]))),P={username:"",password:"",role:h.UserLevelEnum.normal_user,authority:Object(E.getRolePermission)(h.UserLevelEnum.normal_user),explanation:Object(E.getRoleDesc)(h.UserLevelEnum.normal_user),source_ip_list:[],ip_limit:!1};t.default=function(e){var t=e.visible,r=e.data,n=e.handleConfirm,o=e.handleCancel,u=s.a.useForm(),m=c()(u,1)[0];Object(p.useEffect)((function(){if(t){var e=null==r?void 0:r.level,n=Object(E.getRolePermission)(null==r?void 0:r.level),l=Object(E.getRoleDesc)(null==r?void 0:r.level);m.setFieldsValue({username:null==r?void 0:r.username,password:null==r?void 0:r.password,role:e,authority:n,explanation:l,ip_limit:null==r?void 0:r.ip_limit,source_ip_list:null==r?void 0:r.source_ip_list})}else m.setFieldsValue(P)}),[t,r]);var b=function(){var e=i()(d.a.mark((function e(){var t,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.validate();case 2:return t=e.sent,r=t.role,e.next=6,Object(h.UpdateUserPermission)({data:{username:null==t?void 0:t.username,level:r,ip_limit:null==t?void 0:t.ip_limit,source_ip_list:null==t?void 0:t.source_ip_list}});case 6:n();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return _.a.createElement(v.b,{visible:t,onCancel:o,onOk:b,style:{width:520},title:Object(w.g)("编辑用户"),mountOnEnter:!1,__source:{fileName:I,lineNumber:83,columnNumber:5}},_.a.createElement(F,{initialValues:P,form:m,colon:!1,labelAlign:"right",labelCol:{span:4},wrapperCol:{span:20},__source:{fileName:I,lineNumber:91,columnNumber:7}},_.a.createElement(a.a,{style:{margin:"-24px -20px 20px -20px",width:"calc(100% + 40px)",padding:"8px 20px"},showIcon:!1,type:"info",content:Object(w.g)("采用 SHA256 存储用户信息"),__source:{fileName:I,lineNumber:103,columnNumber:9}}),_.a.createElement("div",{className:C("title"),__source:{fileName:I,lineNumber:113,columnNumber:9}},Object(w.g)("用户信息")),_.a.createElement(s.a.Item,{field:"username",label:Object(w.g)("用户名"),rules:[{required:!0,message:Object(w.g)("请输入用户名")},{validator:x.b}],__source:{fileName:I,lineNumber:114,columnNumber:9}},_.a.createElement(l.a,{disabled:!0,placeholder:Object(w.g)("用户名支持中英文和数字，不少于4个字符，最多16个字符"),autoComplete:"off",__source:{fileName:I,lineNumber:127,columnNumber:11}})),_.a.createElement("div",{className:C("title"),__source:{fileName:I,lineNumber:134,columnNumber:9}},Object(w.g)("用户权限")),_.a.createElement(s.a.Item,{field:"role",label:Object(w.g)("用户角色"),__source:{fileName:I,lineNumber:135,columnNumber:9}},E.getRoleOptionList),_.a.createElement(s.a.Item,{shouldUpdate:!0,field:"explanation",label:Object(w.g)("说明"),__source:{fileName:I,lineNumber:138,columnNumber:9}},(function(e){return _.a.createElement("div",{__source:{fileName:I,lineNumber:140,columnNumber:20}},Object(w.g)(Object(E.getRoleDesc)(e.role)))})),_.a.createElement(s.a.Item,{shouldUpdate:!0,field:"authority",label:Object(w.g)("权限"),__source:{fileName:I,lineNumber:143,columnNumber:9}},(function(e){return _.a.createElement("div",{__source:{fileName:I,lineNumber:145,columnNumber:20}},Object(w.g)(Object(E.getRolePermission)(e.role)))})),_.a.createElement(s.a.Item,{shouldUpdate:!0,noStyle:!0,__source:{fileName:I,lineNumber:148,columnNumber:9}},(function(e){return e.ip_limit?_.a.createElement(s.a.Item,{field:"source_ip_list",style:{marginTop:16,marginBottom:0},wrapperCol:{span:24},rules:[{required:!0,message:Object(w.g)("请输入 IP")},{validator:function(e,t){null==e||e.forEach((function(e){return Object(x.a)(e,t)}))}}],__source:{fileName:I,lineNumber:152,columnNumber:17}},_.a.createElement(j.IpInputTag,{__source:{fileName:I,lineNumber:171,columnNumber:19}})):null}))))}},864:function(e,t,r){"use strict";r.r(t),r.d(t,"authRoleMap",(function(){return m})),r.d(t,"getRoleOptionList",(function(){return f})),r.d(t,"getRoleDesc",(function(){return d})),r.d(t,"getRoleName",(function(){return p})),r.d(t,"getRolePermission",(function(){return _})),r.d(t,"getRoleFontColor",(function(){return g})),r.d(t,"getRoleBackgroundColor",(function(){return N})),r.d(t,"getRoleFilterList",(function(){return O}));r(600);var n=r(198),l=r(0),a=r.n(l),o=r(56),i=r(12),u="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/user/user-utils/roles.tsx",c={name_info:Object(i.g)("管理员"),font_color_info:"#FF7D00",background_color_info:"#FFF7E8",permission_info:Object(i.g)("读写"),desc_info:Object(i.g)("拥有全部功能的读写权限"),role_str:"admin"},s=(Object(i.g)("高级用户"),Object(i.g)("读写"),Object(i.g)("拥有全部功能的读写权限"),{name_info:Object(i.g)("普通用户"),font_color_info:"#000000",background_color_info:"#F2F3F8",permission_info:Object(i.g)("只读"),desc_info:Object(i.g)("拥有全部数据的只读权限"),role_str:"ordinaryUser"}),m=(Object(i.g)("高级运营"),Object(i.g)("读写"),Object(i.g)("拥有入侵检测和风险防范的读写权限"),Object(i.g)("告警数据运营"),Object(i.g)("读写"),Object(i.g)("入侵检测的读写权限"),Object(i.g)("风险数据运营"),Object(i.g)("读写"),Object(i.g)("拥有风险防范的读写权限"),new Map([[o.UserLevelEnum.admin,c],[o.UserLevelEnum.normal_user,s]])),b=function(e){switch(e){case o.UserLevelEnum.admin:return m.get(o.UserLevelEnum.admin);case o.UserLevelEnum.normal_user:return m.get(o.UserLevelEnum.normal_user);case o.UserLevelEnum.advance_user:return m.get(o.UserLevelEnum.advance_user);case o.UserLevelEnum.advance_om:return m.get(o.UserLevelEnum.advance_om);case o.UserLevelEnum.alarm_om:return m.get(o.UserLevelEnum.alarm_om);case o.UserLevelEnum.baseline_vul_om:return m.get(o.UserLevelEnum.baseline_vul_om)}},f=function(){var e=[];return m.forEach((function(t,r){e.push(a.a.createElement(n.a.Option,{value:r,key:r,__source:{fileName:u,lineNumber:100,columnNumber:7}},t.name_info))})),a.a.createElement(n.a,{__source:{fileName:u,lineNumber:105,columnNumber:10}},e)},d=function(e){var t=b(e);return t?t.desc_info:Object(i.g)("未知")},p=function(e){var t=b(e);return t?t.name_info:Object(i.g)("未知")},_=function(e){var t=b(e);return t?t.permission_info:Object(i.g)("未知")},g=function(e){var t=b(e);return t?t.font_color_info:"#000000"},N=function(e){var t=b(e);return t?t.background_color_info:"#EAECEE"},O=function(){var e=[];return m.forEach((function(t){e.push({label:Object(i.g)(t.name_info),text:Object(i.g)(t.name_info),value:t.role_str})})),e}}}]);