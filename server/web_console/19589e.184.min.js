(window.webpackJsonp=window.webpackJsonp||[]).push([[184,384],{1420:function(e,n,t){e.exports={iconButton:"iconButton-fa798e428c"}},1698:function(e,n,t){"use strict";t.r(n),t.d(n,"CompTypeEnum",(function(){return r})),t.d(n,"PlatformFamilyOptions",(function(){return u})),t.d(n,"MatchType",(function(){return l})),t.d(n,"MatchTypeOptions",(function(){return s})),t.d(n,"FieldType",(function(){return m})),t.d(n,"FieldTypeOptions",(function(){return p})),t.d(n,"ArchOptions",(function(){return b})),t.d(n,"DescribeComponentList",(function(){return f})),t.d(n,"DescribeComponent",(function(){return d})),t.d(n,"CreateComponent",(function(){return h})),t.d(n,"DescribeComponentVersionList",(function(){return O})),t.d(n,"PublishComponentVersion",(function(){return g})),t.d(n,"DescribeRecommendComponentVersion",(function(){return v})),t.d(n,"DescribePolicyList",(function(){return j})),t.d(n,"CreatePolicy",(function(){return _})),t.d(n,"DeletePolicy",(function(){return N})),t.d(n,"DescribeComponentCriteria",(function(){return y})),t.d(n,"DescribeComponentVersionCriteria",(function(){return C}));var r,a=t(50),o=t.n(a),c=t(54),i=t(12);!function(e){e.agent="agent",e.exec="exec",e.tar_gz="tar.gz"}(r||(r={}));var l,u=[{label:"RHEL",value:"rhel"},{label:"Debian",value:"debian"}];!function(e){e.IN="$in",e.Regex="$regex"}(l||(l={}));var m,s=[{label:Object(i.g)("包含于"),value:l.IN},{label:Object(i.g)("正则匹配"),value:l.Regex}];!function(e){e.AgentID="agent_id",e.Tag="tag",e.KernelVersion="kernel_version"}(m||(m={}));var p=[{label:Object(i.g)("AgentID"),value:m.AgentID},{label:Object(i.g)("标签"),value:m.Tag},{label:Object(i.g)("内核版本"),value:m.KernelVersion}],b=[{label:"x86-64",value:"x86_64"},{label:"AArch64",value:"aarch64"}],f=function(e){var n=e.params;return Object(c.b)({method:"post",url:"/api/v6/component/DescribeComponentList",params:n},Object(i.g)("获取组件列表"))},d=function(e){var n=e.params;return Object(c.b)({method:"get",url:"/api/v6/component/DescribeComponent",params:n},Object(i.g)("获取组件信息"))},h=function(e){var n=e.data;return Object(c.b)({method:"post",url:"/api/v6/component/CreateComponent",data:n},Object(i.g)("新建组件"),!0)},O=function(e){var n=e.params,t=e.data;return Object(c.b)({method:"post",url:"/api/v6/component/DescribeComponentVersionList",params:n,data:t},Object(i.g)("获取组件版本列表"))},g=function(e){var n,t=e.data,r={};return t&&(r["Content-Type"]="multipart/form-data",n=new FormData,Object.entries(t).forEach((function(e){var t=o()(e,2),r=t[0],a=t[1];n.append(r,a)}))),Object(c.b)({method:"post",url:"/api/v6/component/PublishComponentVersion",data:n,headers:r,timeout:12e4},Object(i.g)("发布组件版本"),!0)},v=function(e){var n=e.params;return Object(c.b)({method:"get",url:"/api/v6/component/DescribeRecommendComponentVersion",params:n},Object(i.g)("获取建议的组件版本"))},j=function(e){var n=e.params,t=e.data;return Object(c.b)({method:"post",url:"/api/v6/component/DescribePolicyList",params:n,data:t},Object(i.g)("获取策略列表"))},_=function(e){var n=e.data;return Object(c.b)({method:"post",url:"/api/v6/component/CreatePolicy",data:n},Object(i.g)("新建策略"))},N=function(e){var n=e.data;return Object(c.b)({method:"post",url:"/api/v6/component/DeletePolicy",data:n},Object(i.g)("删除策略"),!0,!0)},y=function(){return Object(c.b)({method:"get",url:"/api/v6/component/DescribeComponentCriteria"},Object(i.g)("获取组件类别"))},C=function(e){var n=e.params;return Object(c.b)({method:"get",url:"/api/v6/component/DescribeComponentVersionCriteria",params:n},Object(i.g)("获取组件版本列表"))}},422:function(e,n,t){"use strict";t.r(n);t(197);var r=t(117),a=t(10),o=t.n(a),c=t(28),i=t.n(c),l=t(50),u=t.n(l),m=(t(806),t(199)),s=(t(116),t(42)),p=t(1517),b=t(16),f=t.n(b),d=t(0),h=t.n(d),O=t(613),g=t(1698),v=t(12),j=t(1420),_=t.n(j),N="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/comp-detail/publish-modal/index.tsx";function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach((function(n){o()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var D=function(e){var n,t=Object(d.useRef)();return h.a.createElement("div",{__source:{fileName:N,lineNumber:27,columnNumber:5}},h.a.createElement("input",{ref:t,onChange:function(n){e.onChange(n.target.files[0])},type:"file",hidden:!0,__source:{fileName:N,lineNumber:28,columnNumber:7}}),e.value?h.a.createElement("div",{style:{width:300,whiteSpace:"nowrap",display:"flex",alignItems:"center"},__source:{fileName:N,lineNumber:37,columnNumber:9}},h.a.createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis"},__source:{fileName:N,lineNumber:45,columnNumber:11}},null===(n=e.value)||void 0===n?void 0:n.name),h.a.createElement("span",{className:_.a.iconButton,__source:{fileName:N,lineNumber:46,columnNumber:11}},h.a.createElement(p.a,{onClick:function(){t.current.value=null,e.onChange(null)},__source:{fileName:N,lineNumber:47,columnNumber:13}}))):h.a.createElement(s.a,{type:"primary",size:"small",onClick:function(){t.current.click()},__source:{fileName:N,lineNumber:56,columnNumber:9}},Object(v.g)("选择文件")))};n.default=function(e){var n=e.visible,t=e.data,a=e.handleConfirm,o=e.handleCancel,c=m.a.useForm(),l=u()(c,1)[0],s=function(){var e=i()(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.validate();case 2:return n=e.sent,e.next=5,Object(g.PublishComponentVersion)({data:C({component_id:t.id},n)});case 5:a();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){n&&t&&Object(g.DescribeRecommendComponentVersion)({params:{component_id:t.id}}).then((function(e){l.setFieldValue("version",e.data)})),n||l.resetFields()}),[n,t]),h.a.createElement(O.b,{visible:n,onCancel:o,onOk:s,style:{width:600},title:Object(v.g)("发布版本"),__source:{fileName:N,lineNumber:149,columnNumber:5}},h.a.createElement(m.a,{form:l,colon:!1,labelAlign:"right",labelCol:v.d?{span:6}:{span:4},wrapperCol:v.d?{span:18}:{span:20},__source:{fileName:N,lineNumber:156,columnNumber:7}},h.a.createElement(m.a.Item,{field:"version",label:Object(v.g)("版本号"),rules:[{validator:function(e,n){return new RegExp("^(([1-9]\\d{0,3}|0)\\.){3}([1-9]\\d{0,3}|0)$").test(e)?n():n(Object(v.g)("不符合版本号格式"))}},{required:!0,message:Object(v.g)("版本号为必填项")}],__source:{fileName:N,lineNumber:163,columnNumber:9}},h.a.createElement(r.a,{style:{width:"300px"},__source:{fileName:N,lineNumber:178,columnNumber:11}})),h.a.createElement(m.a.Item,{label:Object(v.g)("上传文件"),__source:{fileName:N,lineNumber:180,columnNumber:9}},t&&function(e){var n=[];return e.arch_requirements.length>0&&e.platform_family_requirements.length>0?e.platform_family_requirements.forEach((function(t){e.arch_requirements.forEach((function(e){n.push({label:"".concat(Object(v.g)("{placeholder0} {placeholder2}文件",{placeholder0:g.PlatformFamilyOptions.find((function(e){return e.value===t})).label,placeholder2:g.ArchOptions.find((function(n){return n.value===e})).label})),field:"".concat(t,"_").concat(e)})}))})):e.arch_requirements.length>0?e.arch_requirements.forEach((function(e){n.push({label:"".concat(Object(v.g)("{placeholder0}文件",{placeholder0:g.ArchOptions.find((function(n){return n.value===e})).label})),field:"".concat(e)})})):e.platform_family_requirements.length>0?e.platform_family_requirements.forEach((function(e){n.push({label:"".concat(Object(v.g)("{placeholder0}文件",{placeholder0:g.PlatformFamilyOptions.find((function(n){return n.value===e})).label})),field:"".concat(e)})})):n.push({label:"",field:"default"}),n.map((function(e){return h.a.createElement(m.a.Item,{label:e.label,field:e.field,required:!0,labelAlign:"left",rules:[{validator:function(e,n){return e?n():n(Object(v.g)("必须上传文件"))}}],labelCol:{span:8},__source:{fileName:N,lineNumber:109,columnNumber:7}},h.a.createElement(D,{__source:{fileName:N,lineNumber:126,columnNumber:9}}))}))}(t))))}}}]);