(window.webpackJsonp=window.webpackJsonp||[]).push([[205,322],{1506:function(e,t,r){e.exports={"util-container":"util-container-f6db651940"}},536:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),i=(r(224),r(97)),u=(r(803),r(227)),l=(r(299),r(165)),c=r(28),o=r.n(c),s=r(50),m=r.n(s),_=r(16),d=r.n(_),b=r(0),v=r.n(b),f=r(55),g=r(599),N=r(794),p=r(115),x=r.n(p),h=r(70),O=r.n(h),j=r(1767),w=r(596),E=r(1616),k=r(1757),y=r(1637),I=r(1613),P=r(1615),S=r(1628),C=r(1768),z=r(1621),F=r(54),A=r(12),D=function(e){var t=e.params,r=e.data;return Object(F.b)({method:"post",url:"/api/v6/kube/abnormal/list",params:t,data:r},Object(A.g)("获取异常行为列表"))},L=function(e){var t=e.abnormal_id;return Object(F.b)({method:"get",url:"/api/v6/kube/abnormal/raw",params:{abnormal_id:t}},Object(A.g)("获取异常行为原始数据"))},U=r(1625),Y=r(1624),M=r(1506),V=r.n(M),B="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/abnormal-list/index.tsx",G=x.a.bind(V.a),H={critical:"#E63F3F",high:"#846BCE",medium:"#FEC746",low:"#468DFF"},J={critical:Object(A.g)("紧急"),high:Object(A.g)("高风险"),medium:Object(A.g)("中风险"),low:Object(A.g)("低风险")};t.default=function(e){var t=e.clusterId,r=e.visible,a=void 0===r||r,c=Object(f.g)(),s=!!t,_=[{text:Object(A.g)("集群名称"),value:"cluster_name"},{text:Object(A.g)("所在区域"),value:"region"},{text:Object(A.g)("来源IP"),value:"source_ip"},{text:"UserAgent",value:"user_agent"},{text:Object(A.g)("用户"),value:"user"},{text:Object(A.g)("用户组"),value:"user_group"},{text:Object(A.g)("资源类型"),value:"resource_kind"},{text:Object(A.g)("资源命名空间"),value:"resource_namespace"},{text:Object(A.g)("资源名"),value:"resource_name"}],p={cluster_name:void 0,region:void 0,risk_name_list:{value:[],adapter:Y.b.stringArray,isFilter:!0},risk_level_list:{value:[],adapter:Y.b.stringArray,isFilter:!0},source_ip:void 0,user_agent:void 0,user:void 0,user_group:void 0,source_psm:void 0,create_time_start:{value:void 0,adapter:Number},create_time_end:{value:void 0,adapter:Number},action_list:{value:[],adapter:Y.b.stringArray,isFilter:!0},resource_kind:void 0,resource_namespace:void 0,resource_name:void 0,cluster_id:void 0,current:{value:1,adapter:Y.b.number,isCurrent:!0},pageSize:{value:10,adapter:Y.b.number,isPageSize:!0}},x=Object(Y.a)({initParams:p,namespace:s?U.a.abnormalList:void 0,autoMergeUrlParams:!0,visible:a}),h=x.globalUrlParams,F=x.setGlobalUrlParams,M=x.tablePropsProxy,V=Object(b.useState)(!1),T=m()(V,2),W=T[0],K=T[1],R=Object(b.useState)(null),X=m()(R,2),q=X[0],Q=X[1],Z=function(){var e=o()(d.a.mark((function e(t){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),e.next=3,L({abnormal_id:t});case 3:r=e.sent,a=r.data,Q(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=Object(g.a)(function(){var e=o()(d.a.mark((function e(r){var a,n,i,u,l,c,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.current,n=void 0===a?1:a,i=r.pageSize,u=void 0===i?10:i,e.next=3,D({params:{page_size:u,page:n},data:{condition:{cluster_name:h.cluster_name,region:h.region,risk_name_list:h.risk_name_list,risk_level_list:h.risk_level_list,source_ip:h.source_ip,user_agent:h.user_agent,user:h.user,user_group:h.user_group,source_psm:h.source_psm,create_time_start:h.create_time_start?h.create_time_start:void 0,create_time_end:h.create_time_end?Number(h.create_time_end):void 0,action_list:h.action_list,resource_kind:h.resource_kind,resource_namespace:h.resource_namespace,resource_name:h.resource_name,cluster_id:t}}});case 3:return l=e.sent,c=l.data,o=l.page_info,e.abrupt("return",{list:c,total:(null==o?void 0:o.total)||0});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{debounceInterval:300,onChangeDeps:[Object(N.a)(h)],defaultParams:[{pageSize:+h.pageSize,current:+h.current}]}),ee=$.tableProps,te=$.refresh,re=[{title:Object(A.g)("集群"),dataIndex:"cluster_name",headerCellStyle:{paddingLeft:4},fixed:"left",width:120,render:function(e,t){return e?v.a.createElement("div",{__source:{fileName:B,lineNumber:188,columnNumber:11}},v.a.createElement(l.a,{onClick:function(){c.push("/kube-detail?name=".concat(e,"&clusterId=").concat(t.cluster_id))},__source:{fileName:B,lineNumber:189,columnNumber:13}},e),v.a.createElement("div",{style:{color:"#4E5969",paddingLeft:4},__source:{fileName:B,lineNumber:196,columnNumber:13}},t.region)):v.a.createElement("div",{style:{marginLeft:4},__source:{fileName:B,lineNumber:199,columnNumber:11}},"-")}},{title:Object(A.g)("风险名称"),dataIndex:"risk_name_list",fixed:"left",filters:[{text:Object(A.g)("认证失败"),value:"authentication_failed"},{text:Object(A.g)("授权失败"),value:"authorization_failed"},{text:Object(A.g)("凭据滥用"),value:"credential_abuse"},{text:Object(A.g)("命令执行"),value:"command_execution"},{text:Object(A.g)("修改DNS配置"),value:"modify_coredns_config"}],filteredValue:h.risk_name_list,width:104,render:function(e,t){return t.risk_name?v.a.createElement(E.a,{content:t.risk_name,__source:{fileName:B,lineNumber:216,columnNumber:26}}):"-"}},{title:Object(A.g)("级别"),dataIndex:"risk_level_list",width:92,render:function(e,t){return t.risk_level?v.a.createElement(P.a,{color:H[t.risk_level],content:J[t.risk_level],__source:{fileName:B,lineNumber:224,columnNumber:11}}):"-"},filters:[{text:Object(A.g)("紧急"),value:"critical"},{text:Object(A.g)("高风险"),value:"high"},{text:Object(A.g)("中风险"),value:"medium"},{text:Object(A.g)("低风险"),value:"low"}],filteredValue:h.risk_level_list},{title:Object(A.g)("来源"),dataIndex:"source_info.ip",width:136,render:function(e,t){var r,a;return v.a.createElement("div",{__source:{fileName:B,lineNumber:256,columnNumber:9}},v.a.createElement(E.a,{content:null!==(r=t.source_info.ip)&&void 0!==r?r:"-",__source:{fileName:B,lineNumber:257,columnNumber:11}}),v.a.createElement(E.a,{content:null!==(a=t.source_info.psm)&&void 0!==a?a:"-",style:{color:"#4E5969"},__source:{fileName:B,lineNumber:258,columnNumber:11}}))}},{title:"UserAgent",dataIndex:"user_agent",width:120,render:function(e){return e?v.a.createElement(E.a,{content:e,__source:{fileName:B,lineNumber:266,columnNumber:39}}):"-"}},{title:Object(A.g)("用户"),dataIndex:"user",width:123,render:function(e){return e?v.a.createElement(E.a,{content:e,__source:{fileName:B,lineNumber:272,columnNumber:39}}):"-"}},{title:Object(A.g)("用户组"),dataIndex:"user_group_list",width:165,render:function(e,t){return t.user_group_list?v.a.createElement(k.a,{items:t.user_group_list,width:90,__source:{fileName:B,lineNumber:279,columnNumber:32}}):"-"}},{title:Object(A.g)("动作"),dataIndex:"action_list",filters:[{text:"create",value:"create"},{text:"get",value:"get"},{text:"list",value:"list"},{text:"watch",value:"watch"},{text:"update",value:"update"},{text:"patch",value:"patch"},{text:"delete",value:"delete"},{text:"deletecollection",value:"deletecollection"},{text:"other",value:"other"}],filteredValue:h.action_list,width:80,render:function(e,t){return t.action?v.a.createElement(E.a,{content:t.action,__source:{fileName:B,lineNumber:298,columnNumber:23}}):"-"}},{title:Object(A.g)("资源类型/命名空间"),dataIndex:"resource_info",width:144,render:function(e,t){var r,a;return v.a.createElement(u.a.Paragraph,{style:{margin:0},ellipsis:{rows:2,showTooltip:!0},__source:{fileName:B,lineNumber:305,columnNumber:9}},"".concat(null!==(r=t.resource_info.kind)&&void 0!==r?r:" - ","/").concat(null!==(a=t.resource_info.namespace)&&void 0!==a?a:" - "))}},{title:Object(A.g)("资源名称"),dataIndex:"resource_info.name",width:180,render:function(e){return v.a.createElement(u.a.Paragraph,{style:{margin:0},ellipsis:{rows:2,showTooltip:!0},__source:{fileName:B,lineNumber:315,columnNumber:9}},null!=e?e:"-")}},{title:Object(A.g)("发生时间"),dataIndex:"create_time",width:110,render:function(e){if(e){var t=O.a.unix(e).format("YYYY-MM-DD HH:mm:ss").split(" ");return v.a.createElement("div",{__source:{fileName:B,lineNumber:331,columnNumber:13}},v.a.createElement("div",{__source:{fileName:B,lineNumber:332,columnNumber:15}},t[0]),v.a.createElement("div",{__source:{fileName:B,lineNumber:333,columnNumber:15}},t[1]))}return"-"}},{title:Object(A.g)("操作"),dataIndex:"operation",fixed:"right",width:74,render:function(e,t){return v.a.createElement(l.a,{onClick:function(){return Z(t.abnormal_id)},__source:{fileName:B,lineNumber:346,columnNumber:9}},Object(A.g)("数据"))}}],ae=Object(C.b)({columns:s?re.slice(1):re,whiteList:[Object(A.g)("集群"),Object(A.g)("风险名称"),Object(A.g)("操作")]}),ne=ae.selectedColumns,ie=ae.scrollX,ue=ae.selectorProps;return v.a.createElement(w.a,{title:Object(A.g)("异常行为"),containerStyle:s?{minWidth:"1200px",maxWidth:"85%",flexGrow:1}:{},__source:{fileName:B,lineNumber:357,columnNumber:5}},v.a.createElement("div",{className:G("util-container"),__source:{fileName:B,lineNumber:361,columnNumber:7}},v.a.createElement("div",{__source:{fileName:B,lineNumber:362,columnNumber:9}},v.a.createElement(y.a,{placeholder:[Object(A.g)("行为发生时间"),Object(A.g)("行为发生时间")],value:h.create_time_start&&h.create_time_end?[O.a.unix(Number(h.create_time_start)),O.a.unix(Number(h.create_time_end))]:void 0,onChange:function(e,t){F({create_time_start:t?String(t[0].unix()).slice(0,10):void 0,create_time_end:t?String(t[1].unix()).slice(0,10):void 0})},__source:{fileName:B,lineNumber:363,columnNumber:11}})),v.a.createElement("div",{__source:{fileName:B,lineNumber:381,columnNumber:9}},v.a.createElement(I.a,{onRefresh:o()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te();case 2:i.a.success(Object(A.g)("刷新成功"));case 3:case"end":return e.stop()}}),e)}))),__source:{fileName:B,lineNumber:382,columnNumber:11}}),v.a.createElement(C.a,n()({},ue,{__source:{fileName:B,lineNumber:388,columnNumber:11}})))),v.a.createElement(z.a,{options:_,style:{marginBottom:16},value:h,onChange:function(e,t){var r={};_.forEach((function(e){var a=e.value;return r[a]=t[a]})),F(r)},__source:{fileName:B,lineNumber:391,columnNumber:7}}),v.a.createElement(S.a,n()({columns:ne,scroll:{x:ie},rowKey:"abnormal_id"},M(ee),{__source:{fileName:B,lineNumber:401,columnNumber:7}})),v.a.createElement(j.a,{visible:W,value:q,onOk:function(){K(!1)},onCancel:function(){K(!1)},title:Object(A.g)("原始数据"),__source:{fileName:B,lineNumber:407,columnNumber:7}}))}}}]);