(window.webpackJsonp=window.webpackJsonp||[]).push([[182,312,491],{1502:function(e,r,t){e.exports={title:"title-b02516a0d2"}},1748:function(e,r,t){"use strict";t.d(r,"b",(function(){return a})),t.d(r,"c",(function(){return o})),t.d(r,"a",(function(){return s}));var n=t(12),a=function(e,r){if(e)if(e.length<4&&r(Object(n.g)("用户名不少于4个字符")),e.length>16)r(Object(n.g)("用户名不超过16个字符"));else{/^[\u4e00-\u9fa5a-zA-Z0-9]+$/.test(e)||r(Object(n.g)("仅支持英文、汉字、数字，不支持特殊字符"))}},o=function(e,r){if(e)if(e.length<8)r(Object(n.g)("密码不少于8个字符"));else if(e.length>30)r(Object(n.g)("密码不超过30个字符"));else{/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()+=-\?;,./{}|\":<>\[\]\\\' ~_`]).{8,30}/.test(e)||r(Object(n.g)("必须包含大小英文字母、数字和特殊字符"))}},l=t(50),u=t.n(l),c=t(1505),i=t.n(c),s=function(e,r){try{if(null!=e&&e.includes("/")){var t=e.split("/"),a=u()(t,2),o=a[0],l=a[1];if(!o)return void r(Object(n.g)("非法IP地址段"));if(!i.a.isV4Format(o)&&!i.a.isV6Format(o))return void r(Object(n.g)("非法IP地址段"));if(Number(l)<16||Number(l)>32)return void r(Object(n.g)("子网掩码仅支持16-32"))}else if(!i.a.isV4Format(e)&&!i.a.isV6Format(e))return void r(Object(n.g)("非法IP地址"))}catch(e){r(Object(n.g)("非法IP地址"))}}},440:function(e,r,t){"use strict";t.r(r),t.d(r,"IpInputTag",(function(){return V}));t(197);var n,a=t(117),o=(t(807),t(605)),l=t(10),u=t.n(l),c=t(28),i=t.n(c),s=t(50),m=t.n(s),b=(t(889),t(618)),f=(t(806),t(199)),d=t(603),g=t.n(d),_=t(16),p=t.n(_),O=t(0),j=t.n(O),v=t(115),N=t.n(v),E=t(604),h=t(864),w=t(613),y=t(56),F=t(12),x=t(1748),U=t(1502),L=t.n(U),P="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/user/add-user-modal/index.tsx";function C(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}var I=N.a.bind(L.a),R=Object(E.a)(f.a)(n||(n=g()(["\n  /* .arco-form-label-item > label {\n    padding-left: 4px !important;\n  } */\n"]))),k={username:"",password:"",re_password:"",role:y.UserLevelEnum.normal_user,authority:Object(h.getRolePermission)(y.UserLevelEnum.normal_user),explanation:"",ip_limit:!1,source_ip_list:[]},V=function(e){var r=e.value,t=void 0===r?[]:r,n=e.onChange,a=f.a.useFormContext().form;return j.a.createElement(b.a,{placeholder:Object(F.g)("输入ip后，按enter键，继续输入"),style:{width:"100%"},value:t,onChange:n,validate:function(e){var r;return Object(x.a)(e,(function(e){r=e})),r?(a.setFields({source_ip_list:{error:{message:r}}}),!1):null==t||!t.includes(e)||(a.setFields({source_ip_list:{error:{message:Object(F.g)("ip名称重复")}}}),!1)},__source:{fileName:P,lineNumber:38,columnNumber:5}})};r.default=function(e){var r=e.visible,t=e.handleConfirm,n=e.handleCancel,l=f.a.useForm(),c=m()(l,1)[0],s=f.a.useWatch("re_password",c),b=Object(O.useState)(!1),d=m()(b,2),g=d[0],_=d[1];Object(O.useEffect)((function(){s&&!g&&_(!0),r||_(!1)}),[s,r]);var v=function(){var e=i()(p.a.mark((function e(){var r,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.validate();case 2:return r=e.sent,n=r.role,e.next=6,Object(y.CreateUser)({data:{username:r.username,password:r.password,level:n,ip_limit:null==r?void 0:r.ip_limit,source_ip_list:(null==r?void 0:r.source_ip_list)||[]}});case 6:t();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=Object(O.useState)(!1),E=m()(N,2),U=E[0],L=E[1];return Object(O.useEffect)((function(){r||(c.setFieldsValue(function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?C(Object(t),!0).forEach((function(r){u()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},k)),L(!1))}),[r]),j.a.createElement(w.b,{visible:r,onCancel:n,onOk:v,style:{width:F.d?600:520},title:Object(F.g)("新增用户"),mountOnEnter:!1,unmountOnExit:!0,__source:{fileName:P,lineNumber:125,columnNumber:5}},j.a.createElement(f.a.Provider,{onFormValuesChange:function(e,r){Object.keys(r).includes("password")&&r.password&&g&&c.validate(["re_password"]).catch((function(){}))},__source:{fileName:P,lineNumber:134,columnNumber:7}},j.a.createElement(R,{initialValues:k,form:c,colon:!1,labelAlign:"right",labelCol:{span:F.d?6:4},wrapperCol:{span:F.d?18:20},__source:{fileName:P,lineNumber:145,columnNumber:9}},j.a.createElement(o.a,{style:{margin:"-24px -20px 20px -20px",width:"calc(100% + 40px)",padding:"8px 20px"},showIcon:!1,type:"info",content:Object(F.g)("采用 SHA256 存储用户信息"),__source:{fileName:P,lineNumber:157,columnNumber:11}}),j.a.createElement("div",{className:I("title"),__source:{fileName:P,lineNumber:167,columnNumber:11}},Object(F.g)("用户信息")),j.a.createElement(f.a.Item,{field:"username",label:Object(F.g)("用户名"),rules:[{required:!0,message:Object(F.g)("请输入用户名")},{validator:x.b}],__source:{fileName:P,lineNumber:168,columnNumber:11}},j.a.createElement(a.a,{autoComplete:"off",placeholder:Object(F.g)("用户名支持中英文和数字，不少于4个字符，最多16个字符"),__source:{fileName:P,lineNumber:181,columnNumber:13}})),j.a.createElement(f.a.Item,{field:"password",label:Object(F.g)("密码"),rules:[{required:!0,message:Object(F.g)("请输入密码")},{validator:x.c}],__source:{fileName:P,lineNumber:186,columnNumber:11}},j.a.createElement(a.a.Password,{autoComplete:"new-password",placeholder:Object(F.g)("密码长度8到30个字符，必须包含大小写字母，数字和特殊字符"),__source:{fileName:P,lineNumber:199,columnNumber:13}})),j.a.createElement(f.a.Item,{field:"re_password",label:Object(F.g)("确认密码"),rules:[{required:!0,message:Object(F.g)("请确认密码")},{validator:function(e,r){e!==c.getFieldValue("password")&&r(Object(F.g)("二次确认密码不正确"))}}],__source:{fileName:P,lineNumber:204,columnNumber:11}},j.a.createElement(a.a.Password,{autoComplete:"off",placeholder:Object(F.g)("请再次输入密码"),__source:{fileName:P,lineNumber:222,columnNumber:13}})),j.a.createElement("div",{className:I("title"),style:{marginTop:10},__source:{fileName:P,lineNumber:225,columnNumber:11}},Object(F.g)("用户权限")),j.a.createElement(f.a.Item,{field:"role",label:Object(F.g)("用户角色"),__source:{fileName:P,lineNumber:228,columnNumber:11}},h.getRoleOptionList),j.a.createElement(f.a.Item,{shouldUpdate:!0,field:"explanation",label:Object(F.g)("说明"),__source:{fileName:P,lineNumber:231,columnNumber:11}},(function(e){return j.a.createElement("div",{__source:{fileName:P,lineNumber:233,columnNumber:22}},Object(F.g)(Object(h.getRoleDesc)(e.role)))})),j.a.createElement(f.a.Item,{shouldUpdate:!0,field:"authority",label:Object(F.g)("用户权限"),__source:{fileName:P,lineNumber:236,columnNumber:11}},(function(e){return j.a.createElement("div",{__source:{fileName:P,lineNumber:238,columnNumber:22}},Object(F.g)(Object(h.getRolePermission)(e.role)))})),U&&j.a.createElement(f.a.Item,{field:"source_ip_list",style:{marginTop:16,marginBottom:0},wrapperCol:{span:24},rules:[{required:!0,message:Object(F.g)("请输入 IP")},{validator:function(e,r){null==e||e.forEach((function(e){return Object(x.a)(e,r)}))}}],__source:{fileName:P,lineNumber:242,columnNumber:13}},j.a.createElement(V,{__source:{fileName:P,lineNumber:261,columnNumber:15}})))))}},864:function(e,r,t){"use strict";t.r(r),t.d(r,"authRoleMap",(function(){return m})),t.d(r,"getRoleOptionList",(function(){return f})),t.d(r,"getRoleDesc",(function(){return d})),t.d(r,"getRoleName",(function(){return g})),t.d(r,"getRolePermission",(function(){return _})),t.d(r,"getRoleFontColor",(function(){return p})),t.d(r,"getRoleBackgroundColor",(function(){return O})),t.d(r,"getRoleFilterList",(function(){return j}));t(600);var n=t(198),a=t(0),o=t.n(a),l=t(56),u=t(12),c="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/user/user-utils/roles.tsx",i={name_info:Object(u.g)("管理员"),font_color_info:"#FF7D00",background_color_info:"#FFF7E8",permission_info:Object(u.g)("读写"),desc_info:Object(u.g)("拥有全部功能的读写权限"),role_str:"admin"},s=(Object(u.g)("高级用户"),Object(u.g)("读写"),Object(u.g)("拥有全部功能的读写权限"),{name_info:Object(u.g)("普通用户"),font_color_info:"#000000",background_color_info:"#F2F3F8",permission_info:Object(u.g)("只读"),desc_info:Object(u.g)("拥有全部数据的只读权限"),role_str:"ordinaryUser"}),m=(Object(u.g)("高级运营"),Object(u.g)("读写"),Object(u.g)("拥有入侵检测和风险防范的读写权限"),Object(u.g)("告警数据运营"),Object(u.g)("读写"),Object(u.g)("入侵检测的读写权限"),Object(u.g)("风险数据运营"),Object(u.g)("读写"),Object(u.g)("拥有风险防范的读写权限"),new Map([[l.UserLevelEnum.admin,i],[l.UserLevelEnum.normal_user,s]])),b=function(e){switch(e){case l.UserLevelEnum.admin:return m.get(l.UserLevelEnum.admin);case l.UserLevelEnum.normal_user:return m.get(l.UserLevelEnum.normal_user);case l.UserLevelEnum.advance_user:return m.get(l.UserLevelEnum.advance_user);case l.UserLevelEnum.advance_om:return m.get(l.UserLevelEnum.advance_om);case l.UserLevelEnum.alarm_om:return m.get(l.UserLevelEnum.alarm_om);case l.UserLevelEnum.baseline_vul_om:return m.get(l.UserLevelEnum.baseline_vul_om)}},f=function(){var e=[];return m.forEach((function(r,t){e.push(o.a.createElement(n.a.Option,{value:t,key:t,__source:{fileName:c,lineNumber:100,columnNumber:7}},r.name_info))})),o.a.createElement(n.a,{__source:{fileName:c,lineNumber:105,columnNumber:10}},e)},d=function(e){var r=b(e);return r?r.desc_info:Object(u.g)("未知")},g=function(e){var r=b(e);return r?r.name_info:Object(u.g)("未知")},_=function(e){var r=b(e);return r?r.permission_info:Object(u.g)("未知")},p=function(e){var r=b(e);return r?r.font_color_info:"#000000"},O=function(e){var r=b(e);return r?r.background_color_info:"#EAECEE"},j=function(){var e=[];return m.forEach((function(r){e.push({label:Object(u.g)(r.name_info),text:Object(u.g)(r.name_info),value:r.role_str})})),e}}}]);