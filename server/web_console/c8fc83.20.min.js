(window.webpackJsonp=window.webpackJsonp||[]).push([[20,167,168,262,289,290,299,317,318,337,338,339],{1321:function(e,t,n){e.exports={"event-summary-anchor-col":"event-summary-anchor-col-7b0083fb74","event-summary-box":"event-summary-box-7df4b49ff7","event-summary-collapse":"event-summary-collapse-e951ab513e","alarm-info-container":"alarm-info-container-9d0307b991","alarm-info-desc":"alarm-info-desc-04538ab582","endpoint-steps":"endpoint-steps-af436e4f87",info:"info-13c8d4f619",desc:"desc-0934cbf38a","alarm-desc-name":"alarm-desc-name-f3caf9b7cf",name:"name-fde55135df",status:"status-13c4c826db","info-grid":"info-grid-49b19e279c","attribution-logic-item":"attribution-logic-item-0941f2e9d7","attribution-logic-container":"attribution-logic-container-f6654bcce1"}},1335:function(e,t,n){e.exports={table:"table-f1996a667e",highlight:"highlight-ffa89aa8c2","modal-title":"modal-title-44470acc36",left:"left-4ce358f5c7",version:"version-2cc4c99a7d",count:"count-f6e109805d"}},1336:function(e,t,n){e.exports={table:"table-9424a0b755",highlight:"highlight-05013ec8ee"}},1609:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));n(299);var l=n(165),a=n(0),r=n.n(a),i=n(55),c=n(164),o=n.n(c),u=n(147),m=n(166);function s(){return(m.a?location.pathname.slice(null===m.a||void 0===m.a?void 0:m.a.length):location.pathname)+encodeURIComponent(location.search)}t.a=function(e){var t=e.defaultLink,n=e.defaultTitle,c=Object(i.g)();var m=Object(a.useMemo)((function(){return function(){var e,t=null===(e=o.a.parse(location.search))||void 0===e?void 0:e.breadcrumbLinkFrom;if(t){var n,l,a,r,i="";if(null!=t&&null!==(n=t.indexOf)&&void 0!==n&&n.call(t,"?"))i=null==t||null===(a=t.split)||void 0===a||null===(r=a.call(t,"?"))||void 0===r?void 0:r[0];else i=t;var c=null===u.c||void 0===u.c||null===(l=u.c.find)||void 0===l?void 0:l.call(u.c,(function(e){return(null==e?void 0:e.path)===i&&(null==e?void 0:e.name)}));if(c)return{link:t,title:null==c?void 0:c.name}}return{link:void 0,title:void 0}}()}),[]),s=m.link,b=m.title;return r.a.createElement(l.a,{style:{color:"#4E5969"},onClick:function(){c.push(s||t)},__source:{fileName:"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/breadcrumb-link.tsx",lineNumber:63,columnNumber:5}},b||n)}},1615:function(e,t,n){"use strict";var l=n(0),a=n.n(l),r=n(115),i=n.n(r),c=n(1623),o=n.n(c),u="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/components/common/status-display-component/index.tsx",m=i.a.bind(o.a);t.a=function(e){var t=e.color,n=e.content;return a.a.createElement("div",{className:m("container"),__source:{fileName:u,lineNumber:15,columnNumber:5}},a.a.createElement("div",{className:m("circle"),style:{background:t},__source:{fileName:u,lineNumber:16,columnNumber:7}}),a.a.createElement("div",{className:m("content"),__source:{fileName:u,lineNumber:17,columnNumber:7}},n))}},1623:function(e,t,n){e.exports={container:"container-5be80ecb83",content:"content-c7c988a72c",circle:"circle-f32e1ad32c"}},322:function(e,t,n){"use strict";n.r(t);var l=n(0),a=n.n(l),r=n(1615),i=n(1629),c=n(12);t.default=function(e){var t=function(e){switch(e){case i.EventLevel.critical:return{content:Object(c.g)("紧急"),color:"#E63F3F"};case i.EventLevel.high:return{content:Object(c.g)("高风险"),color:"#846BCE"};case i.EventLevel.medium:return{content:Object(c.g)("中风险"),color:"#FEC746"};case i.EventLevel.low:return{content:Object(c.g)("低风险"),color:"#468DFF"};default:return{content:"",color:"transparent"}}}(e.level);return a.a.createElement(r.a,{content:null==t?void 0:t.content,color:null==t?void 0:t.color,__source:{fileName:"/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/event-level/index.tsx",lineNumber:24,columnNumber:10}})}},331:function(e,t,n){"use strict";n.r(t);var l=n(1),a=n.n(l),r=(n(162),n(67)),i=(n(304),n(118)),c=n(50),o=n.n(c),u=n(2),m=n.n(u),s=n(0),b=n.n(s),d=n(115),N=n.n(d),f=n(613),_=n(816),v=n(12),p=n(1335),g=n.n(p),T="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/event-summary-drawer/event-summary-content/attack-graph/attack-graph-modal/index.tsx",h=["attackIds","visible"],E=N.a.bind(g.a);t.default=function(e){var t=e.attackIds,n=e.visible,l=m()(e,h),c=Object(s.useState)(!0),u=o()(c,2),d=u[0],N=u[1],p=new Set(t),g=Object(_.default)({showAllAttackIds:d,attackIds:t}),y=g.th,O=g.rows;return b.a.createElement(f.b,a()({visible:n,style:{width:"calc(100% - 70px)"},footer:null,title:b.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",paddingRight:30},className:E("modal-title"),__source:{fileName:T,lineNumber:29,columnNumber:9}},b.a.createElement("div",{className:E("left"),__source:{fileName:T,lineNumber:33,columnNumber:11}},Object(v.g)("ATT&CK 攻击图谱"),b.a.createElement("div",{className:E("version"),__source:{fileName:T,lineNumber:35,columnNumber:13}},"v11.3"),b.a.createElement("span",{className:E("count"),__source:{fileName:T,lineNumber:36,columnNumber:13}},Object(v.g)("检测到 {count} 条技术指标",{count:(null==p?void 0:p.size)||0}))),b.a.createElement("span",{style:{fontWeight:400},__source:{fileName:T,lineNumber:40,columnNumber:11}},b.a.createElement(i.a,{checked:d,onChange:N,__source:{fileName:T,lineNumber:41,columnNumber:13}},Object(v.g)("显示全部技术点")))),getPopupContainer:function(){return document.querySelector("#root")}},l,{__source:{fileName:T,lineNumber:24,columnNumber:5}}),b.a.createElement("table",{cellSpacing:"0",width:"100%",className:E("table"),__source:{fileName:T,lineNumber:50,columnNumber:7}},b.a.createElement("tbody",{__source:{fileName:T,lineNumber:51,columnNumber:9}},b.a.createElement("tr",{style:{position:"sticky",top:0},__source:{fileName:T,lineNumber:52,columnNumber:11}},y.map((function(e){return b.a.createElement("th",{key:e._name,__source:{fileName:T,lineNumber:54,columnNumber:15}},"".concat(e.name,"(").concat(e.count,")"))}))),O.map((function(e,t){return b.a.createElement("tr",{key:t,__source:{fileName:T,lineNumber:58,columnNumber:13}},e.map((function(e,t){return b.a.createElement(r.a,{content:e.description,disabled:!e.active,key:t,__source:{fileName:T,lineNumber:60,columnNumber:17}},b.a.createElement("td",{className:E(e.active&&"highlight"),__source:{fileName:T,lineNumber:61,columnNumber:19}},e.name))})))})))))}},332:function(e,t,n){"use strict";n.r(t);var l=n(51),a=n.n(l),r=n(0),i=n.n(r),c=n(115),o=n.n(c),u=n(163),m=n(816),s=n(1336),b=n.n(s),d="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/event-summary-drawer/event-summary-content/attack-graph/attack-graph-placeholder/index.tsx",N=o.a.bind(b.a);t.default=function(e){var t,n=e.attackIds,l=Object(m.default)({showAllAttackIds:!1,attackIds:n}),r=l.th,c=l.rows;return i.a.createElement("table",{cellSpacing:"0",width:"100%",className:N("table"),__source:{fileName:d,lineNumber:15,columnNumber:5}},i.a.createElement("tbody",{__source:{fileName:d,lineNumber:16,columnNumber:7}},i.a.createElement("tr",{__source:{fileName:d,lineNumber:17,columnNumber:9}},r.map((function(e){return i.a.createElement("th",{key:e._name,__source:{fileName:d,lineNumber:19,columnNumber:13}},"".concat(Object(u.upperCase)(e._name)[0]))}))),null===(t=[].concat(a()(c),a()(new Array(3).fill(new Array(r.length).fill({})))))||void 0===t?void 0:t.slice(0,3).map((function(e,t){return i.a.createElement("tr",{key:t,__source:{fileName:d,lineNumber:25,columnNumber:13}},null==e?void 0:e.map((function(e,t){return i.a.createElement("td",{key:t,className:N(e.active&&"highlight"),__source:{fileName:d,lineNumber:27,columnNumber:17}})})))}))))}},335:function(e,t,n){"use strict";n.r(t);n(1311);var l,a=n(1313),r=n(80),i=(n(595),n(298)),c=(n(1322),n(1323)),o=n(51),u=n.n(o),m=n(50),s=n.n(m),b=n(0),d=n.n(b),N=n(115),f=n.n(N),_=n(822),v=n(823),p=n(824),g=n(825),T=n(12),h=n(1321),E=n.n(h),y="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/event-summary-drawer/event-summary-content/index.tsx",O=f.a.bind(E.a);!function(e){e.info="info",e["attribution-logic"]="attribution-logic",e["att-ck"]="att-ck",e["alarm-info"]="alarm-info"}(l||(l={}));var k={background:"#FFFFFF"};t.default=function(e){var t=e.value,n=e.eventId,o=e.queryEventAlarmInfo,m=e.hostNumBtn,N=e.eventTags,f=e.detailUrlPrefix,h=Object(b.useState)([l.info,l["attribution-logic"],l["att-ck"],l["alarm-info"]]),E=s()(h,2),j=E[0],x=E[1],w=[{key:"anchor-info",href:"".concat(l.info),title:Object(T.g)("事件信息")},{key:"anchor-attribution-logic",href:"".concat(l["attribution-logic"]),title:Object(T.g)("归因逻辑")},{key:"anchor-att-ck",href:"".concat(l["att-ck"]),title:Object(T.g)("ATT & CK 分布图")},{key:"anchor-alarm-info",href:"".concat(l["alarm-info"]),title:Object(T.g)("告警信息")}],z=Object(b.useRef)();return d.a.createElement(i.a.Row,{className:O("event-summary-box"),__source:{fileName:y,lineNumber:80,columnNumber:5}},d.a.createElement(i.a.Col,{span:6,className:O("event-summary-anchor-col"),__source:{fileName:y,lineNumber:81,columnNumber:7}},d.a.createElement(c.a,{affix:!1,hash:!1,onSelect:function(e){var t=[].concat(u()(j),[e.slice(1)]);x(Array.from(new Set(t)))},className:O("event-summary-anchor"),scrollContainer:null==z?void 0:z.current,style:{width:"100%"},__source:{fileName:y,lineNumber:82,columnNumber:9}},w.map((function(e){return d.a.createElement(c.a.Link,{key:e.key,href:"#".concat(e.href),title:e.title,__source:{fileName:y,lineNumber:91,columnNumber:13}})})))),d.a.createElement(i.a.Col,{span:18,className:O("event-summary-collapse"),ref:z,__source:{fileName:y,lineNumber:95,columnNumber:7}},d.a.createElement(a.a,{bordered:!1,expandIcon:d.a.createElement(r.a,{__source:{fileName:y,lineNumber:98,columnNumber:23}}),activeKey:j,onChange:function(e,t){x(t)},__source:{fileName:y,lineNumber:96,columnNumber:9}},d.a.createElement("div",{id:l.info,__source:{fileName:y,lineNumber:102,columnNumber:11}}),d.a.createElement(a.a.Item,{name:l.info,key:l.info,header:Object(T.g)("事件信息"),contentStyle:k,__source:{fileName:y,lineNumber:103,columnNumber:11}},d.a.createElement(g.default,{value:t,hostNumBtn:m,eventTags:N,__source:{fileName:y,lineNumber:109,columnNumber:13}})),d.a.createElement("div",{id:l["attribution-logic"],__source:{fileName:y,lineNumber:111,columnNumber:11}}),d.a.createElement(a.a.Item,{name:l["attribution-logic"],key:l["attribution-logic"],header:Object(T.g)("归因逻辑"),contentStyle:k,__source:{fileName:y,lineNumber:112,columnNumber:11}},d.a.createElement(p.default,{value:t,__source:{fileName:y,lineNumber:118,columnNumber:13}})),d.a.createElement("div",{id:l["att-ck"],__source:{fileName:y,lineNumber:120,columnNumber:11}}),d.a.createElement(a.a.Item,{name:l["att-ck"],key:l["att-ck"],header:Object(T.g)("ATT & CK 分布图"),contentStyle:k,__source:{fileName:y,lineNumber:121,columnNumber:11}},d.a.createElement(v.default,{value:t,__source:{fileName:y,lineNumber:127,columnNumber:13}})),d.a.createElement("div",{id:l["alarm-info"],__source:{fileName:y,lineNumber:129,columnNumber:11}}),d.a.createElement(a.a.Item,{name:l["alarm-info"],key:l["alarm-info"],header:Object(T.g)("告警信息"),contentStyle:k,__source:{fileName:y,lineNumber:130,columnNumber:11}},d.a.createElement(_.default,{eventId:n,queryEventAlarmInfo:o,detailUrlPrefix:f,__source:{fileName:y,lineNumber:136,columnNumber:13}})))))}},808:function(e,t,n){"use strict";n.r(t),n.d(t,"getAlarmDetailUrl",(function(){return r}));var l=n(1609),a=n(166),r=function(e,t,n){return"".concat(a.a,"/").concat(t,"?agent_id=").concat(null==e?void 0:e.agent_id,"&alarm_id=").concat(null==e?void 0:e.alarm_id,"&trace_id=").concat(null==e?void 0:e.trace_id,"&alarm_type=").concat(null==e?void 0:e.type,"&data_type=").concat(null==e?void 0:e.data_type,"&cluster_id=").concat(null==e?void 0:e.cluster_id,"&breadcrumbLinkFrom=").concat(Object(l.b)(),"&request_data=").concat(encodeURIComponent(JSON.stringify(n)))}},816:function(e,t,n){"use strict";n.r(t);var l=n(12),a=n(820),r=n(818),i=n(819);t.default=function(e){var t=e.showAllAttackIds,n=void 0===t||t,c=e.attackIds,o=new Set(void 0===c?[]:c),u=Object.keys(i).map((function(e){var t,n;return{_name:e,name:l.d?i[e].en:i[e].zh,count:null===(t=r[e])||void 0===t||null===(n=t.filter((function(e){return o.has(e)})))||void 0===n?void 0:n.length}})),m=[];return u.forEach((function(e,t){var i,c;null==r||null===(i=r[e._name])||void 0===i||null===(c=i.filter((function(e){return!!n||o.has(e)})))||void 0===c||c.forEach((function(e,n){m[n]||(m[n]=new Array(u.length).fill({})),m[n][t]={name:l.d?a[e].Name:a[e]["姓名"],description:l.d?a[e].Description:a[e]["描述"],active:o.has(e)}}))})),{th:u,rows:m}}},817:function(e,t,n){"use strict";n.r(t),n.d(t,"getDisplayEventDeal",(function(){return v}));var l,a=n(0),r=n.n(a),i=n(1629),c=n(12);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}var u,m=function(e){return r.a.createElement("svg",o({width:12,height:12,fill:"none"},e),l||(l=r.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 0a6 6 0 100 12A6 6 0 106 0zm.55 5.379a.736.736 0 00-.737-.736H5.62c-.3 0-.542.243-.542.542v.167c0 .207.168.375.376.375v2.185H5.18a.542.542 0 100 1.084h1.648a.542.542 0 000-1.084H6.55V5.379zm-.122-1.833A.546.546 0 005.882 3H5.85a.546.546 0 000 1.091h.033a.546.546 0 00.546-.545z",fill:"#1664FF"})))};function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}var b,d=function(e){return r.a.createElement("svg",s({width:12,height:12,fill:"none"},e),u||(u=r.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 6A6 6 0 100 6a6 6 0 0012 0zM8.094 4.053l.328.275a.428.428 0 01.053.604L5.858 8.049l-.255.306A.429.429 0 015 8.411l-.007-.006-.615-.533-.03-.024-1.06-.92a.429.429 0 01-.043-.604l.005-.006.288-.32a.429.429 0 01.598-.038l1.043.898L7.49 4.105a.429.429 0 01.604-.052z",fill:"#00AA2A"})))};function N(){return(N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}var f=function(e){return r.a.createElement("svg",N({width:12,height:12,fill:"none"},e),b||(b=r.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 6A6 6 0 100 6a6 6 0 0012 0zM8.279 4.159l-.424-.424a.343.343 0 00-.485 0L6.005 5.098 4.642 3.735a.343.343 0 00-.485 0l-.424.424a.343.343 0 000 .485l1.363 1.364L3.733 7.37a.343.343 0 000 .485l.424.424a.343.343 0 00.485 0l1.363-1.364L7.37 8.281a.343.343 0 00.485 0l.424-.424a.343.343 0 000-.485L6.915 6.008l1.364-1.364a.343.343 0 000-.485z",fill:"#E63F3F"})))},_="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/util.tsx";function v(e){switch(e){case i.EventStatus.deal:return r.a.createElement("span",{style:{display:"inline-flex",alignItems:"center"},__source:{fileName:_,lineNumber:13,columnNumber:9}},r.a.createElement(d,{style:{flexShrink:0},__source:{fileName:_,lineNumber:14,columnNumber:11}}),r.a.createElement("span",{style:{marginLeft:"4px"},__source:{fileName:_,lineNumber:15,columnNumber:11}},Object(c.g)("已处理")));case i.EventStatus.falsePositive:return r.a.createElement("span",{style:{display:"inline-flex",alignItems:"center"},__source:{fileName:_,lineNumber:21,columnNumber:9}},r.a.createElement(d,{style:{flexShrink:0},__source:{fileName:_,lineNumber:22,columnNumber:11}}),r.a.createElement("span",{style:{marginLeft:"4px"},__source:{fileName:_,lineNumber:23,columnNumber:11}},Object(c.g)("已处理")));case i.EventStatus.toConfirm:return r.a.createElement("span",{style:{display:"inline-flex",alignItems:"center"},__source:{fileName:_,lineNumber:28,columnNumber:9}},r.a.createElement(m,{style:{flexShrink:0},__source:{fileName:_,lineNumber:29,columnNumber:11}}),r.a.createElement("span",{style:{marginLeft:"4px"},__source:{fileName:_,lineNumber:30,columnNumber:11}},Object(c.g)("待确认")));case i.EventStatus.notdeal:return r.a.createElement("span",{style:{display:"inline-flex",alignItems:"center"},__source:{fileName:_,lineNumber:35,columnNumber:9}},r.a.createElement(f,{style:{flexShrink:0},__source:{fileName:_,lineNumber:36,columnNumber:11}}),r.a.createElement("span",{style:{marginLeft:"4px"},__source:{fileName:_,lineNumber:37,columnNumber:11}},Object(c.g)("未处理")));default:return"-"}}},818:function(e){e.exports=JSON.parse('{"execution":["T1047","T1129","T1053","T1106","T1610","T1059","T1609","T1204","T1072","T1559","T1203","T1569"],"collection":["T1113","T1557","T1602","T1123","T1114","T1025","T1119","T1115","T1530","T1005","T1560","T1185","T1125","T1074","T1039","T1056","T1213"],"persistence":["T1037","T1543","T1133","T1547","T1137","T1053","T1176","T1205","T1525","T1542","T1554","T1098","T1574","T1078","T1546","T1197","T1505","T1136","T1556"],"privilege-escalation":["T1037","T1543","T1547","T1053","T1055","T1611","T1548","T1574","T1078","T1068","T1546","T1134","T1484"],"credential-access":["T1557","T1003","T1539","T1040","T1558","T1555","T1552","T1528","T1606","T1621","T1212","T1110","T1187","T1056","T1111","T1556"],"discovery":["T1033","T1613","T1069","T1615","T1007","T1040","T1135","T1120","T1082","T1010","T1580","T1217","T1016","T1087","T1482","T1083","T1049","T1497","T1619","T1057","T1201","T1012","T1614","T1526","T1018","T1046","T1518","T1538","T1622","T1124"],"resource-development":["T1583","T1584","T1586","T1608","T1585","T1588","T1587"],"reconnaissance":["T1592","T1594","T1589","T1596","T1595","T1591","T1590","T1593","T1597","T1598"],"defense-evasion":["T1006","T1014","T1578","T1600","T1564","T1202","T1140","T1562","T1036","T1055","T1205","T1218","T1620","T1550","T1207","T1610","T1112","T1535","T1222","T1548","T1070","T1647","T1542","T1612","T1497","T1480","T1601","T1574","T1078","T1027","T1599","T1553","T1197","T1221","T1134","T1622","T1484","T1220","T1556","T1216","T1211","T1127"],"initial-access":["T1133","T1091","T1195","T1190","T1199","T1566","T1078","T1200","T1189"],"impact":["T1561","T1489","T1491","T1565","T1531","T1486","T1499","T1496","T1485","T1498","T1495","T1490","T1529"],"lateral-movement":["T1080","T1091","T1550","T1021","T1563","T1072","T1210","T1534","T1570"],"command-and-control":["T1071","T1219","T1205","T1572","T1092","T1090","T1568","T1102","T1104","T1001","T1571","T1573","T1095","T1132","T1105","T1008"],"exfiltration":["T1567","T1029","T1011","T1020","T1041","T1048","T1030","T1537","T1052"]}')},819:function(e){e.exports=JSON.parse('{"reconnaissance":{"en":"Reconnaissance","zh":"侦察"},"resource-development":{"en":"Resource Development","zh":"资源准备"},"initial-access":{"en":"Initial Access","zh":"初始访问"},"execution":{"en":"Execution","zh":"执行"},"persistence":{"en":"Persistence","zh":"持久化"},"privilege-escalation":{"en":"Privilege Escalation","zh":"权限提升"},"defense-evasion":{"en":"Defense Evasion","zh":"防御规避"},"credential-access":{"en":"Credential Access","zh":"凭证访问"},"discovery":{"en":"Discovery","zh":"信息发现"},"lateral-movement":{"en":"Lateral Movement","zh":"横向移动"},"collection":{"en":"Collection","zh":"收集数据"},"command-and-control":{"en":"Command and Control","zh":"命令与控制"},"exfiltration":{"en":"Exfiltration","zh":"数据渗出"},"impact":{"en":"Impact","zh":"影响"}}')},822:function(e,t,n){"use strict";n.r(t);n(1296);var l=n(1297),a=(n(225),n(127)),r=(n(306),n(601)),i=(n(197),n(117)),c=n(28),o=n.n(c),u=n(50),m=n.n(u),s=n(16),b=n.n(s),d=n(0),N=n.n(d),f=n(1602),_=n(115),v=n.n(_),p=n(808),g=n(1608),T=n(12),h=n(1321),E=n.n(h),y=n(322),O="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/event-summary-drawer/event-summary-content/alarm-info.tsx",k=v.a.bind(E.a);t.default=function(e){var t=e.eventId,n=e.queryEventAlarmInfo,c=e.detailUrlPrefix,u=Object(d.useState)(""),s=m()(u,2),_=s[0],v=s[1],h=Object(d.useRef)(),E=Object(f.a)(function(){var e=o()(b.a.mark((function e(l){var a,r,i,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.offset,e.next=3,null==n?void 0:n({data:{event_id:t,alarm_simple_desc:_},params:{page:a/10+1,page_size:10}});case 3:return r=e.sent,i=r.data,c=r.page_info,e.abrupt("return",{total:null==c?void 0:c.total,list:(null==i?void 0:i.alarm_info_list)||[]});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{refreshDeps:[t,_],ready:!!t,auto:!0,debounceInterval:300}),j=E.data,x=E.loading,w=E.loadMore,z=E.noMore,I=null==j?void 0:j.list;return N.a.createElement("div",{__source:{fileName:O,lineNumber:59,columnNumber:5}},N.a.createElement(i.a.Search,{placeholder:Object(T.g)("请搜索告警信息"),value:_,onChange:function(e){v(e)},__source:{fileName:O,lineNumber:60,columnNumber:7}}),N.a.createElement("div",{className:k("alarm-info-container"),ref:h,onScroll:function(){var e=h.current,t=e.scrollTop,n=e.scrollHeight,l=e.clientHeight;x||z||t+l+10>n&&w()},__source:{fileName:O,lineNumber:67,columnNumber:7}},I&&0===(null==I?void 0:I.length)&&z&&!x&&N.a.createElement(r.a,{__source:{fileName:O,lineNumber:80,columnNumber:84}}),N.a.createElement(l.a,{type:"dot",current:0,direction:"vertical",className:k("endpoint-steps"),__source:{fileName:O,lineNumber:81,columnNumber:9}},null==I?void 0:I.map((function(e){return N.a.createElement(l.a.Step,{key:null==e?void 0:e.alarm_id,title:N.a.createElement(a.a,{size:12,style:{lineHeight:"20px",fontSize:12},__source:{fileName:O,lineNumber:86,columnNumber:17}},N.a.createElement(y.default,{level:null==e?void 0:e.level,__source:{fileName:O,lineNumber:87,columnNumber:19}}),N.a.createElement("span",{style:{color:"#4E5969"},__source:{fileName:O,lineNumber:88,columnNumber:19}},Object(g.a)(null==e?void 0:e.alarm_time))),description:N.a.createElement("a",{className:k("alarm-info-desc"),href:Object(p.getAlarmDetailUrl)({alarm_id:e.alarm_id,agent_id:e.agent_id,type:e.alarm_typ,trace_id:e.trace_id,data_type:e.data_type},c,{}),target:"_blank",rel:"noreferrer",__source:{fileName:O,lineNumber:92,columnNumber:17}},e.alarm_simple_desc),__source:{fileName:O,lineNumber:83,columnNumber:13}})}))),(null==I?void 0:I.length)>0&&z&&!x&&N.a.createElement("div",{style:{color:"#86909C",textAlign:"center"},__source:{fileName:O,lineNumber:115,columnNumber:11}}," - ",Object(T.g)("暂无更多")," - ")))}},823:function(e,t,n){"use strict";n.r(t);var l=n(50),a=n.n(l),r=n(0),i=n.n(r),c=n(594),o=n(331),u=n(332),m=n(12),s="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/event-summary-drawer/event-summary-content/att-ck.tsx";t.default=function(e){var t,n,l,b,d,N,f=e.value,_=Object(r.useState)(!1),v=a()(_,2),p=v[0],g=v[1];return i.a.createElement("div",{__source:{fileName:s,lineNumber:13,columnNumber:5}},null!=f&&null!==(t=f.info)&&void 0!==t&&null!==(n=t.att_ck_id_list)&&void 0!==n&&n.length?i.a.createElement(c.a,{onClick:function(){g(!0)},style:{marginBottom:12,marginLeft:-8},__source:{fileName:s,lineNumber:15,columnNumber:9}},Object(m.g)("检测到 {count} 条技术指标",{count:(null==f||null===(l=f.info)||void 0===l||null===(b=l.att_ck_id_list)||void 0===b?void 0:b.length)||0})):i.a.createElement("div",{style:{marginBottom:12},__source:{fileName:s,lineNumber:24,columnNumber:9}},Object(m.g)("检测到 0 条技术指标")),i.a.createElement(u.default,{attackIds:(null==f||null===(d=f.info)||void 0===d?void 0:d.att_ck_id_list)||[],__source:{fileName:s,lineNumber:26,columnNumber:7}}),i.a.createElement(o.default,{attackIds:(null==f||null===(N=f.info)||void 0===N?void 0:N.att_ck_id_list)||[],visible:p,onCancel:function(){g(!1)},__source:{fileName:s,lineNumber:27,columnNumber:7}}))}},824:function(e,t,n){"use strict";n.r(t);n(595);var l=n(298),a=n(0),r=n.n(a),i=n(115),c=n.n(i),o=n(12),u=n(1321),m=n.n(u),s="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/event-summary-drawer/event-summary-content/attribution-logic.tsx",b=c.a.bind(m.a),d=l.a.Row,N=l.a.Col;t.default=function(e){var t,n,l,a,i,c,u,m,f,_,v,p,g,T,h,E,y,O,k,j,x,w,z,I,S,C,A,F,L,B,P,D,R,U,M,H,q,J,K,G,W,V,Q,X,Y,Z,$,ee,te,ne,le,ae,re=e.value;return r.a.createElement("div",{className:b("attribution-logic-container"),__source:{fileName:s,lineNumber:17,columnNumber:5}},(null==re||null===(t=re.attribution_logic)||void 0===t||null===(n=t.ip)||void 0===n?void 0:n.length)>0&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:19,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:20,columnNumber:11}},Object(o.g)("IP归因")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:21,columnNumber:11}},(null==re||null===(l=re.attribution_logic)||void 0===l||null===(a=l.ip)||void 0===a?void 0:a.map((function(e,t){return r.a.createElement("div",{className:b("attribution-logic-item"),key:t,__source:{fileName:s,lineNumber:23,columnNumber:15}},e)})))||"-")),(null==re||null===(i=re.attribution_logic)||void 0===i||null===(c=i.sid)||void 0===c?void 0:c.length)>0&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:31,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:32,columnNumber:11}},Object(o.g)("SID归因")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:33,columnNumber:11}},(null==re||null===(u=re.attribution_logic)||void 0===u||null===(m=u.sid)||void 0===m?void 0:m.map((function(e,t){return r.a.createElement("div",{className:b("attribution-logic-item"),key:t,__source:{fileName:s,lineNumber:35,columnNumber:15}},e)})))||"-")),(null==re||null===(f=re.attribution_logic)||void 0===f||null===(_=f.file)||void 0===_?void 0:_.length)>0&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:43,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:44,columnNumber:11}},Object(o.g)("文件归因")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:45,columnNumber:11}},(null==re||null===(v=re.attribution_logic)||void 0===v||null===(p=v.file)||void 0===p?void 0:p.map((function(e,t){return r.a.createElement("div",{className:b("attribution-logic-item"),key:t,__source:{fileName:s,lineNumber:47,columnNumber:15}},e)})))||"-")),(null==re||null===(g=re.attribution_logic)||void 0===g||null===(T=g.trace_hash)||void 0===T?void 0:T.length)>0&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:55,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:56,columnNumber:11}},Object(o.g)("哈希归因")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:57,columnNumber:11}},(null==re||null===(h=re.attribution_logic)||void 0===h||null===(E=h.trace_hash)||void 0===E?void 0:E.map((function(e,t){return r.a.createElement("div",{className:b("attribution-logic-item"),key:t,__source:{fileName:s,lineNumber:59,columnNumber:15}},e)})))||"-")),(null==re||null===(y=re.attribution_logic)||void 0===y||null===(O=y.kube)||void 0===O?void 0:O.source_ip)&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:67,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:68,columnNumber:11}},Object(o.g)("IP")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:69,columnNumber:11}},null!=re&&null!==(k=re.attribution_logic)&&void 0!==k&&null!==(j=k.kube)&&void 0!==j&&j.source_ip?r.a.createElement("div",{className:b("attribution-logic-item"),__source:{fileName:s,lineNumber:71,columnNumber:15}},null==re||null===(x=re.attribution_logic)||void 0===x||null===(w=x.kube)||void 0===w?void 0:w.source_ip):"-")),(null==re||null===(z=re.attribution_logic)||void 0===z||null===(I=z.kube)||void 0===I?void 0:I.user_agent)&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:81,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:82,columnNumber:11}},Object(o.g)("UA")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:83,columnNumber:11}},null!=re&&null!==(S=re.attribution_logic)&&void 0!==S&&null!==(C=S.kube)&&void 0!==C&&C.user_agent?r.a.createElement("div",{className:b("attribution-logic-item"),__source:{fileName:s,lineNumber:85,columnNumber:15}},null==re||null===(A=re.attribution_logic)||void 0===A||null===(F=A.kube)||void 0===F?void 0:F.user_agent):"-")),(null==re||null===(L=re.attribution_logic)||void 0===L||null===(B=L.kube)||void 0===B?void 0:B.user_name)&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:95,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:96,columnNumber:11}},Object(o.g)("User")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:97,columnNumber:11}},null!=re&&null!==(P=re.attribution_logic)&&void 0!==P&&null!==(D=P.kube)&&void 0!==D&&D.user_name?r.a.createElement("div",{className:b("attribution-logic-item"),__source:{fileName:s,lineNumber:99,columnNumber:15}},null==re||null===(R=re.attribution_logic)||void 0===R||null===(U=R.kube)||void 0===U?void 0:U.user_name):"-")),(null==re||null===(M=re.attribution_logic)||void 0===M||null===(H=M.kube)||void 0===H?void 0:H.user_groups)&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:109,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:110,columnNumber:11}},Object(o.g)("Groups")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:111,columnNumber:11}},null!=re&&null!==(q=re.attribution_logic)&&void 0!==q&&null!==(J=q.kube)&&void 0!==J&&J.user_groups?r.a.createElement("div",{className:b("attribution-logic-item"),__source:{fileName:s,lineNumber:113,columnNumber:15}},null==re||null===(K=re.attribution_logic)||void 0===K||null===(G=K.kube)||void 0===G?void 0:G.user_groups):"-")),(null==re||null===(W=re.attribution_logic)||void 0===W||null===(V=W.kube)||void 0===V?void 0:V.impersonated_user_name)&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:123,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:124,columnNumber:11}},Object(o.g)("ImpUser")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:125,columnNumber:11}},null!=re&&null!==(Q=re.attribution_logic)&&void 0!==Q&&null!==(X=Q.kube)&&void 0!==X&&X.impersonated_user_name?r.a.createElement("div",{className:b("attribution-logic-item"),__source:{fileName:s,lineNumber:127,columnNumber:15}},null==re||null===(Y=re.attribution_logic)||void 0===Y||null===(Z=Y.kube)||void 0===Z?void 0:Z.impersonated_user_name):"-")),(null==re||null===($=re.attribution_logic)||void 0===$||null===(ee=$.kube)||void 0===ee?void 0:ee.impersonated_user_groups)&&r.a.createElement(d,{style:{marginBottom:16},__source:{fileName:s,lineNumber:137,columnNumber:9}},r.a.createElement(N,{span:5,__source:{fileName:s,lineNumber:138,columnNumber:11}},Object(o.g)("ImpGroups")),r.a.createElement(N,{span:19,className:b("desc"),__source:{fileName:s,lineNumber:139,columnNumber:11}},null!=re&&null!==(te=re.attribution_logic)&&void 0!==te&&null!==(ne=te.kube)&&void 0!==ne&&ne.impersonated_user_groups?r.a.createElement("div",{className:b("attribution-logic-item"),__source:{fileName:s,lineNumber:141,columnNumber:15}},null==re||null===(le=re.attribution_logic)||void 0===le||null===(ae=le.kube)||void 0===ae?void 0:ae.impersonated_user_groups):"-")))}},825:function(e,t,n){"use strict";n.r(t);n(162);var l=n(67),a=(n(116),n(42)),r=n(10),i=n.n(r),c=(n(595),n(298)),o=n(0),u=n.n(o),m=n(115),s=n.n(m),b=n(1629),d=n(1608),N=n(12),f=n(1321),_=n.n(f),v=n(817),p="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/alarm-event-list/event-list-comm/alarm-event-list-table/event-summary-drawer/event-summary-content/info.tsx";function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}var T=s.a.bind(_.a),h=c.a.Row,E=c.a.Col;t.default=function(e){var t,n,r,c,o,m,s,f,_,y,O,k,j,x=e.value,w=e.hostNumBtn,z=e.eventTags;return u.a.createElement("div",{className:T("info"),__source:{fileName:p,lineNumber:57,columnNumber:5}},u.a.createElement("div",{className:T("alarm-desc-name"),style:{backgroundColor:(null==x||null===(t=x.info)||void 0===t?void 0:t.status)!==b.EventStatus.notdeal?"#F6F7FB":"#FFECE8",marginLeft:"0px"},__source:{fileName:p,lineNumber:58,columnNumber:7}},u.a.createElement("div",{__source:{fileName:p,lineNumber:65,columnNumber:9}},(O=null==x||null===(n=x.info)||void 0===n?void 0:n.level,k={background:"",margin:"8px 8px 8px 16px"},j=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({content:"",color:"transparent"},function(e){switch(e){case b.EventLevel.critical:return{content:Object(N.g)("紧急"),color:"#E63F3F"};case b.EventLevel.high:return{content:Object(N.g)("高风险"),color:"#846BCE"};case b.EventLevel.medium:return{content:Object(N.g)("中风险"),color:"#FEC746"};case b.EventLevel.low:return{content:Object(N.g)("低风险"),color:"#468DFF"};default:return{content:"",color:"transparent"}}}(O)),k.background=j.color,u.a.createElement(a.a,{size:"mini",type:"primary",style:k,__source:{fileName:p,lineNumber:50,columnNumber:7}},j.content))),u.a.createElement("div",{__source:{fileName:p,lineNumber:66,columnNumber:9}},null==x||null===(r=x.info)||void 0===r?void 0:r.name),u.a.createElement("div",{className:T("status"),__source:{fileName:p,lineNumber:67,columnNumber:9}},u.a.createElement(l.a,{content:null!=x&&null!==(c=x.info)&&void 0!==c&&c.handle_user&&null!=x&&null!==(o=x.info)&&void 0!==o&&o.handle_time?u.a.createElement("div",{style:{maxWidth:350},__source:{fileName:p,lineNumber:71,columnNumber:17}},Object(N.g)("{user} 在 {time} 处理",{user:null==x||null===(m=x.info)||void 0===m?void 0:m.handle_user,time:Object(d.a)(null==x||null===(s=x.info)||void 0===s?void 0:s.handle_time)})):null,__source:{fileName:p,lineNumber:68,columnNumber:11}},Object(v.getDisplayEventDeal)(null==x||null===(f=x.info)||void 0===f?void 0:f.status)))),u.a.createElement(h,{style:{marginBottom:16},__source:{fileName:p,lineNumber:84,columnNumber:7}},u.a.createElement(E,{span:5,__source:{fileName:p,lineNumber:85,columnNumber:9}},Object(N.g)("事件标签")),u.a.createElement(E,{span:19,className:T("desc"),style:{marginLeft:-4},__source:{fileName:p,lineNumber:86,columnNumber:9}},z)),u.a.createElement(h,{style:{marginBottom:16},__source:{fileName:p,lineNumber:90,columnNumber:7}},u.a.createElement(E,{span:5,__source:{fileName:p,lineNumber:91,columnNumber:9}},Object(N.g)("初次告警时间")),u.a.createElement(E,{span:19,className:T("desc"),__source:{fileName:p,lineNumber:92,columnNumber:9}},Object(d.a)(null==x||null===(_=x.info)||void 0===_?void 0:_.event_time))),u.a.createElement(h,{style:{marginBottom:16},__source:{fileName:p,lineNumber:96,columnNumber:7}},u.a.createElement(E,{span:5,__source:{fileName:p,lineNumber:97,columnNumber:9}},Object(N.g)("事件更新时间")),u.a.createElement(E,{span:19,className:T("desc"),__source:{fileName:p,lineNumber:98,columnNumber:9}},Object(d.a)(null==x||null===(y=x.info)||void 0===y?void 0:y.update_time))),u.a.createElement(h,{style:{marginBottom:16},__source:{fileName:p,lineNumber:102,columnNumber:7}},u.a.createElement(E,{span:5,__source:{fileName:p,lineNumber:103,columnNumber:9}},Object(N.g)("受影响资产数")),u.a.createElement(E,{span:19,className:T("desc"),style:{marginLeft:-8},__source:{fileName:p,lineNumber:104,columnNumber:9}},w)))}}}]);