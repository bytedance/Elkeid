(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{194:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),i=n(5),o=n.n(i),c=(n(307),n(74)),l=n(75),u=(n(640),n(644)),s=(n(217),n(27)),p=n(41),d=n.n(p),m=n(20),b=n.n(m),f=n(26),v=n.n(f),h=n(0),O=n.n(h),g=n(615),_=n(28),y=n(565),w=n(577),j=n(582),N=n(573),x=n(566),P=n(569),E=n(51),k="/data00/webprojectdev/hids_open/src/pages/white-list/index.tsx";function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(){var e,t=Object(_.e)(E.b),n=Object(h.useState)(),r=b()(n,2),a=r[0],i=r[1],p=Object(g.a)(function(){var e=d()(v.a.mark((function e(t){var n,r,i,o,c,l,u,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.current,o=t.pageSize,c=t.filters,e.next=3,Object(x.GetWhiteList)({data:{content:a||void 0,match_key:null!=c&&null!==(n=c.match_key)&&void 0!==n&&n.length?null==c?void 0:c.match_key:void 0},params:{page:i,page_size:o}});case 3:return l=e.sent,u=l.data,s=l.page_info,e.abrupt("return",{list:null!=u?u:[],total:null!==(r=s.total)&&void 0!==r?r:0});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{auto:!0,resetDeps:[a],debounceInterval:300}),m=p.tableProps,f=p.refresh,D=p.filters,M=p.sorter;function T(){return(T=d()(v.a.mark((function e(t){var n,r,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.DeleteWhiteList)({data:{id_list:t}});case 2:1===(null==m||null===(n=m.data)||void 0===n?void 0:n.length)?null==m||m.onChange(S(S({},null==m?void 0:m.pagination),{},{current:(null==m||null===(r=m.pagination)||void 0===r?void 0:r.current)>1?(null==m||null===(a=m.pagination)||void 0===a?void 0:a.current)-1:1}),M,D):f();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=[{title:"加白范围",dataIndex:"range_type",width:"20%",render:function(e,t){return e===x.RangeType.all?"全局":O.a.createElement(w.a,{content:null==t?void 0:t.range_index,__source:{fileName:k,lineNumber:71,columnNumber:16}})}},{title:"匹配字段",dataIndex:"match_key",width:"15%",filters:null===x.whiteMatchFieldOptions||void 0===x.whiteMatchFieldOptions?void 0:x.whiteMatchFieldOptions.map((function(e){return{text:e.label,value:e.value}})),filteredValue:null!==(e=null==D?void 0:D.match_key)&&void 0!==e?e:[],render:function(e){var t,n;return null!==(t=null===(n=x.whiteMatchFieldOptions.find((function(t){return t.value===e})))||void 0===n?void 0:n.label)&&void 0!==t?t:"-"}},{title:"匹配方式",dataIndex:"match_type",width:"15%",render:function(e){return e===x.MatchType.equal?"等于":e===x.MatchType.reg?"正则匹配":"-"}},{title:"匹配内容",dataIndex:"match_content",width:"20%",render:function(e){return O.a.createElement(w.a,{content:e,__source:{fileName:k,lineNumber:102,columnNumber:32}})}},{title:"发生时间",dataIndex:"update_time",width:"20%",render:function(e){return Object(P.a)(e)}},{title:"操作",dataIndex:"op",fixed:"right",width:"10%",headerCellStyle:{paddingLeft:8},render:function(e,n){return O.a.createElement(u.a,{title:"你确定要删除该条白名单策略吗？",disabled:!t,position:"tr",onOk:function(){!function(e){T.apply(this,arguments)}([n.id])},__source:{fileName:k,lineNumber:117,columnNumber:9}},O.a.createElement(s.a,{disabled:t,content:"当前用户无编辑权限",__source:{fileName:k,lineNumber:125,columnNumber:11}},O.a.createElement(N.a,{disabled:!t,__source:{fileName:k,lineNumber:126,columnNumber:13}},"删除")))}}];return O.a.createElement("div",{className:"container",__source:{fileName:k,lineNumber:133,columnNumber:5}},O.a.createElement(y.a,{title:"白名单",contentStyle:{marginTop:16},__source:{fileName:k,lineNumber:134,columnNumber:7}},O.a.createElement(c.a,{placeholder:"请搜索匹配内容",value:a,onChange:i,style:{width:270,marginBottom:16},suffix:O.a.createElement(l.a,{__source:{fileName:k,lineNumber:140,columnNumber:19}}),__source:{fileName:k,lineNumber:135,columnNumber:9}}),O.a.createElement(j.a,o()({rowKey:"id",columns:A},m,{__source:{fileName:k,lineNumber:142,columnNumber:9}}))))}},565:function(e,t,n){"use strict";var r=n(4),a=n.n(r),i=n(0),o=n.n(i),c=n(86),l=n.n(c),u=n(576),s=n.n(u),p="/data00/webprojectdev/hids_open/src/components/common/content-box/index.tsx";function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=l.a.bind(s.a);t.a=function(e){var t=e.util,n=e.title,r=e.containerStyle,a=e.contentStyle,i=e.topBoxStyle,c=e.children,l=e.isCard;return o.a.createElement("div",{className:b("container",l&&"card"),style:m({},r),__source:{fileName:p,lineNumber:27,columnNumber:5}},n?o.a.createElement("div",{className:b("top-box"),style:m({},i),__source:{fileName:p,lineNumber:29,columnNumber:9}},o.a.createElement("div",{className:b("title"),__source:{fileName:p,lineNumber:30,columnNumber:11}},n),o.a.createElement("div",{__source:{fileName:p,lineNumber:31,columnNumber:11}},t)):null,o.a.createElement("div",{className:b("content-box"),style:m({},a),__source:{fileName:p,lineNumber:34,columnNumber:7}},c))}},566:function(e,t,n){"use strict";n.r(t),n.d(t,"AlarmType",(function(){return r})),n.d(t,"getDisplayAlarmType",(function(){return o})),n.d(t,"AlarmLevel",(function(){return a})),n.d(t,"GetAlarmList",(function(){return u})),n.d(t,"UpdateAlarmStatus",(function(){return s})),n.d(t,"GetAlarmStatistics",(function(){return p})),n.d(t,"GetAlarmDetail",(function(){return d})),n.d(t,"RangeType",(function(){return c})),n.d(t,"MatchType",(function(){return l})),n.d(t,"matchTypeOptions",(function(){return b})),n.d(t,"WhiteMatchField",(function(){return m})),n.d(t,"whiteMatchFieldOptions",(function(){return f})),n.d(t,"GetWhiteList",(function(){return v})),n.d(t,"AddWhiteList",(function(){return h})),n.d(t,"DeleteWhiteList",(function(){return O})),n.d(t,"GetAlarmRaw",(function(){return g}));var r,a,i=n(40);function o(e){switch(e){case r.bruteforce:return"暴力破解";case r.privilege_escalation:return"提权攻击";case r.persistent:return"后门驻留";case r.evasion:return"变形木马";case r.purpose:return"恶意破坏";case r.static_scan:return"静态检测";case r.killchain:return"杀伤链";default:return"-"}}!function(e){e.bruteforce="bruteforce",e.privilege_escalation="privilege_escalation",e.persistent="persistent",e.evasion="evasion",e.purpose="purpose",e.static_scan="static_scan",e.killchain="killchain"}(r||(r={})),function(e){e.critical="critical",e.high="high",e.medium="medium",e.low="low"}(a||(a={}));var c,l,u=function(e){var t=e.data,n=e.params;return Object(i.b)({method:"post",url:"/api/v6/alarm/list",data:t,params:n},"获取告警列表信息")},s=function(e){var t=e.data;return Object(i.b)({method:"post",url:"/api/v6/alarm/update",data:t},"更新告警处理状态",!0)},p=function(e){var t=e.params;return Object(i.b)({method:"get",url:"/api/v6/alarm/statistics",params:t},"获取告警统计数据")},d=function(e){var t=e.params;return Object(i.b)({method:"get",url:"/api/v6/alarm/get/".concat(t.alarm_id)},"获取告警详情")};!function(e){e[e.all=0]="all",e[e.self=1]="self"}(c||(c={})),function(e){e[e.equal=0]="equal",e[e.reg=1]="reg"}(l||(l={}));var m,b=[{label:"等于",value:l.equal},{label:"正则匹配",value:l.reg}];!function(e){e.argv="argv",e.pgid_argv="pgid_argv",e.exe="exe",e.sip="sip",e.dip="dip",e.pid_tree="pid_tree",e.ld_preload="ld_preload",e.ko_file="ko_file",e.module_name="module_name",e.exe_hash="exe_hash"}(m||(m={}));var f=[{label:"命令行",value:m.argv},{label:"组长命令行",value:m.pgid_argv},{label:"二进制",value:m.exe},{label:"来源IP",value:m.sip},{label:"目的IP",value:m.dip},{label:"进程链",value:m.pid_tree},{label:"运行时链接",value:m.ld_preload},{label:"内核模块文件",value:m.ko_file},{label:"内核模块名",value:m.module_name},{label:"文件指纹",value:m.exe_hash}],v=function(e){var t=e.data,n=e.params;return Object(i.b)({method:"post",url:"/api/v6/whitelist/list",data:t,params:n},"获取白名单列表信息")},h=function(e){var t=e.data;return Object(i.b)({method:"post",url:"/api/v6/whitelist/add",data:t},"新增白名单",!0)},O=function(e){var t=e.data;return Object(i.b)({method:"post",url:"/api/v6/whitelist/del",data:t},"删除白名单",!0)},g=function(e){var t=e.params;return Object(i.b)({method:"get",url:"/api/v6/alarm/raw/".concat(t.alarm_id)},"获取告警原始数据")}},569:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(581),a=n.n(r);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e?a.a.unix(e).format(t):"-"}},573:function(e,t,n){"use strict";n(574);var r=n(575),a=n(5),i=n.n(a),o=n(0),c=n.n(o);t.a=function(e){var t=i()({},e);return c.a.createElement(r.a,i()({style:{padding:"0 8px"}},t,{__source:{fileName:"/data00/webprojectdev/hids_open/src/components/common/text-button/index.tsx",lineNumber:7,columnNumber:10}}))}},576:function(e,t,n){e.exports={container:"container-ff5344dbc2","top-box":"top-box-0ebc1e6648",title:"title-1f92f6896d","content-box":"content-box-518d5e101b",card:"card-3d582462db"}},577:function(e,t,n){"use strict";n(311);var r=n(123),a=n(4),i=n.n(a),o=n(0),c=n.n(o),l="/data00/webprojectdev/hids_open/src/components/common/ellipsis-box/index.tsx";function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){var t=e.content,n=e.style;return c.a.createElement(r.a.Paragraph,{style:s({marginBottom:0},n),ellipsis:{rows:1,showTooltip:{type:"tooltip",props:{content:c.a.createElement("span",{style:{wordBreak:"break-all"},__source:{fileName:l,lineNumber:17,columnNumber:29}},t)}}},key:t,__source:{fileName:l,lineNumber:11,columnNumber:5}},t)}},582:function(e,t,n){"use strict";n(596);var r=n(599),a=n(5),i=n.n(a),o=n(4),c=n.n(o),l=n(218),u=n.n(l),s=n(0),p=n.n(s),d=["onChange","pagination"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){var t=e.onChange,n=e.pagination,a=u()(e,d);return p.a.createElement(r.a,i()({onChange:function(e,n,r,a){"filter"===a.action||"sort"===a.action?t(b(b({},e),{},{current:1}),n,r,a):t(e,n,r,a)},border:!1,pagination:(null==n?void 0:n.total)>10&&b(b({},n),{},{sizeCanChange:!0,sizeOptions:[10,20,50,100]})},a,{__source:{fileName:"/data00/webprojectdev/hids_open/src/components/common/table/index.tsx",lineNumber:6,columnNumber:5}}))}}}]);