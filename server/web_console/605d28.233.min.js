(window.webpackJsonp=window.webpackJsonp||[]).push([[233],{1696:function(e,t,n){"use strict";n.r(t),n.d(t,"TaskStatusEunm",(function(){return a})),n.d(t,"SubTaskStatusEnum",(function(){return r})),n.d(t,"TaskTypeEunm",(function(){return u})),n.d(t,"GetTaskList",(function(){return i})),n.d(t,"GetTaskInfo",(function(){return s})),n.d(t,"CreateSyncConfigTask",(function(){return l})),n.d(t,"GetApiV6VirusTaskGetVTaskId",(function(){return d})),n.d(t,"GetSubTaskList",(function(){return m})),n.d(t,"PostApiV6VirusTaskSubtaskList",(function(){return b})),n.d(t,"GetTaskHostStatus",(function(){return f})),n.d(t,"OperateTask",(function(){return p})),n.d(t,"CreateRebootAgentTask",(function(){return g})),n.d(t,"CreatePluginTask",(function(){return v})),n.d(t,"GetModuleId",(function(){return O})),n.d(t,"CreateVirusTask",(function(){return h}));var a,r,u,c=n(54),o=n(12);!function(e){e.running="running",e.created="created",e.finished="finished",e.cancelled="cancelled"}(a||(a={})),function(e){e.created="created",e.running="running",e.failed="failed",e.succeed="succeed"}(r||(r={})),function(e){e.RebootAgent="reboot_agent",e.SyncConfig="sync_config"}(u||(u={}));var i=function(e){var t=e.data,n=e.params;return Object(c.b)({method:"post",url:"/api/v6/agent/getTaskList",data:t,params:n},Object(o.g)("获取任务列表"))},s=function(e){var t=e.params;return Object(c.b)({method:"get",url:"/api/v6/agent/getTask/".concat(t.task_id)},Object(o.g)("获取任务基本信息"))},l=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/component/CreateSyncConfigTask",data:t,timeout:12e4},Object(o.g)("创建配置同步任务"),!0)};function d(e){var t=e.params;return Object(c.b)({url:"/api/v6/virus/task/get/".concat(t.task_id),method:"GET"},Object(o.g)("获取任务基本信息"))}var m=function(e){var t=e.data,n=e.params;return Object(c.b)({method:"post",url:"/api/v6/agent/getSubTaskList",data:t,params:n},Object(o.g)("获取子任务列表"))};function b(e){var t=e.data,n=e.params;return Object(c.b)({url:"/api/v6/virus/task/subtask/list",params:n,data:t,method:"POST"},Object(o.g)("获取子任务列表"))}var f=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/agent/GetErrorHostNum",data:t},Object(o.g)("获取创建任务主机状态"),!1,!1)},p=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/agent/controlTask",data:t},Object(o.g)("运行任务"),!0)},g=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/component/CreateRebootAgentTask",data:t,timeout:12e4},Object(o.g)("创建客户端重启任务"),!0)},v=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/agent/createPluTask",data:t},Object(o.g)("创建插件任务"),!0)},O=function(e){var t=e.data;return Object(c.b)({method:"post",url:"/api/v6/module/GetModuleId",data:t},Object(o.g)("获取组件id"),!1,!1)};function h(e){return Object(c.b)({url:"/api/v6/virus/task/create",data:e,method:"POST"},Object(o.g)("创建病毒扫描任务"),!0)}},480:function(e,t,n){"use strict";n.r(t);n(1544);var a,r=n(546),u=(n(1567),n(1568)),c=(n(224),n(97)),o=n(28),i=n.n(o),s=n(50),l=n.n(s),d=n(603),m=n.n(d),b=n(16),f=n.n(b),p=n(0),g=n.n(p),v=n(604),O=n(613),h=n(1696),k=n(12),N="/opt/tiger/compile_path/src/code.byted.org/biz-platform/hids/src/pages/task-list/edit-task-modal/index.tsx",j=v.a.div(a||(a=m()(["\n  .title {\n    color: #4e5969;\n  }\n  .slider {\n    display: flex;\n    align-items: center;\n    margin: 20px 0;\n\n    color: #4e5969;\n  }\n  .desc {\n    color: #86909c;\n  }\n"])));t.default=function(e){var t=e.visible,n=e.data,a=e.handleConfirm,o=e.handleCancel,s=Object(p.useMemo)((function(){var e,t;return(null!==(e=null==n?void 0:n.sub_task_failed)&&void 0!==e?e:0)+(null!==(t=null==n?void 0:n.sub_task_succeed)&&void 0!==t?t:0)}),[n]),d=Object(p.useState)(1),m=l()(d,2),b=m[0],v=m[1],_=Object(p.useMemo)((function(){return Math.ceil(b/(null==n?void 0:n.id_count)*100)}),[b,n]);Object(p.useEffect)((function(){v(t&&s||1)}),[t,n]);var T=function(){var e=i()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b-s!=0){e.next=3;break}return c.a.error(Object(k.g)("下发主机数不能为0")),e.abrupt("return");case 3:return e.next=5,Object(h.OperateTask)({data:{task_id:null==n?void 0:n.task_id,action:"run",concurrence:10,run_number:b-s}});case 5:a();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return g.a.createElement(O.b,{visible:t,onCancel:o,onOk:T,style:{width:400},title:Object(k.g)("运行任务"),__source:{fileName:N,lineNumber:69,columnNumber:5}},g.a.createElement(j,{__source:{fileName:N,lineNumber:76,columnNumber:7}},g.a.createElement("div",{className:"title",__source:{fileName:N,lineNumber:77,columnNumber:9}},s?"".concat(Object(k.g)("当前任务对应 {placeholder1} 台主机，已成功下发 {subTaskCreated} 台主机（{placeholder5}%），请继续设置下发主机数：",{placeholder1:null==n?void 0:n.id_count,subTaskCreated:s,placeholder5:Math.ceil(s/(null==n?void 0:n.id_count)*100)})):Object(k.g)("请设置任务下发主机数：")),g.a.createElement("div",{className:"slider",__source:{fileName:N,lineNumber:89,columnNumber:9}},g.a.createElement("span",{style:{marginRight:16},__source:{fileName:N,lineNumber:90,columnNumber:11}},Object(k.g)("下发主机数")),g.a.createElement(u.a,{min:0,max:null==n?void 0:n.id_count,value:b,onChange:function(e){e>=s&&v(e)},formatTooltip:function(e){return"".concat(Object(k.g)("{v} 台主机",{v:e}))},style:{width:180},__source:{fileName:N,lineNumber:91,columnNumber:11}}),g.a.createElement(r.a,{min:0,max:null==n?void 0:n.id_count,value:b,onChange:function(e){e>=s&&v(e)},style:{width:65,marginLeft:16},__source:{fileName:N,lineNumber:103,columnNumber:11}}),g.a.createElement("span",{style:{marginLeft:"4px"},__source:{fileName:N,lineNumber:114,columnNumber:11}},Object(k.g)("台"))),g.a.createElement("div",{className:"desc",__source:{fileName:N,lineNumber:116,columnNumber:9}},s?g.a.createElement(g.a.Fragment,null,g.a.createElement("div",{__source:{fileName:N,lineNumber:124,columnNumber:15}},"".concat(Object(k.g)("点击确定后，再下发 {placeholder1} 台主机",{placeholder1:b-s}))),g.a.createElement("div",{__source:{fileName:N,lineNumber:127,columnNumber:15}},"".concat(Object(k.g)("一共下发 {hostNumber} 台主机（{hostPercent}%）",{hostNumber:b,hostPercent:_})))):"".concat(Object(k.g)("点击确定后，将下发 {hostNumber} 台主机（{hostPercent}%），运行完成后自动暂停。",{hostNumber:b,hostPercent:_})))))}}}]);