[service]
### create flock path
flock_path = "/var/run/elkeid_scanners_plugin.pid"

### cgroup max mem limit, defult 256Mb
cgroup_name = "clamav_"
### mega byte
cgroup_mem_limit = 300
### %
cgroup_cpu_limit = 39

### log
log_level = "info"
log_path = "./"
remote_log_level = "error"
max_backups = 10
enable_cronjob = 0

[engine]
clamav_max_filesize = 18874368
clamav_max_scansize = 26214400
clamav_max_scantime = 5000
default_db_path = "./dat"

[database]
db_urls = [
    "http://lf3-elkeid.bytetos.com/obj/elkeid-download/18249e0cbe7c6aca231f047cb31d753fa4604434fcb79f484ea477f6009303c3/archive_db_default_20221206",
    "http://lf6-elkeid.bytetos.com/obj/elkeid-download/18249e0cbe7c6aca231f047cb31d753fa4604434fcb79f484ea477f6009303c3/archive_db_default_20221206",
    "http://lf9-elkeid.bytetos.com/obj/elkeid-download/18249e0cbe7c6aca231f047cb31d753fa4604434fcb79f484ea477f6009303c3/archive_db_default_20221206",
    "http://lf26-elkeid.bytetos.com/obj/elkeid-download/18249e0cbe7c6aca231f047cb31d753fa4604434fcb79f484ea477f6009303c3/archive_db_default_20221206",
]

archive_db_pwd = "clamav_default_passwd"
archive_db_hash = "8db8c2ddddbead44a61cc4b5e373ca0a397c3ce211ba47bdfb01e4c5e7aae56a"
archive_db_version = "20221206"

[fullscan]
fullscan_cpu_idle_interval = 5
fullscan_cpu_idle_100pct = 30
fullscan_cpu_quota_default_min = 10000
fullscan_cpu_quota_default_max = 800000

fullscan_max_scan_engines = 6
fullscan_max_scan_cpu_100 = 600
fullscan_max_scan_mem_mb = 512
fullscan_max_scan_timeout_full = 48
fullscan_max_scan_timeout_quick = 1

[scan]
filter = [
    ### root filter
    "/root/.debug",
    "/root/.vscode",
    "/root/.bash_history",
    ### file filter
    "/usr/bin/killall",
    "/usr/bin/virt",
    "/usr/bin/upx",
    "/usr/bin/fim",
    "/usr/bin/nc",
    "/usr/bin/inputattach",
    ### clamav
    "/usr/bin/clamdscan",
    "/usr/bin/clamconf",
    "/usr/bin/sigtool",
    "/usr/bin/clamdtop",
    "/usr/bin/clamsubmit",
    "/usr/bin/clambc",
    "/usr/bin/clamscan",
    "/usr/sbin/clamd",
    "/usr/sbin/clamonacc",
    ### bin
    "/bin/nc",
    "/bin/netcat",
    "/bin/upx",
    ### etc alternatives
    "/etc/alternatives/upx",
    "/etc/alternatives/nc",
    "/etc/alternatives/netcat",
    "/etc/dictionaries-common/words",
    ### full disk scan filer
    "/dev",
    "/boot",
    "/sys",
    "/usr/src",
    "/usr/local/src",
]

[[scan.dir]]
fpath = "/root"
max_depth = 3
[[scan.dir]]
fpath = "/home"
max_depth = 3
[[scan.dir]]
fpath = "/bin"
max_depth = 2
[[scan.dir]]
fpath = "/sbin"
max_depth = 2
[[scan.dir]]
fpath = "/usr/bin"
max_depth = 2
[[scan.dir]]
fpath = "/usr/sbin"
max_depth = 2
[[scan.dir]]
fpath = "/usr/local"
max_depth = 3
[[scan.dir]]
fpath = "/lib/systemd/system"
max_depth = 1
[[scan.dir]]
fpath = "/etc"
max_depth = 2
[[scan.dir]]
fpath = "/var/www/"
max_depth = 12


### fanotify file monitor config
[[file_monitor]]
path = "/bin"
watch_mode = 0
follow_link = false
sp_child = ""
[[file_monitor]]
path = "/sbin"
watch_mode = 0
follow_link = false
sp_child = ""
[[file_monitor]]
path = "/usr/bin"
watch_mode = 0
follow_link = false
sp_child = ""
[[file_monitor]]
path = "/usr/sbin"
watch_mode = 0
follow_link = false
sp_child = ""
[[file_monitor]]
path = "/usr/local/bin"
watch_mode = 0
follow_link = false
sp_child = ""
[[file_monitor]]
path = "/usr/local/sbin"
watch_mode = 0
follow_link = false
sp_child = ""


[file_monitor_filter]
file_monitor_exe_whitelist = [
    "/usr/bin/juno",
    "/usr/bin/bpfd",
    "/usr/bin/systemd-detect-virt",
    "/usr/sbin/qemu-ga",
    "/usr/libexec/pk-command-not-found",
    "/bin/touch",
    "/sbin/ipset",
    "/sbin/audisp-mu",
    "/lib/systemd/systemd",
    "/lib/systemd/systemd-journald",
]

file_monitor_argv_whitelist = ["yum repolist"]
